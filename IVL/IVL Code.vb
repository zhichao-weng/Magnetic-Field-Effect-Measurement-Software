Imports System.Runtime.InteropServices
Imports NationalInstruments.NI4882
Imports NationalInstruments.Visa
Imports System.Timers
Imports System.Resources
Imports Ivi.Visa
Imports Ivi.Visa.Interop






Module modVisa
    ' -------------------------------------------------------------------------
    ' ----------------VISA LIBRARY IMPORTS FOR LATER USE-----------------------
    ' ----------------ZHICHAO WENG---------------------------------------------
    ' ------------------------------------------------------------------------

    Public Const MAX_CNT = 200
    Public Const GPIBNewport = 5, GPIBSource = 16, GPIBVoltmeter = 17, GPIBKeith = 18, GPIBKey2612 = 26
    Public defaultRM As Integer
    Public vi As Integer
    Public NewportPresent As Integer
    Public instrsesn As Integer
    Public numlnstrs As Integer
    Public findList As Integer
    Public retCount As Long
    Public writeCount As Integer
    Public status As Integer
    Public instrResourceString As String
    Public buffer As String
    Public i As Integer
    Public TransientBCurrent(600) As Single
    Public Kx, Ky As Single
    Public Benvy, Benvx As Single
    Public NumBValues As Integer, BField(1000) As Single, NumVvalues As Integer, Vvalues(1000) As Single
    Public Filename As String, UserDirectory As String
    Public GPIBPresent As Integer
    Public aTimer As System.Timers.Timer, bTimer As System.Timers.Timer, cTimer As System.Timers.Timer, dTimer As System.Timers.Timer, eTimer As System.Timers.Timer
    Public NumNewMR As Integer
    Public DeviceVoltage(20000) As Single
    Public DeviceBField(20000) As Single
    Public DeviceEl(20000) As Single
    Public DeviceBField0(20000) As Single
    Public XXX As Integer
    Public VoltmeterAGI(1500) As Single
    Public BTrans(250) As Single
    Public AGICH2Curr As Single
    Public IDriveRate As Single
    Public MRFilenum As Single, MRy As Integer
    Public INT_TYPE As Integer
    Public INT_NUM As Integer




    Public Const VI_SPEC_VERSION As Integer = &H200200

    ' - Resource Template Functions and Operations ----------------------------

    Public Declare Function viOpenDefaultRM Lib "VISA32.DLL" Alias "#141" (ByRef sesn As Integer) As Integer
    Public Declare Function viGetDefaultRM Lib "VISA32.DLL" Alias "#128" (ByRef sesn As Integer) As Integer
    Public Declare Function viFindRsrc Lib "VISA32.DLL" Alias "#129" (ByVal sesn As Integer, ByVal expr As String, ByRef vi As Integer, ByRef retCount As Integer, ByRef desc As String) As Integer
    Public Declare Function viFindNext Lib "VISA32.DLL" Alias "#130" (ByRef vi As Integer, ByVal desc As String) As Integer
    Public Declare Function viParseRsrc Lib "VISA32.DLL" Alias "#146" (ByVal sesn As Integer, ByVal desc As String, ByRef intfType As Short, ByRef intfNum As Short) As Integer
    Public Declare Function viOpen Lib "VISA32.DLL" Alias "#131" (ByVal sesn As Integer, ByVal viDesc As String, ByVal mode As Integer, ByVal timeout As Integer, ByRef vi As Integer) As Integer
    Public Declare Function viClose Lib "VISA32.DLL" Alias "#132" (ByVal vi As Integer) As Integer
    ' - Please note the use of overloading in place of 'as Any' ---------------
    Public Declare Function viGetAttribute Lib "VISA32.DLL" Alias "#133" (ByVal vi As Integer, ByVal attrName As Integer, ByRef attrValue As Short) As Integer
    Public Declare Function viGetAttribute Lib "VISA32.DLL" Alias "#133" (ByVal vi As Integer, ByVal attrName As Integer, ByRef attrValue As Integer) As Integer
    Public Declare Function viGetAttribute Lib "VISA32.DLL" Alias "#133" (ByVal vi As Integer, ByVal attrName As Integer, ByRef attrValue As Long) As Integer
    Public Declare Function viGetAttribute Lib "VISA32.DLL" Alias "#133" (ByVal vi As Integer, ByVal attrName As Integer, ByRef attrValue As Single) As Integer
    Public Declare Function viGetAttribute Lib "VISA32.DLL" Alias "#133" (ByVal vi As Integer, ByVal attrName As Integer, ByRef attrValue As Double) As Integer
    Public Declare Function viGetAttribute Lib "VISA32.DLL" Alias "#133" (ByVal vi As Integer, ByVal attrName As Integer, <MarshalAs(UnmanagedType.VBByRefStr)> ByRef attrValue As String) As Integer
    Public Declare Function viSetAttribute Lib "VISA32.DLL" Alias "#134" (ByVal vi As Integer, ByVal attrName As Integer, ByVal attrValue As Integer) As Integer
    Public Declare Function viStatusDesc Lib "VISA32.DLL" Alias "#142" (ByVal vi As Integer, ByVal status As Integer, ByVal desc As String) As Integer
    Public Declare Function viLock Lib "VISA32.DLL" Alias "#144" (ByVal vi As Integer, ByVal lockType As Integer, ByVal timeout As Integer, ByVal requestedKey As String, ByVal accessKey As String) As Integer
    Public Declare Function viUnlock Lib "VISA32.DLL" Alias "#145" (ByVal vi As Integer) As Integer
    Public Declare Function viEnableEvent Lib "VISA32.DLL" Alias "#135" (ByVal vi As Integer, ByVal eventType As Integer, ByVal mechanism As Short, ByVal context As Integer) As Integer
    Public Declare Function viDisableEvent Lib "VISA32.DLL" Alias "#136" (ByVal vi As Integer, ByVal eventType As Integer, ByVal mechanism As Short) As Integer
    Public Declare Function viDiscardEvents Lib "VISA32.DLL" Alias "#137" (ByVal vi As Integer, ByVal eventType As Integer, ByVal mechanism As Short) As Integer
    Public Declare Function viWaitOnEvent Lib "VISA32.DLL" Alias "#138" (ByVal vi As Integer, ByVal inEventType As Integer, ByVal timeout As Integer, ByRef outEventType As Integer, ByRef outEventContext As Integer) As Integer

    ' - Basic I/O Operations --------------------------------------------------

    Public Declare Function viRead Lib "VISA32.DLL" Alias "#256" (ByVal vi As Integer, <MarshalAs(UnmanagedType.VBByRefStr)> ByRef Buffer As String, ByVal count As Integer, ByRef retCount As Integer) As Integer
    Public Declare Function viReadToFile Lib "VISA32.DLL" Alias "#219" (ByVal vi As Integer, ByVal filename As String, ByVal count As Integer, ByRef retCount As Integer) As Integer
    Public Declare Function viWrite Lib "VISA32.DLL" Alias "#257" (ByVal vi As Integer, ByVal Buffer As String, ByVal count As Integer, ByRef retCount As Integer) As Integer
    Public Declare Function viWriteFromFile Lib "VISA32.DLL" Alias "#218" (ByVal vi As Integer, ByVal filename As String, ByVal count As Integer, ByRef retCount As Integer) As Integer
    Public Declare Function viAssertTrigger Lib "VISA32.DLL" Alias "#258" (ByVal vi As Integer, ByVal protocol As Short) As Integer
    Public Declare Function viReadSTB Lib "VISA32.DLL" Alias "#259" (ByVal vi As Integer, ByRef status As Short) As Integer
    Public Declare Function viClear Lib "VISA32.DLL" Alias "#260" (ByVal vi As Integer) As Integer

    ' - Formatted and Buffered I/O Operations ---------------------------------

    Public Declare Function viSetBuf Lib "VISA32.DLL" Alias "#267" (ByVal vi As Integer, ByVal mask As Short, ByVal bufSize As Integer) As Integer
    Public Declare Function viFlush Lib "VISA32.DLL" Alias "#268" (ByVal vi As Integer, ByVal mask As Short) As Integer
    Public Declare Function viBufWrite Lib "VISA32.DLL" Alias "#202" (ByVal vi As Integer, ByVal Buffer As String, ByVal count As Integer, ByRef retCount As Integer) As Integer
    Public Declare Function viBufRead Lib "VISA32.DLL" Alias "#203" (ByVal vi As Integer, ByVal Buffer As String, ByVal count As Integer, ByRef retCount As Integer) As Integer
    ' - Please note the use of overloading in place of 'as Any' ---------------
    Public Declare Function viPrintf Lib "VISA32.DLL" Alias "#270" (ByVal vi As Integer, ByVal writeFmt As String, ByVal params As Short) As Integer
    Public Declare Function viPrintf Lib "VISA32.DLL" Alias "#270" (ByVal vi As Integer, ByVal writeFmt As String, ByVal params As Integer) As Integer
    Public Declare Function viPrintf Lib "VISA32.DLL" Alias "#270" (ByVal vi As Integer, ByVal writeFmt As String, ByVal params As Long) As Integer
    Public Declare Function viPrintf Lib "VISA32.DLL" Alias "#270" (ByVal vi As Integer, ByVal writeFmt As String, ByVal params As Single) As Integer
    Public Declare Function viPrintf Lib "VISA32.DLL" Alias "#270" (ByVal vi As Integer, ByVal writeFmt As String, ByVal params As Double) As Integer
    Public Declare Function viPrintf Lib "VISA32.DLL" Alias "#270" (ByVal vi As Integer, ByVal writeFmt As String, ByVal params As String) As Integer
    ' - Please note the use of overloading in place of 'as Any' ---------------
    Public Declare Function viSPrintf Lib "VISA32.DLL" Alias "#205" (ByVal vi As Integer, ByVal Buffer As String, ByVal writeFmt As String, ByVal params As Short) As Integer
    Public Declare Function viSPrintf Lib "VISA32.DLL" Alias "#205" (ByVal vi As Integer, ByVal Buffer As String, ByVal writeFmt As String, ByVal params As Integer) As Integer
    Public Declare Function viSPrintf Lib "VISA32.DLL" Alias "#205" (ByVal vi As Integer, ByVal Buffer As String, ByVal writeFmt As String, ByVal params As Long) As Integer
    Public Declare Function viSPrintf Lib "VISA32.DLL" Alias "#205" (ByVal vi As Integer, ByVal Buffer As String, ByVal writeFmt As String, ByVal params As Single) As Integer
    Public Declare Function viSPrintf Lib "VISA32.DLL" Alias "#205" (ByVal vi As Integer, ByVal Buffer As String, ByVal writeFmt As String, ByVal params As Double) As Integer
    Public Declare Function viSPrintf Lib "VISA32.DLL" Alias "#205" (ByVal vi As Integer, ByVal Buffer As String, ByVal writeFmt As String, ByVal params As String) As Integer
    ' - Please note the use of overloading in place of 'as Any' ---------------
    Public Declare Function viScanf Lib "VISA32.DLL" Alias "#272" (ByVal vi As Integer, ByVal readFmt As String, ByRef params As Short) As Integer
    Public Declare Function viScanf Lib "VISA32.DLL" Alias "#272" (ByVal vi As Integer, ByVal readFmt As String, ByRef params As Integer) As Integer
    Public Declare Function viScanf Lib "VISA32.DLL" Alias "#272" (ByVal vi As Integer, ByVal readFmt As String, ByRef params As Long) As Integer
    Public Declare Function viScanf Lib "VISA32.DLL" Alias "#272" (ByVal vi As Integer, ByVal readFmt As String, ByRef params As Single) As Integer
    Public Declare Function viScanf Lib "VISA32.DLL" Alias "#272" (ByVal vi As Integer, ByVal readFmt As String, ByRef params As Double) As Integer
    Public Declare Function viScanf Lib "VISA32.DLL" Alias "#272" (ByVal vi As Integer, ByVal readFmt As String, <MarshalAs(UnmanagedType.VBByRefStr)> ByRef params As String) As Integer
    ' - Please note the use of overloading in place of 'as Any' ---------------
    Public Declare Function viSScanf Lib "VISA32.DLL" Alias "#207" (ByVal vi As Integer, ByVal Buffer As String, ByVal readFmt As String, ByRef params As Short) As Integer
    Public Declare Function viSScanf Lib "VISA32.DLL" Alias "#207" (ByVal vi As Integer, ByVal Buffer As String, ByVal readFmt As String, ByRef params As Integer) As Integer
    Public Declare Function viSScanf Lib "VISA32.DLL" Alias "#207" (ByVal vi As Integer, ByVal Buffer As String, ByVal readFmt As String, ByRef params As Long) As Integer
    Public Declare Function viSScanf Lib "VISA32.DLL" Alias "#207" (ByVal vi As Integer, ByVal Buffer As String, ByVal readFmt As String, ByRef params As Single) As Integer
    Public Declare Function viSScanf Lib "VISA32.DLL" Alias "#207" (ByVal vi As Integer, ByVal Buffer As String, ByVal readFmt As String, ByRef params As Double) As Integer
    Public Declare Function viSScanf Lib "VISA32.DLL" Alias "#207" (ByVal vi As Integer, ByVal Buffer As String, ByVal readFmt As String, <MarshalAs(UnmanagedType.VBByRefStr)> ByRef params As String) As Integer
    ' - Please note the use of overloading in place of 'as Any' ---------------
    Public Declare Function viQueryf Lib "VISA32.DLL" Alias "#280" (ByVal vi As Integer, ByVal writeFmt As String, ByVal readFmt As String, ByRef params As Short) As Integer
    Public Declare Function viQueryf Lib "VISA32.DLL" Alias "#280" (ByVal vi As Integer, ByVal writeFmt As String, ByVal readFmt As String, ByRef params As Integer) As Integer
    Public Declare Function viQueryf Lib "VISA32.DLL" Alias "#280" (ByVal vi As Integer, ByVal writeFmt As String, ByVal readFmt As String, ByRef params As Long) As Integer
    Public Declare Function viQueryf Lib "VISA32.DLL" Alias "#280" (ByVal vi As Integer, ByVal writeFmt As String, ByVal readFmt As String, ByRef params As Single) As Integer
    Public Declare Function viQueryf Lib "VISA32.DLL" Alias "#280" (ByVal vi As Integer, ByVal writeFmt As String, ByVal readFmt As String, ByRef params As Double) As Integer
    Public Declare Function viQueryf Lib "VISA32.DLL" Alias "#280" (ByVal vi As Integer, ByVal writeFmt As String, ByVal readFmt As String, <MarshalAs(UnmanagedType.VBByRefStr)> ByRef params As String) As Integer

    ' - Memory I/O Operations -------------------------------------------------

    Public Declare Function viIn8 Lib "VISA32.DLL" Alias "#273" (ByVal vi As Integer, ByVal accSpace As Short, ByVal offset As Integer, ByRef val8 As Byte) As Integer
    Public Declare Function viOut8 Lib "VISA32.DLL" Alias "#274" (ByVal vi As Integer, ByVal accSpace As Short, ByVal offset As Integer, ByVal val8 As Byte) As Integer
    Public Declare Function viIn16 Lib "VISA32.DLL" Alias "#261" (ByVal vi As Integer, ByVal accSpace As Short, ByVal offset As Integer, ByRef val16 As Short) As Integer
    Public Declare Function viOut16 Lib "VISA32.DLL" Alias "#262" (ByVal vi As Integer, ByVal accSpace As Short, ByVal offset As Integer, ByVal val16 As Short) As Integer
    Public Declare Function viIn32 Lib "VISA32.DLL" Alias "#281" (ByVal vi As Integer, ByVal accSpace As Short, ByVal offset As Integer, ByRef val32 As Integer) As Integer
    Public Declare Function viOut32 Lib "VISA32.DLL" Alias "#282" (ByVal vi As Integer, ByVal accSpace As Short, ByVal offset As Integer, ByVal val32 As Integer) As Integer
    Public Declare Function viMoveIn8 Lib "VISA32.DLL" Alias "#283" (ByVal vi As Integer, ByVal accSpace As Short, ByVal offset As Integer, ByVal length As Integer, ByRef buf8 As Byte) As Integer
    Public Declare Function viMoveOut8 Lib "VISA32.DLL" Alias "#284" (ByVal vi As Integer, ByVal accSpace As Short, ByVal offset As Integer, ByVal length As Integer, ByRef buf8 As Byte) As Integer
    Public Declare Function viMoveIn16 Lib "VISA32.DLL" Alias "#285" (ByVal vi As Integer, ByVal accSpace As Short, ByVal offset As Integer, ByVal length As Integer, ByRef buf16 As Short) As Integer
    Public Declare Function viMoveOut16 Lib "VISA32.DLL" Alias "#286" (ByVal vi As Integer, ByVal accSpace As Short, ByVal offset As Integer, ByVal length As Integer, ByRef buf16 As Short) As Integer
    Public Declare Function viMoveIn32 Lib "VISA32.DLL" Alias "#287" (ByVal vi As Integer, ByVal accSpace As Short, ByVal offset As Integer, ByVal length As Integer, ByRef buf32 As Integer) As Integer
    Public Declare Function viMoveOut32 Lib "VISA32.DLL" Alias "#288" (ByVal vi As Integer, ByVal accSpace As Short, ByVal offset As Integer, ByVal length As Integer, ByRef buf32 As Integer) As Integer
    Public Declare Function viMove Lib "VISA32.DLL" Alias "#200" (ByVal vi As Integer, ByVal srcSpace As Short, ByVal srcOffset As Integer, ByVal srcWidth As Short, ByVal destSpace As Short, ByVal destOffset As Integer, ByVal destWidth As Short, ByVal srcLength As Integer) As Integer
    Public Declare Function viMapAddress Lib "VISA32.DLL" Alias "#263" (ByVal vi As Integer, ByVal mapSpace As Short, ByVal mapOffset As Integer, ByVal mapSize As Integer, ByVal accMode As Short, ByVal suggested As Integer, ByRef address As Integer) As Integer
    Public Declare Function viUnmapAddress Lib "VISA32.DLL" Alias "#264" (ByVal vi As Integer) As Integer
    Public Declare Sub viPeek8 Lib "VISA32.DLL" Alias "#275" (ByVal vi As Integer, ByVal address As Integer, ByRef val8 As Byte)
    Public Declare Sub viPoke8 Lib "VISA32.DLL" Alias "#276" (ByVal vi As Integer, ByVal address As Integer, ByVal val8 As Byte)
    Public Declare Sub viPeek16 Lib "VISA32.DLL" Alias "#265" (ByVal vi As Integer, ByVal address As Integer, ByRef val16 As Short)
    Public Declare Sub viPoke16 Lib "VISA32.DLL" Alias "#266" (ByVal vi As Integer, ByVal address As Integer, ByVal val16 As Short)
    Public Declare Sub viPeek32 Lib "VISA32.DLL" Alias "#289" (ByVal vi As Integer, ByVal address As Integer, ByRef val32 As Integer)
    Public Declare Sub viPoke32 Lib "VISA32.DLL" Alias "#290" (ByVal vi As Integer, ByVal address As Integer, ByVal val32 As Integer)

    ' - Shared Memory Operations ----------------------------------------------

    Public Declare Function viMemAlloc Lib "VISA32.DLL" Alias "#291" (ByVal vi As Integer, ByVal memSize As Integer, ByRef offset As Integer) As Integer
    Public Declare Function viMemFree Lib "VISA32.DLL" Alias "#292" (ByVal vi As Integer, ByVal offset As Integer) As Integer

    ' - Interface Specific Operations -----------------------------------------

    Public Declare Function viGpibControlREN Lib "VISA32.DLL" Alias "#208" (ByVal vi As Integer, ByVal mode As Short) As Integer
    Public Declare Function viGpibControlATN Lib "VISA32.DLL" Alias "#210" (ByVal vi As Integer, ByVal mode As Short) As Integer
    Public Declare Function viGpibSendIFC Lib "VISA32.DLL" Alias "#211" (ByVal vi As Integer) As Integer
    Public Declare Function viGpibCommand Lib "VISA32.DLL" Alias "#212" (ByVal vi As Integer, ByVal Buffer As String, ByVal count As Integer, ByRef retCount As Integer) As Integer
    Public Declare Function viGpibPassControl Lib "VISA32.DLL" Alias "#213" (ByVal vi As Integer, ByVal primAddr As Short, ByVal secAddr As Short) As Integer
    Public Declare Function viVxiCommandQuery Lib "VISA32.DLL" Alias "#209" (ByVal vi As Integer, ByVal mode As Short, ByVal devCmd As Integer, ByRef devResponse As Integer) As Integer
    Public Declare Function viAssertUtilSignal Lib "VISA32.DLL" Alias "#214" (ByVal vi As Integer, ByVal line As Short) As Integer
    Public Declare Function viAssertIntrSignal Lib "VISA32.DLL" Alias "#215" (ByVal vi As Integer, ByVal mode As Short, ByVal statusID As Integer) As Integer
    Public Declare Function viMapTrigger Lib "VISA32.DLL" Alias "#216" (ByVal vi As Integer, ByVal trigSrc As Short, ByVal trigDest As Short, ByVal mode As Short) As Integer
    Public Declare Function viUnmapTrigger Lib "VISA32.DLL" Alias "#217" (ByVal vi As Integer, ByVal trigSrc As Short, ByVal trigDest As Short) As Integer

    ' - Attributes ------------------------------------------------------------

    Public Const VI_ATTR_RSRC_CLASS As Integer = &HBFFF0001
    Public Const VI_ATTR_RSRC_NAME As Integer = &HBFFF0002
    Public Const VI_ATTR_RSRC_IMPL_VERSION As Integer = &H3FFF0003
    Public Const VI_ATTR_RSRC_LOCK_STATE As Integer = &H3FFF0004
    Public Const VI_ATTR_MAX_QUEUE_LENGTH As Integer = &H3FFF0005
    Public Const VI_ATTR_USER_DATA As Integer = &H3FFF0007
    Public Const VI_ATTR_FDC_CHNL As Integer = &H3FFF000D
    Public Const VI_ATTR_FDC_MODE As Integer = &H3FFF000F
    Public Const VI_ATTR_FDC_GEN_SIGNAL_EN As Integer = &H3FFF0011
    Public Const VI_ATTR_FDC_USE_PAIR As Integer = &H3FFF0013
    Public Const VI_ATTR_SEND_END_EN As Integer = &H3FFF0016
    Public Const VI_ATTR_TERMCHAR As Integer = &H3FFF0018
    Public Const VI_ATTR_TMO_VALUE As Integer = &H3FFF001A
    Public Const VI_ATTR_GPIB_READDR_EN As Integer = &H3FFF001B
    Public Const VI_ATTR_IO_PROT As Integer = &H3FFF001C
    Public Const VI_ATTR_DMA_ALLOW_EN As Integer = &H3FFF001E
    Public Const VI_ATTR_ASRL_BAUD As Integer = &H3FFF0021
    Public Const VI_ATTR_ASRL_DATA_BITS As Integer = &H3FFF0022
    Public Const VI_ATTR_ASRL_PARITY As Integer = &H3FFF0023
    Public Const VI_ATTR_ASRL_STOP_BITS As Integer = &H3FFF0024
    Public Const VI_ATTR_ASRL_FLOW_CNTRL As Integer = &H3FFF0025
    Public Const VI_ATTR_RD_BUF_OPER_MODE As Integer = &H3FFF002A
    Public Const VI_ATTR_WR_BUF_OPER_MODE As Integer = &H3FFF002D
    Public Const VI_ATTR_SUPPRESS_END_EN As Integer = &H3FFF0036
    Public Const VI_ATTR_TERMCHAR_EN As Integer = &H3FFF0038
    Public Const VI_ATTR_DEST_ACCESS_PRIV As Integer = &H3FFF0039
    Public Const VI_ATTR_DEST_BYTE_ORDER As Integer = &H3FFF003A
    Public Const VI_ATTR_SRC_ACCESS_PRIV As Integer = &H3FFF003C
    Public Const VI_ATTR_SRC_BYTE_ORDER As Integer = &H3FFF003D
    Public Const VI_ATTR_SRC_INCREMENT As Integer = &H3FFF0040
    Public Const VI_ATTR_DEST_INCREMENT As Integer = &H3FFF0041
    Public Const VI_ATTR_WIN_ACCESS_PRIV As Integer = &H3FFF0045
    Public Const VI_ATTR_WIN_BYTE_ORDER As Integer = &H3FFF0047
    Public Const VI_ATTR_USB_SERIAL_NUM As Integer = &HBFFF01A0
    Public Const VI_ATTR_GPIB_ATN_STATE As Integer = &H3FFF0057
    Public Const VI_ATTR_GPIB_ADDR_STATE As Integer = &H3FFF005C
    Public Const VI_ATTR_GPIB_CIC_STATE As Integer = &H3FFF005E
    Public Const VI_ATTR_GPIB_NDAC_STATE As Integer = &H3FFF0062
    Public Const VI_ATTR_GPIB_SRQ_STATE As Integer = &H3FFF0067
    Public Const VI_ATTR_GPIB_SYS_CNTRL_STATE As Integer = &H3FFF0068
    Public Const VI_ATTR_GPIB_HS488_CBL_LEN As Integer = &H3FFF0069
    Public Const VI_ATTR_CMDR_LA As Integer = &H3FFF006B
    Public Const VI_ATTR_VXI_DEV_CLASS As Integer = &H3FFF006C
    Public Const VI_ATTR_MAINFRAME_LA As Integer = &H3FFF0070
    Public Const VI_ATTR_MANF_NAME As Integer = &HBFFF0072
    Public Const VI_ATTR_MODEL_NAME As Integer = &HBFFF0077
    Public Const VI_ATTR_VXI_VME_INTR_STATUS As Integer = &H3FFF008B
    Public Const VI_ATTR_VXI_TRIG_STATUS As Integer = &H3FFF008D
    Public Const VI_ATTR_VXI_VME_SYSFAIL_STATE As Integer = &H3FFF0094
    Public Const VI_ATTR_WIN_BASE_ADDR As Integer = &H3FFF0098
    Public Const VI_ATTR_WIN_SIZE As Integer = &H3FFF009A
    Public Const VI_ATTR_ASRL_AVAIL_NUM As Integer = &H3FFF00AC
    Public Const VI_ATTR_MEM_BASE As Integer = &H3FFF00AD
    Public Const VI_ATTR_ASRL_CTS_STATE As Integer = &H3FFF00AE
    Public Const VI_ATTR_ASRL_DCD_STATE As Integer = &H3FFF00AF
    Public Const VI_ATTR_ASRL_DSR_STATE As Integer = &H3FFF00B1
    Public Const VI_ATTR_ASRL_DTR_STATE As Integer = &H3FFF00B2
    Public Const VI_ATTR_ASRL_END_IN As Integer = &H3FFF00B3
    Public Const VI_ATTR_ASRL_END_OUT As Integer = &H3FFF00B4
    Public Const VI_ATTR_ASRL_REPLACE_CHAR As Integer = &H3FFF00BE
    Public Const VI_ATTR_ASRL_RI_STATE As Integer = &H3FFF00BF
    Public Const VI_ATTR_ASRL_RTS_STATE As Integer = &H3FFF00C0
    Public Const VI_ATTR_ASRL_XON_CHAR As Integer = &H3FFF00C1
    Public Const VI_ATTR_ASRL_XOFF_CHAR As Integer = &H3FFF00C2
    Public Const VI_ATTR_WIN_ACCESS As Integer = &H3FFF00C3
    Public Const VI_ATTR_RM_SESSION As Integer = &H3FFF00C4
    Public Const VI_ATTR_VXI_LA As Integer = &H3FFF00D5
    Public Const VI_ATTR_MANF_ID As Integer = &H3FFF00D9
    Public Const VI_ATTR_MEM_SIZE As Integer = &H3FFF00DD
    Public Const VI_ATTR_MEM_SPACE As Integer = &H3FFF00DE
    Public Const VI_ATTR_MODEL_CODE As Integer = &H3FFF00DF
    Public Const VI_ATTR_SLOT As Integer = &H3FFF00E8
    Public Const VI_ATTR_INTF_INST_NAME As Integer = &HBFFF00E9
    Public Const VI_ATTR_IMMEDIATE_SERV As Integer = &H3FFF0100
    Public Const VI_ATTR_INTF_PARENT_NUM As Integer = &H3FFF0101
    Public Const VI_ATTR_RSRC_SPEC_VERSION As Integer = &H3FFF0170
    Public Const VI_ATTR_INTF_TYPE As Integer = &H3FFF0171
    Public Const VI_ATTR_GPIB_PRIMARY_ADDR As Integer = &H3FFF0172
    Public Const VI_ATTR_GPIB_SECONDARY_ADDR As Integer = &H3FFF0173
    Public Const VI_ATTR_RSRC_MANF_NAME As Integer = &HBFFF0174
    Public Const VI_ATTR_RSRC_MANF_ID As Integer = &H3FFF0175
    Public Const VI_ATTR_INTF_NUM As Integer = &H3FFF0176
    Public Const VI_ATTR_TRIG_ID As Integer = &H3FFF0177
    Public Const VI_ATTR_GPIB_REN_STATE As Integer = &H3FFF0181
    Public Const VI_ATTR_GPIB_UNADDR_EN As Integer = &H3FFF0184
    Public Const VI_ATTR_DEV_STATUS_BYTE As Integer = &H3FFF0189
    Public Const VI_ATTR_FILE_APPEND_EN As Integer = &H3FFF0192
    Public Const VI_ATTR_VXI_TRIG_SUPPORT As Integer = &H3FFF0194
    Public Const VI_ATTR_TCPIP_ADDR As Integer = &HBFFF0195
    Public Const VI_ATTR_TCPIP_HOSTNAME As Integer = &HBFFF0196
    Public Const VI_ATTR_TCPIP_PORT As Integer = &H3FFF0197
    Public Const VI_ATTR_TCPIP_DEVICE_NAME As Integer = &HBFFF0199
    Public Const VI_ATTR_TCPIP_NODELAY As Integer = &H3FFF019A
    Public Const VI_ATTR_TCPIP_KEEPALIVE As Integer = &H3FFF019B

    Public Const VI_ATTR_JOB_ID As Integer = &H3FFF4006
    Public Const VI_ATTR_EVENT_TYPE As Integer = &H3FFF4010
    Public Const VI_ATTR_SIGP_STATUS_ID As Integer = &H3FFF4011
    Public Const VI_ATTR_RECV_TRID_ID As Integer = &H3FFF4012
    Public Const VI_ATTR_INTR_STATUS_ID As Integer = &H3FFF4023
    Public Const VI_ATTR_STATUS As Integer = &H3FFF4025
    Public Const VI_ATTR_RET_COUNT As Integer = &H3FFF4026
    Public Const VI_ATTR_BUFFER As Integer = &H3FFF4027
    Public Const VI_ATTR_RECV_INTR_LEVEL As Integer = &H3FFF4041
    Public Const VI_ATTR_OPER_NAME As Integer = &HBFFF4042
    Public Const VI_ATTR_GPIB_RECV_CIC_STATE As Integer = &H3FFF4193
    Public Const VI_ATTR_RECV_TCPIP_ADDR As Integer = &HBFFF4198

    ' - Event Types -----------------------------------------------------------

    Public Const VI_EVENT_IO_COMPLETION As Integer = &H3FFF2009
    Public Const VI_EVENT_TRIG As Integer = &HBFFF200A
    Public Const VI_EVENT_SERVICE_REQ As Integer = &H3FFF200B
    Public Const VI_EVENT_CLEAR As Integer = &H3FFF200D
    Public Const VI_EVENT_EXCEPTION As Integer = &HBFFF200E
    Public Const VI_EVENT_GPIB_CIC As Integer = &H3FFF2012
    Public Const VI_EVENT_GPIB_TALK As Integer = &H3FFF2013
    Public Const VI_EVENT_GPIB_LISTEN As Integer = &H3FFF2014
    Public Const VI_EVENT_VXI_VME_SYSFAIL As Integer = &H3FFF201D
    Public Const VI_EVENT_VXI_VME_SYSRESET As Integer = &H3FFF201E
    Public Const VI_EVENT_VXI_SIGP As Integer = &H3FFF2020
    Public Const VI_EVENT_VXI_VME_INTR As Integer = &HBFFF2021
    Public Const VI_EVENT_TCPIP_CONNECT As Integer = &H3FFF2036

    Public Const VI_ALL_ENABLED_EVENTS As Integer = &H3FFF7FFF

    ' - Completion and Error Codes --------------------------------------------

    Public Const VI_SUCCESS As Integer = &H0
    Public Const VI_SUCCESS_EVENT_EN As Integer = &H3FFF0002
    Public Const VI_SUCCESS_EVENT_DIS As Integer = &H3FFF0003
    Public Const VI_SUCCESS_QUEUE_EMPTY As Integer = &H3FFF0004
    Public Const VI_SUCCESS_TERM_CHAR As Integer = &H3FFF0005
    Public Const VI_SUCCESS_MAX_CNT As Integer = &H3FFF0006
    Public Const VI_SUCCESS_DEV_NPRESENT As Integer = &H3FFF007D
    Public Const VI_SUCCESS_TRIG_MAPPED As Integer = &H3FFF007E
    Public Const VI_SUCCESS_QUEUE_NEMPTY As Integer = &H3FFF0080
    Public Const VI_SUCCESS_NCHAIN As Integer = &H3FFF0098
    Public Const VI_SUCCESS_NESTED_SHARED As Integer = &H3FFF0099
    Public Const VI_SUCCESS_NESTED_EXCLUSIVE As Integer = &H3FFF009A
    Public Const VI_SUCCESS_SYNC As Integer = &H3FFF009B

    Public Const VI_WARN_CONFIG_NLOADED As Integer = &H3FFF0077
    Public Const VI_WARN_NULL_OBJECT As Integer = &H3FFF0082
    Public Const VI_WARN_NSUP_ATTR_STATE As Integer = &H3FFF0084
    Public Const VI_WARN_UNKNOWN_STATUS As Integer = &H3FFF0085
    Public Const VI_WARN_NSUP_BUF As Integer = &H3FFF0088

    Public Const VI_ERROR_SYSTEM_ERROR As Integer = &HBFFF0000
    Public Const VI_ERROR_INV_OBJECT As Integer = &HBFFF000E
    Public Const VI_ERROR_INV_SESSION As Integer = &HBFFF000E
    Public Const VI_ERROR_RSRC_LOCKED As Integer = &HBFFF000F
    Public Const VI_ERROR_INV_EXPR As Integer = &HBFFF0010
    Public Const VI_ERROR_RSRC_NFOUND As Integer = &HBFFF0011
    Public Const VI_ERROR_INV_RSRC_NAME As Integer = &HBFFF0012
    Public Const VI_ERROR_INV_ACC_MODE As Integer = &HBFFF0013
    Public Const VI_ERROR_TMO As Integer = &HBFFF0015
    Public Const VI_ERROR_CLOSING_FAILED As Integer = &HBFFF0016
    Public Const VI_ERROR_INV_DEGREE As Integer = &HBFFF001B
    Public Const VI_ERROR_INV_JOB_ID As Integer = &HBFFF001C
    Public Const VI_ERROR_NSUP_ATTR As Integer = &HBFFF001D
    Public Const VI_ERROR_NSUP_ATTR_STATE As Integer = &HBFFF001E
    Public Const VI_ERROR_ATTR_READONLY As Integer = &HBFFF001F
    Public Const VI_ERROR_INV_LOCK_TYPE As Integer = &HBFFF0020
    Public Const VI_ERROR_INV_ACCESS_KEY As Integer = &HBFFF0021
    Public Const VI_ERROR_INV_EVENT As Integer = &HBFFF0026
    Public Const VI_ERROR_INV_MECH As Integer = &HBFFF0027
    Public Const VI_ERROR_HNDLR_NINSTALLED As Integer = &HBFFF0028
    Public Const VI_ERROR_INV_HNDLR_REF As Integer = &HBFFF0029
    Public Const VI_ERROR_INV_CONTEXT As Integer = &HBFFF002A
    Public Const VI_ERROR_NENABLED As Integer = &HBFFF002F
    Public Const VI_ERROR_ABORT As Integer = &HBFFF0030
    Public Const VI_ERROR_RAW_WR_PROT_VIOL As Integer = &HBFFF0034
    Public Const VI_ERROR_RAW_RD_PROT_VIOL As Integer = &HBFFF0035
    Public Const VI_ERROR_OUTP_PROT_VIOL As Integer = &HBFFF0036
    Public Const VI_ERROR_INP_PROT_VIOL As Integer = &HBFFF0037
    Public Const VI_ERROR_BERR As Integer = &HBFFF0038
    Public Const VI_ERROR_INV_SETUP As Integer = &HBFFF003A
    Public Const VI_ERROR_QUEUE_ERROR As Integer = &HBFFF003B
    Public Const VI_ERROR_ALLOC As Integer = &HBFFF003C
    Public Const VI_ERROR_INV_MASK As Integer = &HBFFF003D
    Public Const VI_ERROR_IO As Integer = &HBFFF003E
    Public Const VI_ERROR_INV_FMT As Integer = &HBFFF003F
    Public Const VI_ERROR_NSUP_FMT As Integer = &HBFFF0041
    Public Const VI_ERROR_LINE_IN_USE As Integer = &HBFFF0042
    Public Const VI_ERROR_NSUP_MODE As Integer = &HBFFF0046
    Public Const VI_ERROR_SRQ_NOCCURRED As Integer = &HBFFF004A
    Public Const VI_ERROR_INV_SPACE As Integer = &HBFFF004E
    Public Const VI_ERROR_INV_OFFSET As Integer = &HBFFF0051
    Public Const VI_ERROR_INV_WIDTH As Integer = &HBFFF0052
    Public Const VI_ERROR_NSUP_OFFSET As Integer = &HBFFF0054
    Public Const VI_ERROR_NSUP_VAR_WIDTH As Integer = &HBFFF0055
    Public Const VI_ERROR_WINDOW_NMAPPED As Integer = &HBFFF0057
    Public Const VI_ERROR_RESP_PENDING As Integer = &HBFFF0059
    Public Const VI_ERROR_NLISTENERS As Integer = &HBFFF005F
    Public Const VI_ERROR_NCIC As Integer = &HBFFF0060
    Public Const VI_ERROR_NSYS_CNTLR As Integer = &HBFFF0061
    Public Const VI_ERROR_NSUP_OPER As Integer = &HBFFF0067
    Public Const VI_ERROR_INTR_PENDING As Integer = &HBFFF0068
    Public Const VI_ERROR_ASRL_PARITY As Integer = &HBFFF006A
    Public Const VI_ERROR_ASRL_FRAMING As Integer = &HBFFF006B
    Public Const VI_ERROR_ASRL_OVERRUN As Integer = &HBFFF006C
    Public Const VI_ERROR_TRIG_NMAPPED As Integer = &HBFFF006E
    Public Const VI_ERROR_NSUP_ALIGN_OFFSET As Integer = &HBFFF0070
    Public Const VI_ERROR_USER_BUF As Integer = &HBFFF0071
    Public Const VI_ERROR_RSRC_BUSY As Integer = &HBFFF0072
    Public Const VI_ERROR_NSUP_WIDTH As Integer = &HBFFF0076
    Public Const VI_ERROR_INV_PARAMETER As Integer = &HBFFF0078
    Public Const VI_ERROR_INV_PROT As Integer = &HBFFF0079
    Public Const VI_ERROR_INV_SIZE As Integer = &HBFFF007B
    Public Const VI_ERROR_WINDOW_MAPPED As Integer = &HBFFF0080
    Public Const VI_ERROR_NIMPL_OPER As Integer = &HBFFF0081
    Public Const VI_ERROR_INV_LENGTH As Integer = &HBFFF0083
    Public Const VI_ERROR_INV_MODE As Integer = &HBFFF0091
    Public Const VI_ERROR_SESN_NLOCKED As Integer = &HBFFF009C
    Public Const VI_ERROR_MEM_NSHARED As Integer = &HBFFF009D
    Public Const VI_ERROR_LIBRARY_NFOUND As Integer = &HBFFF009E
    Public Const VI_ERROR_NSUP_INTR As Integer = &HBFFF009F
    Public Const VI_ERROR_INV_LINE As Integer = &HBFFF00A0
    Public Const VI_ERROR_FILE_ACCESS As Integer = &HBFFF00A1
    Public Const VI_ERROR_FILE_IO As Integer = &HBFFF00A2
    Public Const VI_ERROR_NSUP_LINE As Integer = &HBFFF00A3
    Public Const VI_ERROR_NSUP_MECH As Integer = &HBFFF00A4
    Public Const VI_ERROR_INTF_NUM_NCONFIG As Integer = &HBFFF00A5
    Public Const VI_ERROR_CONN_LOST As Integer = &HBFFF00A6

    ' - Other VISA Definitions ------------------------------------------------

    Public Const VI_FIND_BUFLEN As Short = 256

    Public Const VI_NULL As Short = 0
    Public Const VI_TRUE As Short = 1
    Public Const VI_FALSE As Short = 0

    Public Const VI_INTF_GPIB As Short = 1
    Public Const VI_INTF_VXI As Short = 2
    Public Const VI_INTF_GPIB_VXI As Short = 3
    Public Const VI_INTF_ASRL As Short = 4
    Public Const VI_INTF_TCPIP As Short = 6

    Public Const VI_NORMAL As Short = 1
    Public Const VI_FDC As Short = 2
    Public Const VI_HS488 As Short = 3
    Public Const VI_ASRL488 As Short = 4
    Public Const VI_PROT_4882_STRS As Short = 4

    Public Const VI_FDC_NORMAL As Short = 1
    Public Const VI_FDC_STREAM As Short = 2

    Public Const VI_LOCAL_SPACE As Short = 0
    Public Const VI_A16_SPACE As Short = 1
    Public Const VI_A24_SPACE As Short = 2
    Public Const VI_A32_SPACE As Short = 3

    Public Const VI_UNKNOWN_LA As Short = -1
    Public Const VI_UNKNOWN_SLOT As Short = -1
    Public Const VI_UNKNOWN_LEVEL As Short = -1

    Public Const VI_QUEUE As Short = 1
    Public Const VI_ALL_MECH As Short = &HFFFFS

    Public Const VI_TRIG_ALL As Short = -2
    Public Const VI_TRIG_SW As Short = -1
    Public Const VI_TRIG_TTL0 As Short = 0
    Public Const VI_TRIG_TTL1 As Short = 1
    Public Const VI_TRIG_TTL2 As Short = 2
    Public Const VI_TRIG_TTL3 As Short = 3
    Public Const VI_TRIG_TTL4 As Short = 4
    Public Const VI_TRIG_TTL5 As Short = 5
    Public Const VI_TRIG_TTL6 As Short = 6
    Public Const VI_TRIG_TTL7 As Short = 7
    Public Const VI_TRIG_ECL0 As Short = 8
    Public Const VI_TRIG_ECL1 As Short = 9
    Public Const VI_TRIG_PANEL_IN As Short = 27
    Public Const VI_TRIG_PANEL_OUT As Short = 28

    Public Const VI_TRIG_PROT_DEFAULT As Short = 0
    Public Const VI_TRIG_PROT_ON As Short = 1
    Public Const VI_TRIG_PROT_OFF As Short = 2
    Public Const VI_TRIG_PROT_SYNC As Short = 5

    Public Const VI_READ_BUF As Short = 1
    Public Const VI_WRITE_BUF As Short = 2
    Public Const VI_READ_BUF_DISCARD As Short = 4
    Public Const VI_WRITE_BUF_DISCARD As Short = 8
    Public Const VI_ASRL_IN_BUF As Short = 16
    Public Const VI_ASRL_OUT_BUF As Short = 32
    Public Const VI_ASRL_IN_BUF_DISCARD As Short = 64
    Public Const VI_ASRL_OUT_BUF_DISCARD As Short = 128
    Public Const VI_IO_IN_BUF As Short = 16
    Public Const VI_IO_OUT_BUF As Short = 32
    Public Const VI_IO_IN_BUF_DISCARD As Short = 64
    Public Const VI_IO_OUT_BUF_DISCARD As Short = 128

    Public Const VI_FLUSH_ON_ACCESS As Short = 1
    Public Const VI_FLUSH_WHEN_FULL As Short = 2
    Public Const VI_FLUSH_DISABLE As Short = 3

    Public Const VI_NMAPPED As Short = 1
    Public Const VI_USE_OPERS As Short = 2
    Public Const VI_DEREF_ADDR As Short = 3

    Public Const VI_TMO_IMMEDIATE As Integer = &H0
    Public Const VI_TMO_INFINITE As Integer = &HFFFFFFFF
    Public Const VI_INFINITE As Integer = &HFFFFFFFF

    Public Const VI_NO_LOCK As Short = 0
    Public Const VI_EXCLUSIVE_LOCK As Short = 1
    Public Const VI_SHARED_LOCK As Short = 2
    Public Const VI_LOAD_CONFIG As Short = 4

    Public Const VI_NO_SEC_ADDR As Short = &HFFFFS

    Public Const VI_ASRL_PAR_NONE As Short = 0
    Public Const VI_ASRL_PAR_ODD As Short = 1
    Public Const VI_ASRL_PAR_EVEN As Short = 2
    Public Const VI_ASRL_PAR_MARK As Short = 3
    Public Const VI_ASRL_PAR_SPACE As Short = 4

    Public Const VI_ASRL_STOP_ONE As Short = 10
    Public Const VI_ASRL_STOP_ONE5 As Short = 15
    Public Const VI_ASRL_STOP_TWO As Short = 20

    Public Const VI_ASRL_FLOW_NONE As Short = 0
    Public Const VI_ASRL_FLOW_XON_XOFF As Short = 1
    Public Const VI_ASRL_FLOW_RTS_CTS As Short = 2
    Public Const VI_ASRL_FLOW_DTR_DSR As Short = 4

    Public Const VI_ASRL_END_NONE As Short = 0
    Public Const VI_ASRL_END_LAST_BIT As Short = 1
    Public Const VI_ASRL_END_TERMCHAR As Short = 2
    Public Const VI_ASRL_END_BREAK As Short = 3

    Public Const VI_STATE_ASSERTED As Short = 1
    Public Const VI_STATE_UNASSERTED As Short = 0
    Public Const VI_STATE_UNKNOWN As Short = -1

    Public Const VI_BIG_ENDIAN As Short = 0
    Public Const VI_LITTLE_ENDIAN As Short = 1

    Public Const VI_DATA_PRIV As Short = 0
    Public Const VI_DATA_NPRIV As Short = 1
    Public Const VI_PROG_PRIV As Short = 2
    Public Const VI_PROG_NPRIV As Short = 3
    Public Const VI_BLCK_PRIV As Short = 4
    Public Const VI_BLCK_NPRIV As Short = 5
    Public Const VI_D64_PRIV As Short = 6
    Public Const VI_D64_NPRIV As Short = 7

    Public Const VI_WIDTH_8 As Short = 1
    Public Const VI_WIDTH_16 As Short = 2
    Public Const VI_WIDTH_32 As Short = 4

    Public Const VI_GPIB_REN_DEASSERT As Short = 0
    Public Const VI_GPIB_REN_ASSERT As Short = 1
    Public Const VI_GPIB_REN_DEASSERT_GTL As Short = 2
    Public Const VI_GPIB_REN_ASSERT_ADDRESS As Short = 3
    Public Const VI_GPIB_REN_ASSERT_LLO As Short = 4
    Public Const VI_GPIB_REN_ASSERT_ADDRESS_LLO As Short = 5
    Public Const VI_GPIB_REN_ADDRESS_GTL As Short = 6

    Public Const VI_GPIB_ATN_DEASSERT As Short = 0
    Public Const VI_GPIB_ATN_ASSERT As Short = 1
    Public Const VI_GPIB_ATN_DEASSERT_HANDSHAKE As Short = 2
    Public Const VI_GPIB_ATN_ASSERT_IMMEDIATE As Short = 3

    Public Const VI_GPIB_HS488_DISABLED As Short = 0
    Public Const VI_GPIB_HS488_NIMPL As Short = -1

    Public Const VI_GPIB_UNADDRESSED As Short = 0
    Public Const VI_GPIB_TALKER As Short = 1
    Public Const VI_GPIB_LISTENER As Short = 2

    Public Const VI_VXI_CMD16 As Short = &H200S
    Public Const VI_VXI_CMD16_RESP16 As Short = &H202S
    Public Const VI_VXI_RESP16 As Short = &H2S
    Public Const VI_VXI_CMD32 As Short = &H400S
    Public Const VI_VXI_CMD32_RESP16 As Short = &H402S
    Public Const VI_VXI_CMD32_RESP32 As Short = &H404S
    Public Const VI_VXI_RESP32 As Short = &H4S

    Public Const VI_ASSERT_SIGNAL As Short = -1
    Public Const VI_ASSERT_USE_ASSIGNED As Short = 0
    Public Const VI_ASSERT_IRQ1 As Short = 1
    Public Const VI_ASSERT_IRQ2 As Short = 2
    Public Const VI_ASSERT_IRQ3 As Short = 3
    Public Const VI_ASSERT_IRQ4 As Short = 4
    Public Const VI_ASSERT_IRQ5 As Short = 5
    Public Const VI_ASSERT_IRQ6 As Short = 6
    Public Const VI_ASSERT_IRQ7 As Short = 7

    Public Const VI_UTIL_ASSERT_SYSRESET As Short = 1
    Public Const VI_UTIL_ASSERT_SYSFAIL As Short = 2
    Public Const VI_UTIL_DEASSERT_SYSFAIL As Short = 3

    Public Const VI_VXI_CLASS_MEMORY As Short = 0
    Public Const VI_VXI_CLASS_EXTENDED As Short = 1
    Public Const VI_VXI_CLASS_MESSAGE As Short = 2
    Public Const VI_VXI_CLASS_REGISTER As Short = 3
    Public Const VI_VXI_CLASS_OTHER As Short = 4


    ''' ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''VISA LIBRARY IMPORTS''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''






    Function FindSiglent() As Integer

        status = 0
        defaultRM = 0
        instrResourceString = "USB0::0x0483::0x7540::SPD3XHB4161425::INSTR"
        findList = 1
        numlnstrs = 0


        status = viOpenDefaultRM(defaultRM)
        If (status < VI_SUCCESS) Then
            Debug.Print("Could not open a session to the VISA Resource Manager!")
            FindSiglent = status
            Exit Function
        End If


        status = viParseRsrc(defaultRM, instrResourceString, 7, 0)

        status = viOpen(defaultRM, instrResourceString, 0, 0, instrsesn)

        status = viGetAttribute(instrsesn, VI_ATTR_RSRC_NAME, instrResourceString)
        status = viGetAttribute(instrsesn, VI_ATTR_INTF_TYPE, 7)
        status = viGetAttribute(instrsesn, VI_ATTR_INTF_TYPE, 7)
        status = viGetAttribute(instrsesn, VI_ATTR_RSRC_CLASS, "INSTR")
        status = viGetAttribute(instrsesn, VI_ATTR_RSRC_NAME, instrResourceString)
        status = viGetAttribute(instrsesn, VI_ATTR_MANF_NAME, "Siglent")
        status = viGetAttribute(instrsesn, VI_ATTR_MANF_ID, 1155)
        status = viGetAttribute(instrsesn, VI_ATTR_MODEL_NAME, "SPD3000")
        status = viGetAttribute(instrsesn, VI_ATTR_MODEL_CODE, 30016)
        status = viGetAttribute(instrsesn, VI_ATTR_USB_SERIAL_NUM, "SPD3XHB4161425")
        status = viGetAttribute(instrsesn, VI_ATTR_TMO_VALUE, 2000)
        status = viGetAttribute(instrsesn, VI_ATTR_TERMCHAR_EN, VI_FALSE)
        status = viGetAttribute(instrsesn, VI_ATTR_TERMCHAR, 10)
        status = viGetAttribute(instrsesn, VI_ATTR_SEND_END_EN, VI_TRUE)
        status = viGetAttribute(instrsesn, VI_ATTR_IO_PROT, 1)


        FindSiglent = 0
    End Function




    Sub Y_SIGCH1(ByVal Current As Single)
        Dim SigSMU As Integer

        status = 0
        SigSMU = FindSiglent()

        status = viWrite(instrsesn, "CH1:CURRent " & Trim(Format(Current, "Scientific")), 18, 18)
        status = viWrite(instrsesn, "OUTPut CH1,ON ", 18, 18)
    End Sub

    Sub X_SIGCH2(ByVal Current As Single)
        Dim SigSMU As Integer

        status = 0
        SigSMU = FindSiglent()

        status = viWrite(instrsesn, "CH2:CURRent " & Trim(Format(Current, "Scientific")), 18, 18)
        status = viWrite(instrsesn, "OUTPut CH2,ON ", 18, 18)

    End Sub

    Sub Siglent_Abort()
        Dim SigSMU As Integer

        status = 0
        SigSMU = FindSiglent()
        System.Threading.Thread.Sleep(10000)

        'status = viWrite(instrsesn, "CH2:CURRent " & Trim(Format(Current, "Scientific")), 18, 18)
        status = viWrite(instrsesn, "OUTPut CH1,OFF ", 14, 14)
        System.Threading.Thread.Sleep(10000)
        status = viWrite(instrsesn, "OUTPut CH2,OFF ", 14, 14)

    End Sub



    Sub Set_Pulse_Generator()              '''''''''set the pulse generator to Sine wave and 50ohms output and 0-5V output

        Dim ioMgr As Ivi.Visa.Interop.ResourceManager
        Dim instrument As Ivi.Visa.Interop.FormattedIO488
        Dim idn As String

        ioMgr = New Ivi.Visa.Interop.ResourceManager
        instrument = New Ivi.Visa.Interop.FormattedIO488

        instrument.IO = ioMgr.Open("ASRL4::INSTR")
        System.Threading.Thread.Sleep(1000)
        instrument.WriteString("FREQ 10")
        System.Threading.Thread.Sleep(1000)
        instrument.WriteString("ZLOAD OPEN")
        System.Threading.Thread.Sleep(1000)
        instrument.WriteString("HILVL 10")
        System.Threading.Thread.Sleep(1000)
        instrument.WriteString("LOLVL 0")
        System.Threading.Thread.Sleep(1000)
        instrument.WriteString("HILVL 10")
        System.Threading.Thread.Sleep(1000)
        instrument.WriteString("OUTPUT ON")

        instrument.IO.Close()

    End Sub

    Sub FRE_PulseGenerator(ByVal Frequency As Single)

        Dim ioMgr As Ivi.Visa.Interop.ResourceManager
        Dim instrument As Ivi.Visa.Interop.FormattedIO488
        Dim idn As String

        ioMgr = New Ivi.Visa.Interop.ResourceManager
        instrument = New Ivi.Visa.Interop.FormattedIO488

        instrument.IO = ioMgr.Open("ASRL4::INSTR")

        instrument.WriteString("FREQ " & Trim(Format(Frequency, "Scientific")))

        instrument.IO.Close()


    End Sub

    Sub PG_OFF()
        Dim ioMgr As Ivi.Visa.Interop.ResourceManager
        Dim instrument As Ivi.Visa.Interop.FormattedIO488
        Dim idn As String

        ioMgr = New Ivi.Visa.Interop.ResourceManager
        instrument = New Ivi.Visa.Interop.FormattedIO488

        instrument.IO = ioMgr.Open("ASRL4::INSTR")

        instrument.WriteString("OUTPUT OFF")

        instrument.IO.Close()
    End Sub



    Function SigClosee() As Integer
        Dim SigSMU As Integer

        status = 0
        SigSMU = FindSiglent()
        status = viClose(instrsesn)
        SigClosee = 0
    End Function


    Function FindAgilent() As Integer

        status = 0
        defaultRM = 0
        instrResourceString = "GPIB0::16::INSTR"
        findList = 1
        numlnstrs = 0


        status = viOpenDefaultRM(defaultRM)
        If (status < VI_SUCCESS) Then
            Debug.Print("Could not open a session to the VISA Resource Manager!")
            FindAgilent = status
            Exit Function
        End If


        status = viParseRsrc(defaultRM, instrResourceString, 1, 0)

        status = viOpen(defaultRM, instrResourceString, 0, 0, instrsesn)

        status = viGetAttribute(instrsesn, VI_ATTR_RSRC_NAME, instrResourceString)
        status = viGetAttribute(instrsesn, VI_ATTR_INTF_TYPE, 1)
        status = viGetAttribute(instrsesn, VI_ATTR_INTF_NUM, 0)
        status = viGetAttribute(instrsesn, VI_ATTR_INTF_TYPE, 1)
        status = viGetAttribute(instrsesn, VI_ATTR_RSRC_CLASS, "INSTR")
        status = viGetAttribute(instrsesn, VI_ATTR_RSRC_NAME, instrResourceString)
        status = viGetAttribute(instrsesn, VI_ATTR_GPIB_PRIMARY_ADDR, 16)
        status = viGetAttribute(instrsesn, VI_ATTR_GPIB_SECONDARY_ADDR, 65535)
        status = viGetAttribute(instrsesn, VI_ATTR_GPIB_READDR_EN, VI_TRUE)
        status = viGetAttribute(instrsesn, VI_ATTR_GPIB_UNADDR_EN, VI_FALSE)
        status = viGetAttribute(instrsesn, VI_ATTR_SEND_END_EN, VI_TRUE)
        status = viGetAttribute(instrsesn, VI_ATTR_TMO_VALUE, 3000)
        status = viGetAttribute(instrsesn, VI_ATTR_GPIB_REN_STATE, 1)
        status = viGetAttribute(instrsesn, VI_ATTR_TERMCHAR_EN, VI_FALSE)
        status = viGetAttribute(instrsesn, VI_ATTR_TERMCHAR, 10)
        status = viGetAttribute(instrsesn, VI_ATTR_IO_PROT, 1)


        FindAgilent = 0
    End Function


    Sub Z_AGICH2(ByVal Current As Single)
        Dim GpibDevice = New Device(0, CInt(GPIBSource))
        GpibDevice.Write(":SOUR2:CURR  " & Trim(Current))


        'status = viWrite(instrsesn, ":OUTP2 ON", 20, 20)

    End Sub

    Sub Z_KEI(ByVal Current As Single)
        Dim GpibDevice = New Device(0, CInt(GPIBKeith))
        GpibDevice.Write(":SOUR:CURR  " & Trim(Current))

        System.Threading.Thread.Sleep(100)
        GpibDevice.Dispose()
        'status = viWrite(instrsesn, ":OUTP2 ON", 20, 20)

    End Sub

    Sub B_IRelationTest()
        Dim DriveI(10) As Single
        Dim Bfield(10) As Single
        Dim Num As Integer

        DriveI = New Single(10) {-0.1, -0.11, -0.12, -0.13, -0.14, -0.15, -0.16, -0.17, -0.18, -0.19, -0.2}
        Bfield = New Single(10) {}
        Num = 0


        'ONAGI_CH2()
        ONKEI_SM()

        System.Threading.Thread.Sleep(1000)

        Do Until Num = 10
            'Z_AGICH2(DriveI(Num))
            Z_KEI(DriveI(Num))
            System.Threading.Thread.Sleep(3000)
            Bfield(Num) = B2_Reading()
            Num = Num + 1
        Loop

        System.Threading.Thread.Sleep(1000)

        'AbortAGI_CH2()
        AbortKEI_SM()

        Filename = "BI.txt"
        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}"
        objWriterTrans.WriteLine("{0,-10}{1,-16}", "Bfield", "Drive Current")
        For x = 0 To Num - 1
            objWriterTrans.WriteLine(LineFormatTrans, Bfield(x), DriveI(x))
        Next
        objWriterTrans.Close()

    End Sub



    Sub TEST_ZMEAS()
        Dim a As Single
        Z_AGICH2_MEAS(0.000004)
        a = AGICH2_coil_current_reading()

        Filename = "test.txt"
        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormatTrans As String = "{0,-10}"
        objWriterTrans.WriteLine("{0,-10}", "curr")

        objWriterTrans.WriteLine(LineFormatTrans, a)

        objWriterTrans.Close()
    End Sub

    Sub Z_AGICH2_MEAS(ByVal Current As Single)
        Dim GpibDevice = New Device(0, CInt(GPIBSource))



        GpibDevice.Write(":SOUR2:CURR  " & Trim(Current))
        '
        GpibDevice.Write(":OUTP2 ON")
        '
        GpibDevice.Write(":SOUR2:CURR:MODE SWE")
        '
        GpibDevice.Write(":SOUR2:CURR:STAR " & Trim(Current))
        '
        GpibDevice.Write(":SOUR2:CURR:STOP " & Trim(Current))

        GpibDevice.Write(":SOUR2:CURR:POIN 1")
        '
        GpibDevice.Write(":TRIG2:COUN 1")




        'status = viWrite(instrsesn, ":OUTP2 ON", 20, 20)

    End Sub

    Function AgiClosee() As Integer
        Dim AgiSMU As Integer

        status = 0
        AgiSMU = FindAgilent()
        status = viClose(instrsesn)
        AgiClosee = 0
    End Function

    Function FindGaussmeter_1() As Integer
        status = 0
        defaultRM = 0
        instrResourceString = "GPIB0::12::INSTR"
        findList = 1
        numlnstrs = 0


        status = viOpenDefaultRM(defaultRM)
        If (status < VI_SUCCESS) Then
            Debug.Print("Could not open a session to the VISA Resource Manager!")
            FindGaussmeter_1 = status
            Exit Function
        End If


        status = viParseRsrc(defaultRM, instrResourceString, 1, 0)

        status = viOpen(defaultRM, instrResourceString, 0, 0, instrsesn)

        status = viGetAttribute(instrsesn, VI_ATTR_RSRC_NAME, instrResourceString)
        status = viGetAttribute(instrsesn, VI_ATTR_INTF_TYPE, 1)
        status = viGetAttribute(instrsesn, VI_ATTR_INTF_NUM, 0)
        status = viGetAttribute(instrsesn, VI_ATTR_INTF_TYPE, 1)
        status = viGetAttribute(instrsesn, VI_ATTR_RSRC_CLASS, "INSTR")
        status = viGetAttribute(instrsesn, VI_ATTR_RSRC_NAME, instrResourceString)
        status = viGetAttribute(instrsesn, VI_ATTR_GPIB_PRIMARY_ADDR, 12)
        status = viGetAttribute(instrsesn, VI_ATTR_GPIB_SECONDARY_ADDR, 65535)
        status = viGetAttribute(instrsesn, VI_ATTR_GPIB_READDR_EN, VI_TRUE)
        status = viGetAttribute(instrsesn, VI_ATTR_GPIB_UNADDR_EN, VI_FALSE)
        status = viGetAttribute(instrsesn, VI_ATTR_SEND_END_EN, VI_TRUE)
        status = viGetAttribute(instrsesn, VI_ATTR_TMO_VALUE, 3000)
        status = viGetAttribute(instrsesn, VI_ATTR_GPIB_REN_STATE, 1)
        status = viGetAttribute(instrsesn, VI_ATTR_TERMCHAR_EN, VI_FALSE)
        status = viGetAttribute(instrsesn, VI_ATTR_TERMCHAR, 10)
        status = viGetAttribute(instrsesn, VI_ATTR_IO_PROT, 1)


        FindGaussmeter_1 = 0
    End Function

    Function Gaussmeter_1Closee() As Integer
        Dim Gssmtr1 As Integer

        status = 0
        Gssmtr1 = FindGaussmeter_1()
        status = viClose(instrsesn)
        Gaussmeter_1Closee = 0
    End Function

    Function Gaussmeter_2Closee() As Integer
        Dim Gssmtr2 As Integer

        status = 0
        Gssmtr2 = FindGaussmeter_2()
        status = viClose(instrsesn)
        Gaussmeter_2Closee = 0
    End Function

    Function FindGaussmeter_2() As Integer
        status = 0
        defaultRM = 0
        instrResourceString = "GPIB0::10::INSTR"
        findList = 1
        numlnstrs = 0


        status = viOpenDefaultRM(defaultRM)
        If (status < VI_SUCCESS) Then
            Debug.Print("Could not open a session to the VISA Resource Manager!")
            FindGaussmeter_2 = status
            Exit Function
        End If


        status = viParseRsrc(defaultRM, instrResourceString, 1, 0)

        status = viOpen(defaultRM, instrResourceString, 0, 0, instrsesn)

        status = viGetAttribute(instrsesn, VI_ATTR_RSRC_NAME, instrResourceString)
        status = viGetAttribute(instrsesn, VI_ATTR_INTF_TYPE, 1)
        status = viGetAttribute(instrsesn, VI_ATTR_INTF_NUM, 0)
        status = viGetAttribute(instrsesn, VI_ATTR_INTF_TYPE, 1)
        status = viGetAttribute(instrsesn, VI_ATTR_RSRC_CLASS, "INSTR")
        status = viGetAttribute(instrsesn, VI_ATTR_RSRC_NAME, instrResourceString)
        status = viGetAttribute(instrsesn, VI_ATTR_GPIB_PRIMARY_ADDR, 10)
        status = viGetAttribute(instrsesn, VI_ATTR_GPIB_SECONDARY_ADDR, 65535)
        status = viGetAttribute(instrsesn, VI_ATTR_GPIB_READDR_EN, VI_TRUE)
        status = viGetAttribute(instrsesn, VI_ATTR_GPIB_UNADDR_EN, VI_FALSE)
        status = viGetAttribute(instrsesn, VI_ATTR_SEND_END_EN, VI_TRUE)
        status = viGetAttribute(instrsesn, VI_ATTR_TMO_VALUE, 3000)
        status = viGetAttribute(instrsesn, VI_ATTR_GPIB_REN_STATE, 1)
        status = viGetAttribute(instrsesn, VI_ATTR_TERMCHAR_EN, VI_FALSE)
        status = viGetAttribute(instrsesn, VI_ATTR_TERMCHAR, 10)
        status = viGetAttribute(instrsesn, VI_ATTR_IO_PROT, 1)


        FindGaussmeter_2 = 0
    End Function

    Function FindNewport() As Integer
        Dim MessageIn As String
FindNewportAgain:
        NewportPresent = False
        Try
            Dim GpibDevice = New Device(0, CInt(GPIBNewport))
            'Do
            'Loop Until GpibDevice.SerialPoll And 128
            'GpibDevice.Write("*IDN?")
            GPIBOut("*IDN?", GpibDevice)
            'Do
            'Loop Until GpibDevice.SerialPoll And 16
            MessageIn = GPIBIn(GpibDevice) 'GpibDevice.ReadString()
            '
            If Left$(MessageIn, 7) = "NewportCorp,1835-C" Then
                NewportPresent = 1
                ' Clear input buffer
                GpibDevice.Clear()
                Do
                Loop Until GpibDevice.SerialPoll And 128
                '   Set the autoranging ON
                GpibDevice.Write("AUTO 1")
                MessageIn = GpibDevice.ReadString()
                '   set the FILTER to NO FILTER
                GpibDevice.Write("FILTER 1")
                '   set the ZERO to OFF
                GpibDevice.Write("ZERO 0")
                '   set the ZERO to OFF
                GpibDevice.Write("ATTN 0")
                '   Find the current calibration wavelength
                System.Threading.Thread.Sleep(500)
                GpibDevice.Write("LAMBDA?")
                MessageIn = GpibDevice.ReadString()
                ''IVLData.Wavelength = Val(MessageIn)
                '
            ElseIf Left$(MessageIn, 18) = "Newport Corp.,1830" Then
                NewportPresent = 2
                ' Clear input buffer
                GpibDevice.Clear()
                'Do
                'Loop Until GpibDevice.SerialPoll And 128
                '   Set the autoranging ON
                'GpibDevice.Write("R0")
                GPIBOut("R0", GpibDevice)
                'Do
                'Loop Until GpibDevice.SerialPoll And 128
                '   set the FILTER to NO FILTER
                'GpibDevice.Write("F2")
                GPIBOut("F2", GpibDevice)
                'Do
                'Loop Until GpibDevice.SerialPoll And 128
                '   set the ZERO to OFF
                'GpibDevice.Write("Z0")
                GPIBOut("Z0", GpibDevice)
                '   set the ZERO to OFF
                'Do
                'Loop Until GpibDevice.SerialPoll And 128
                'GpibDevice.Write("A0")
                GPIBOut("A0", GpibDevice)
                '   set the Units to Watts
                'Do
                'Loop Until GpibDevice.SerialPoll And 128
                'GpibDevice.Write("U1")
                GPIBOut("U1", GpibDevice)
                '   Find the current calibration wavelength
                'Do
                'Loop Until GpibDevice.SerialPoll And 128
                'GpibDevice.Write("W?")
                GPIBOut("W?", GpibDevice)
                'Do
                'Loop Until GpibDevice.SerialPoll And 16
                MessageIn = GPIBIn(GpibDevice) 'GpibDevice.ReadString()
                '' IVLData.Wavelength = Val(Left(MessageIn, 4))
                '
            Else
                GpibDevice.Dispose()
                Throw New System.Exception("An exception has occurred.")
            End If
            GpibDevice.Dispose()
        Catch
            Dim message As String = "Newport not found. Do you want to try again?"
            Dim caption As String = ""
            Dim buttons As MessageBoxButtons = MessageBoxButtons.YesNo
            ' Show message box
            Dim result As MsgBoxResult = MessageBox.Show(message, caption, buttons)
            If result = vbYes Then
                GoTo FindNewportAgain
            End If
        End Try
    End Function

    Function NewportClosee() As Integer
        Dim Nwprt As Integer

        status = 0
        Nwprt = FindNewport()

        status = viClose(instrsesn)
        NewportClosee = 0
    End Function

    Public Sub GPIBOut(ByVal GPIBMessageOut As String, ByVal e As Device)
        Dim status As Integer, X As Integer
        '    If NewportPresent = 0 Then Exit Function
        On Error GoTo GPIBOutError
        Do
            status = e.SerialPoll
            'Call ReadStatusByte(GPIB0, GPIBDevice, status)
            X = X + 1
            If X > 50 Then
                e.Clear()
                'Call DevClear(GPIB0, GPIBDevice)
                'ibsta = ibsta Or &H8000
                Exit Sub
            End If
            'If (ibsta And &H8000) Then Exit Function
            'Sleep(100)
        Loop Until (status And 32) <> 32
        e.Write(GPIBMessageOut)
        'Send(GPIB0, GPIBDevice, GPIBMessageOut, DABend)
        Exit Sub
GPIBOutError:

    End Sub

    Public Function GPIBIn(ByVal e As Device) As String
        Dim status As Integer, X As Integer
        '    If NewportPresent = 0 Then Exit Function
        GPIBIn = Space$(20)
        Do
            status = e.SerialPoll
            X = X + 1
            If X > 50 Then
                e.Clear()
                'Call DevClear(GPIB0, GPIBDevice)
                'ibsta = ibsta Or &H8000
                Exit Function
            End If
            'If (ibsta And &H8000) Then Exit Function
            'DoEvents()
            'Sleep(100)
        Loop Until (status And 16) = 16
        GPIBIn = e.ReadString()
        'Receive(GPIB0, GPIBDevice, MsgIn, STOPend)
        'If (ibsta And &H8000) Then Exit Function
        '    GPIBIn = Left$(MsgIn, InStr(1, MsgIn, Chr$(13)) - 1)
        'buffer = MsgIn
    End Function


    Function ReadIntensity() As Single
        ReadIntensity = 0
        If NewportPresent Then
            Dim GpibDevice = New Device(0, CInt(GPIBNewport))
            Dim MessageIn As String
ReadAgain:
            If NewportPresent = 1 Then
                MessageIn = "RWS?"
            Else
                MessageIn = "D?"
            End If
            GPIBOut(MessageIn, GpibDevice)
            'GpibDevice.Write(MessageIn)
            System.Threading.Thread.Sleep(100)
            'MessageIn = GpibDevice.ReadString()
            MessageIn = GPIBIn(GpibDevice)
            If Val(MessageIn) > 2 Then
                System.Threading.Thread.Sleep(100)
                GoTo ReadAgain
            End If
            Try
                If NewportPresent = 1 Then
                    MessageIn = Right$(MessageIn, 18)
                    ReadIntensity = Val(Left(MessageIn, InStr(MessageIn, Chr(10)) - 1))
                Else
                    MessageIn = Left$(MessageIn, 18)
                    ReadIntensity = Val(Left(MessageIn, InStr(MessageIn, Chr(10)) - 1))
                End If
            Catch
                GoTo ReadAgain
            End Try
            System.Threading.Thread.Sleep(100)
            GpibDevice.Dispose()
        End If


    End Function

    Sub DUT_AGICH1_OFF()
        Dim GpibDevice = New Device(0, CInt(GPIBSource))


        GpibDevice.Write(":OUTP1 OFF")

    End Sub

    Sub DUT_AGICH1CURR(ByVal I As Single)

        Dim GpibDevice = New Device(0, CInt(GPIBSource))

        GpibDevice.Write(":OUTP1:OFF:MODE HIGH")
        GpibDevice.Write(":SOUR1:CURR " & Trim(Format(I, "Scientific")))

        GpibDevice.Write(":OUTP1 ON")

        System.Threading.Thread.Sleep(100)
        GpibDevice.Dispose()

    End Sub

    Sub DUT_AGICH1VOLT(ByVal V As Single)

        Dim GpibDevice = New Device(0, CInt(GPIBSource))

        GpibDevice.Write(":OUTP1:OFF:MODE HIGH")
        GpibDevice.Write(":SOUR1:VOLT:MODE FIXED")
        GpibDevice.Write(":SOUR1:VOLT " & Trim(Format(V, "Scientific")))

        GpibDevice.Write(":OUTP1 ON")

        System.Threading.Thread.Sleep(100)
        GpibDevice.Dispose()

    End Sub

    Function DUT_AGICH1(ByVal V As Single) As Integer
        Dim AgiSMU As Integer

        status = 0
        AgiSMU = FindAgilent()

        status = viWrite(instrsesn, ":SOUR1:VOLT " & Trim(Format(V, "Scientific")), 20, 20)    'Sourcing the channel 1

        status = viWrite(instrsesn, ":OUTP1 ON", 20, 20)               'Start sourcing

        status = viWrite(instrsesn, ":SOUR1:VOLT:MODE SWE", 20, 20)    'sweeping mode for channel 1

        status = viWrite(instrsesn, ":SOUR1:VOLT:STAR " & Trim(Format(V, "Scientific")), 20, 20)      'Starting at V volts

        status = viWrite(instrsesn, ":SOUR1:VOLT:STOP " & Trim(Format(V, "Scientific")), 20, 20)     'Stopping at V volts

        status = viWrite(instrsesn, ":SOUR1:VOLT:POIN 1", 20, 20)     'Single pulse

        status = viWrite(instrsesn, ":TRIG1:SOUR TIM", 20, 20)         'Timer triggering mode

        status = viWrite(instrsesn, ":TRIG1:TRAN:COUN 1", 20, 20)       'single trigger

        status = viWrite(instrsesn, ":TRIG1:ACQ:COUN 600", 20, 20)      '600 points measurement          '''''''''''''''''''''how many points exactly needed needs to be tested through real magnetic field 

        status = viWrite(instrsesn, ":TRIG1:TRAN:DEL 0", 20, 20)        'Trigger delay for 1ms

        status = viWrite(instrsesn, ":TRIG1:ACQ:DEL 0", 20, 20)         'No measurement delay 

        status = viWrite(instrsesn, ":TRIG1:TIM 20E-06", 20, 20)        'trigger and measurement period 20us

        status = viWrite(instrsesn, ":OUTP1:OFF:MODE NORM", 20, 20)      'off-output status---normal

        status = viWrite(instrsesn, ":SENS1:CURR:PROT 25E-06", 20, 20)   'current compliance 25uA



        '''''''''''''dispose code needs to be considered later'''''''''''''''''''

        DUT_AGICH1 = 0

    End Function

    Function Z_ReadCurrent_AGICH2() As Single
        Z_ReadCurrent_AGICH2 = 0

        Dim GPIBSource As Integer
        GPIBSource = 16
        Dim Statuss As Integer

        Dim MessageIn As String, X As Integer

        MessageIn = ""

        Dim GpibDevice = New Device(0, CInt(GPIBSource))
        GpibDevice.DefaultBufferSize = 64000

        GpibDevice.Write(":SOUR2:CURR?") '''''need to check if its right?
        '
        '' System.Threading.Thread.Sleep(1000)

        ''GpibDevice.Write(":FETC2:ARR:CURR?")
        Do
            Statuss = GpibDevice.SerialPoll
            Application.DoEvents()

        Loop Until (Statuss And 16) = 16
        MessageIn = MessageIn & GpibDevice.ReadString()


        Z_ReadCurrent_AGICH2 = Val(MessageIn)

    End Function

    Function AGICH2_coil_current_reading() As Single

        AGICH2_coil_current_reading = 0

        Dim MessageIn As String
        MessageIn = ""
        Dim xx As Integer
        xx = 0

        Dim GpibDevice = New Device(0, CInt(GPIBSource))

        GpibDevice.DefaultBufferSize = 64000
        '

        'Code for B2902
        GpibDevice.Write(":INIT (@2)")
        System.Threading.Thread.Sleep(2000)
        GpibDevice.Write(":FETC:CURR? (@2)")
        '
        Do
            status = GpibDevice.SerialPoll
            Application.DoEvents()

        Loop Until (status And 16) = 16
        MessageIn = MessageIn & GpibDevice.ReadString()

        AGICH2_coil_current_reading = Val(MessageIn)

    End Function

    Public Sub AbortAGI_CH1()

        DUT_AGICH1CURR(0)
        Dim GpibDevice = New Device(0, CInt(GPIBSource))
        GpibDevice.Write(":OUTP1 OFF")

        System.Threading.Thread.Sleep(100)
        GpibDevice.Dispose()

    End Sub

    Public Sub AbortKEI_SM()
        Dim GpibDevice = New Device(0, CInt(GPIBKeith))
        GpibDevice.Write(":OUTP OFF")

        System.Threading.Thread.Sleep(100)
        GpibDevice.Dispose()

    End Sub

    Public Sub AbortAGI_CH2()

        Dim GpibDevice = New Device(0, CInt(GPIBSource))
        GpibDevice.Write(":OUTP2 OFF")

    End Sub

    Public Sub AbortKEI_4200()
        Dim GpibDevice = New Device(0, CInt(GPIBVoltmeter))

        GpibDevice.Write("DI1")

        System.Threading.Thread.Sleep(100)
        GpibDevice.Dispose()
    End Sub

    Public Sub AbortKEI_4200AM()
        Dim GpibDevice = New Device(0, CInt(GPIBVoltmeter))

        GpibDevice.Write("DV1;DV2")

        System.Threading.Thread.Sleep(100)
        GpibDevice.Dispose()
    End Sub


    Public Sub ONAGI_CH2()

        Dim GpibDevice = New Device(0, CInt(GPIBSource))
        GpibDevice.Write(":OUTP2 ON")

    End Sub

    Public Sub ONKEI_SM()
        Dim GpibDevice = New Device(0, CInt(GPIBKeith))
        GpibDevice.Write(":OUTP ON")
        GpibDevice.Write(":SOUR:CURR:RANG:AUTO 1")

        System.Threading.Thread.Sleep(100)
        GpibDevice.Dispose()

    End Sub


    Function DUT_ReadCurrent_AGICH1() As Single     '''''''600 times of measurement
        Dim MessageIn As String, X As Integer, Statuss As Integer
        DUT_ReadCurrent_AGICH1 = 0
        MessageIn = ""
        Dim GPIBSource As Integer
        GPIBSource = 16


        TransientBCurrent = New Single(600) {}


        Dim GpibDevice = New Device(0, CInt(GPIBSource))
        GpibDevice.DefaultBufferSize = 64000
        GpibDevice.Write(":INIT")
        '
        System.Threading.Thread.Sleep(1000)
        GpibDevice.Write(":FETC:ARR:CURR?")

        Do
            Statuss = GpibDevice.SerialPoll
            Application.DoEvents()

        Loop Until (Statuss And 16) = 16
        MessageIn = MessageIn & GpibDevice.ReadString()
        For X = 0 To 599
            TransientBCurrent(X) = Val(MessageIn)
            DUT_ReadCurrent_AGICH1 = DUT_ReadCurrent_AGICH1 + Val(MessageIn)
            MessageIn = Right(MessageIn, Len(MessageIn) - InStr(1, MessageIn, ","))
        Next
        DUT_ReadCurrent_AGICH1 = DUT_ReadCurrent_AGICH1 / 600

        X = 0

        'TransientBCurrent(X) = RunCurrent(X)


    End Function


    Function B1_Reading() As Single
        B1_Reading = 0
        Dim GPIBGaussmeter As Integer
        GPIBGaussmeter = 10
        Dim GpibDevice = New Device(0, CInt(GPIBGaussmeter))

        GpibDevice.Write("RDGFIELD?")
        B1_Reading = Val(GpibDevice.ReadString()) * 1000000

    End Function

    Function B2_Reading() As Single
        B2_Reading = 0
        Dim GPIBGaussmeter As Integer
        GPIBGaussmeter = 12
        Dim GpibDevice = New Device(0, CInt(GPIBGaussmeter))

        GpibDevice.Write("RDGFIELD?")
        B2_Reading = Val(GpibDevice.ReadString()) * 1000000

        System.Threading.Thread.Sleep(100)
        GpibDevice.Dispose()

    End Function

    Sub B1_trans()
        Dim B1FieldTrans(300) As Single
        Dim x As Integer
        x = 0
        B1FieldTrans = New Single(300) {}

        Do Until x = 300
            B1FieldTrans(x) = B1_Reading()
            System.Threading.Thread.Sleep(1000)
            x = x + 1
        Loop

        Filename = "B Trans.txt"
        Dim objWriter As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormat As String = "{0,-10}"

        objWriter.WriteLine("{0,-10}", "B-Field")
        For x = 0 To 299
            objWriter.WriteLine(LineFormat, B1FieldTrans(x))
        Next
        objWriter.Close()

    End Sub

    Sub B2_trans()
        Dim B2FieldTrans(5) As Single
        Dim x As Integer
        x = 0
        B2FieldTrans = New Single(5) {}

        Do Until x = 5
            B2FieldTrans(x) = B2_Reading()
            System.Threading.Thread.Sleep(1000)
            x = x + 1
        Loop

        Filename = "B Trans.txt"
        Dim objWriter As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormat As String = "{0,-10}"

        objWriter.WriteLine("{0,-10}", "B-Field")
        For x = 0 To 4
            objWriter.WriteLine(LineFormat, B2FieldTrans(x))
        Next
        objWriter.Close()

    End Sub

    Sub B_I()
        Dim BFieldAve(3) As Single

        Dim DriveCurrent(50) As Single
        Dim BFieldDrive(50) As Single
        Dim x, y As Integer
        Dim I As Single



        x = 0
        y = 0
        BFieldAve = New Single(3) {}
        DriveCurrent = New Single(50) {}
        BFieldDrive = New Single(50) {}
        I = 0.003






        Do Until x = 50
            y = 0
            Z_AGICH2(I)

            System.Threading.Thread.Sleep(7000)

            Do Until y = 3
                BFieldAve(y) = B2_Reading()
                System.Threading.Thread.Sleep(2000)
                y = y + 1
            Loop

            y = 0

            Do Until y = 3
                BFieldDrive(x) = BFieldDrive(x) + BFieldAve(y)
                y = y + 1
            Loop

            BFieldDrive(x) = BFieldDrive(x) / 3

            DriveCurrent(x) = Z_ReadCurrent_AGICH2()

            x = x + 1
            I = I - 0.001
        Loop

        Filename = "BI RAW.txt"
        Dim objWriter As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormat As String = "{0,-10}{1,-16:E}"

        objWriter.WriteLine("{0,-10}{1,-16}", "Drive current", "B field")
        For x = 0 To 49
            objWriter.WriteLine(LineFormat, DriveCurrent(x), BFieldDrive(x))
        Next
        objWriter.Close()

    End Sub


    Sub Key2612ON()
        Dim GpibDevice = New Device(0, CInt(GPIBKey2612))
        GpibDevice.Write("smua.source.func = smua.OUTPUT_DCAMPS")
        System.Threading.Thread.Sleep(1000)
        GpibDevice.Write("smua.source.limitv = 5")
        System.Threading.Thread.Sleep(1000)
        GpibDevice.Write("smua.source.output = smua.OUTPUT_ON")
        GpibDevice.Dispose()
    End Sub

    Sub Key2612OFF()
        Dim GpibDevice = New Device(0, CInt(GPIBKey2612))
        GpibDevice.Write("smua.source.output = smua.OUTPUT_OFF")
        GpibDevice.Dispose()
    End Sub

    Sub KEY2612Curr(ByVal Current As Single)
        Dim GpibDevice = New Device(0, CInt(GPIBKey2612))
        GpibDevice.Write("smua.source.leveli = " & Trim(Current))
        GpibDevice.Dispose()

    End Sub


    Sub Bsmllcoil_I()
        Dim DriveI(10) As Single
        Dim Bfield(10) As Single
        Dim Num As Integer

        DriveI = New Single(10) {-0.05, -0.1, -0.15, -0.2, -0.25, -0.3, -0.35, -0.4, -0.45, -0.5, -0.55}
        Bfield = New Single(10) {}
        Num = 0


        Key2612ON()

        System.Threading.Thread.Sleep(1000)

        Do Until Num = 10
            KEY2612Curr(DriveI(Num))
            System.Threading.Thread.Sleep(3000)
            Bfield(Num) = B2_Reading()
            Num = Num + 1
        Loop

        System.Threading.Thread.Sleep(1000)

        'AbortAGI_CH2()
        Key2612OFF()

        Filename = "BI.txt"
        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}"
        objWriterTrans.WriteLine("{0,-10}{1,-16}", "Bfield", "Drive Current")
        For x = 0 To Num - 1
            objWriterTrans.WriteLine(LineFormatTrans, Bfield(x), DriveI(x))
        Next
        objWriterTrans.Close()

    End Sub

    Sub B_t()
        Dim BTrans(200) As Single
        Dim x As Integer

        x = 0
        BTrans = New Single(200) {}

        Do Until x = 200
            BTrans(x) = B2_Reading()
            System.Threading.Thread.Sleep(50)
            x = x + 1
        Loop

        Filename = "B-t.txt"
        Dim objWriter As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormat As String = "{0,-10}"

        objWriter.WriteLine("{0,-10}", "B field")
        For x = 0 To 199
            objWriter.WriteLine(LineFormat, BTrans(x))
        Next
        objWriter.Close()

    End Sub

    Sub B_t2()
        BTrans = New Single(250) {}

        'Dim DriveCurr As Single
        'Dim y As Integer
        'y = 0
        AGICH2Curr = 0.01893
        'DriveCurr = 0.01893


        'Z_AGICH2(DriveCurr)
        AGICH2Timer()
        BReadingTimerTrans()
        'System.Threading.Thread.Sleep(1000)

        Do Until XXX = 250

        Loop

        dTimer.Stop()
        dTimer.Dispose()

        eTimer.Stop()
        eTimer.Dispose()

        Filename = "B-t.txt"
        Dim objWriter As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormat As String = "{0,-10}"

        objWriter.WriteLine("{0,-10}", "B field")
        For y = 0 To 249
            objWriter.WriteLine(LineFormat, BTrans(y))
        Next
        objWriter.Close()
        Z_AGICH2(0.01893)


    End Sub


    Sub K_Obtainment()       ''''''assumption: the B field is linear with the magnet current and is not changeable.
        Dim Beny As Single, i As Integer, temp As Single, Ix As Single, Iy As Single, tempx As Single, tempy As Single
        Beny = 0
        i = 0
        temp = 0
        Ix = 0
        Iy = 0
        tempx = 5
        tempy = 5
        Kx = 0
        Ky = 0

        X_SIGCH2(0)
        Y_SIGCH1(0)
        ' --------------------------------------------------------Kx obtainment-------------------------------------------------------------
        Do Until i = 3
            Beny = Beny + B1_Reading()
            i = i + 1
        Loop

        Beny = Beny / 3

        X_SIGCH2(0.002)

        temp = B1_Reading()

        If temp < Beny Then
            Do Until tempx < 0.1     '''''''''''''''not sure if this 0.1uT is fine?? need to be checked later
                X_SIGCH2(Ix)
                tempx = B1_Reading()         ''''''''caution: the sequence between tempx and Ix might be a problem!
                Ix = Ix + 0.001
            Loop
        Else
            Do Until tempx < 0.1
                X_SIGCH2(Ix)
                tempx = B1_Reading()
                Ix = Ix - 0.001      '''''''''''''''not sure if the siglent smu can be addressed as negative current? need to be checked later
            Loop
        End If

        Kx = Beny / (Math.Sqrt(2) * Ix)
        X_SIGCH2(0)
        ' -----------------------------------------------------------------Ky obtainment--------------------------------------------------------------------------
        i = 0
        Beny = 0
        temp = 0

        Do Until i = 3
            Beny = Beny + B1_Reading()
            i = i + 1
        Loop

        Beny = Beny / 3

        Y_SIGCH1(0.002)

        temp = B1_Reading()

        If temp < Beny Then
            Do Until tempy < 0.1     '''''''''''''''not sure if this 0.1uT is fine?? need to be checked later
                Y_SIGCH1(Iy)
                tempy = B1_Reading()
                Iy = Iy + 0.001
            Loop
        Else
            Do Until tempy < 0.1
                Y_SIGCH1(Iy)
                tempy = B1_Reading()
                Iy = Iy - 0.001      '''''''''''''''not sure if the siglent smu can be addressed as negative current? need to be checked later
            Loop
        End If

        Ky = Beny / (Math.Sqrt(2) * Iy)
        Y_SIGCH1(0)

    End Sub

    Sub Benvx_Obtainment()
        Benvx = 0
        Dim i As Integer
        i = 0
        Do Until i = 3
            Benvx = Benvx + B1_Reading()
            i = i + 1
        Loop

        Benvx = Benvx / 3

    End Sub

    Sub Benvy_Obtainment()
        Benvy = 0
        Dim i As Integer
        i = 0
        Do Until i = 3
            Benvy = Benvy + B1_Reading()
            i = i + 1
        Loop

        Benvy = Benvy / 3

    End Sub

    Sub ZeroCoilX_Y()
        Dim alpha As Single, theta As Single, Benv As Single, Bx As Single, By As Single
        Dim Ix As Single, Iy As Single
        alpha = Math.Atan(Benvy / Benvx)
        theta = Math.Abs((Math.PI / 4) - alpha)

        Benv = Math.Sqrt((Benvx) ^ 2 + (Benvy) ^ 2)
        Bx = Benv * Math.Sin(theta)
        By = Benv * Math.Cos(theta)

        Ix = Bx / Kx
        Iy = By / Ky

        X_SIGCH2(Ix)
        Y_SIGCH1(Iy)



    End Sub

    Public Function TTimeSpan(ByVal T1 As DateTime, ByVal T0 As DateTime) As Single ''get the past time
        TTimeSpan = 0.0
        Dim Span As TimeSpan = T1 - T0
        TTimeSpan = Val(Span.TotalMilliseconds)
    End Function


    Sub SetBz(ByVal Bsetpoint As Single)
        'Dim kp, ki, kd As Single

        Dim err, err_pre As Single
        Dim P, I, D As Single
        Dim Current_B As Single
        Dim Mean_B(5) As Single
        Dim m, n, k As Integer
        Dim AveB As Single
        Dim B_Diff As Single
        Dim DelayTime As Single
        Dim Bmeannow(3) As Single


        Dim Bstdv As Single

        Dim DevCurrNum As Integer
        Dim BStable As Boolean
        Dim SingLoopNum As Integer
        Dim TransientCurrent(802) As Single
        Dim Tr As Integer
        Dim IntBTrans(802) As Single
        Dim CurrTim As DateTime



        Dim SMU_ON As Boolean


        Dim kp, ki, kd As Single


        Dim InitTime As DateTime

        Dim MagTime As DateTime

        Dim T As Single



        Dim RealTime() As Single ''''''''''''''''
        Dim Mag() As Single '''''''''''''''''''''
        Dim MagCur() As Single '''''''''''''''''''''''''
        Dim MagCurCal() As Single ''''''''''''''''''''''''''
        Dim Errr() As Single '''''''''''''''''''''''''''
        ' Dim ErrrAve(50) As Single
        Dim TTT() As Single
        Dim InittTime As DateTime '''''''''''''
        Dim CurrentTemp As DateTime '''''''''''''''
        Dim X As Integer '''''''''''''
        Dim Nn As Integer ''''''''''''''''''


        Dim Errorsum As Single

        Dim Imag0 As Single
        Dim Imagnow As Single
        Dim meannum, yesloop As Integer
        Dim Bmean As Single
        Dim BmeanVal() As Single
        'Dim BField(Points) As Single
        'Dim initTime As DateTime
        'Dim nowTime As DateTime
        'Dim Interval(20) As Single
        Dim Diff As Single
        Dim Difff() As Single
        Dim Imag() As Single

        Imag0 = 0
        Imagnow = 0
        X = 0
        Bmean = 0
        Bmeannow = New Single(3) {}
        meannum = 0
        yesloop = 0
        Nn = 0
        'BField = New Single(5) {}
        'Interval = New Single(5) {}
        Diff = 0
        'BmeanVal = New Single(NumBValues) {}
        'Difff = New Single(5) {}
        'Imag = New Single(5) {}
        'Bstdvnow = New Single(NumBValues) {}
        SMU_ON = False
        DevCurrNum = 0
        BStable = False
        SingLoopNum = 0


        T = 0


        P = 0
        I = 0
        D = 0
        m = 0
        n = 0
        k = 0

        kp = 1   ''''''''''''''''''P term
        ki = 0   ''''''''''''''''''I term
        kd = 23  ''''''''''''''''''D term

        Bstdv = 0

        Errorsum = 0

        err = 0
        err_pre = 0
        Current_B = 0

        Mean_B = New Single(5) {}
        AveB = 0
        B_Diff = 5
        X = 0 '''''''''''''''
        n = 0 ''''''''''''''''
        Errorsum += err * T




        InitTime = DateTime.Now()
        Current_B = B2_Reading() 'B reading before error calculation


        'err = BSetPoint - Current_B 'Error calculation
        err = Bsetpoint - Current_B

        'P, I and D calculation
        P = kp * err
        I = ki * Errorsum


        'delaytime = P + I + D 'PID-calculated magnet current

        DelayTime = P + I + D

        'check if the magnet current is out of the limit of PSU
        'and then send it to PSU

        System.Threading.Thread.Sleep(Math.Abs(DelayTime) * 100)

        meannum = 0
        Bmean = 0 ''''''''''''''''extremely important!!!!!!!!!!
        Bmeannow = New Single(3) {}

        Do Until meannum = 3
            Bmeannow(meannum) = B2_Reading()
            Bmean = Bmean + Bmeannow(meannum)
            System.Threading.Thread.Sleep(100)
            meannum = meannum + 1
        Loop

        Bmean = Bmean / 3 ''reading B consecutively 3 times and get the mean value of that

        meannum = 0
        Bstdv = 0

        Do Until meannum = 3
            Bstdv = Bstdv + (Bmeannow(meannum) - Bmean) ^ 2
            meannum = meannum + 1
        Loop

        Bstdv = Math.Sqrt(Bstdv / 3)

        'Diff = Math.Abs(BSetPoint - Bmean)
        Diff = Math.Abs(Bsetpoint - Bmean)

        If (Diff > 0.5) Then
            'If Bmean > BSetPoint Then
            If (Diff > 20 Or Diff = 20) Then
                If Bmean > Bsetpoint Then
                    Imagnow = Z_ReadCurrent_AGICH2()
                    Imagnow = Imagnow - 0.1
                    Z_AGICH2(Imagnow)
                Else
                    Imagnow = Z_ReadCurrent_AGICH2()
                    Imagnow = Imagnow + 0.1
                    Z_AGICH2(Imagnow)
                End If
            End If
            If (Diff > 10 And Diff < 20) Then
                If Bmean > Bsetpoint Then
                    Imagnow = Z_ReadCurrent_AGICH2()
                    Imagnow = Imagnow - 0.01
                    Z_AGICH2(Imagnow)
                Else
                    Imagnow = Z_ReadCurrent_AGICH2()
                    Imagnow = Imagnow + 0.01
                    Z_AGICH2(Imagnow)
                End If
            End If
            If (Diff < 10 Or Diff = 10) Then
                If Bmean > Bsetpoint Then
                    Imagnow = Z_ReadCurrent_AGICH2()
                    Imagnow = Imagnow - 0.001
                    Z_AGICH2(Imagnow)
                Else
                    Imagnow = Z_ReadCurrent_AGICH2()
                    Imagnow = Imagnow + 0.001
                    Z_AGICH2(Imagnow)
                End If
            End If

        End If


        MagTime = DateTime.Now()

        T = (TTimeSpan(MagTime, InitTime) / 1000)


        err_pre = err



        'InittTime = DateTime.Now()
        BStable = False
        Do Until BStable = True

            '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

            InitTime = DateTime.Now()
            Current_B = B2_Reading()

            'CurrentTemp = DateTime.Now() '''''''''''''''''''''''''''''
            'RealTime(X) = TTimeSpan(CurrentTemp, InittTime)

            'err = BSetPoint - Current_B 'Error calculationK
            ' Errr(X) = err
            err = Bsetpoint - Current_B

            'P, I and D calculation
            P = kp * err
            I = ki * Errorsum
            D = kd * ((err - err_pre) / T)

            DelayTime = P + I + D 'PID-calculated magnet current
            'Delay(X) = DelayTime
            'PP(X) = -P + 63.73
            'DD(X) = D - 20

            System.Threading.Thread.Sleep(Math.Abs(DelayTime) * 100)

            '' PID to get the ideal delay time
            '' after the magnet current set, there should be a pause to wait till it gets steady

            'BField(X) = Current_B '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''!!!!


            meannum = 0
            Bmean = 0 ''''''''''''''''extremely important!!!!!!!!!!
            Bmeannow = New Single(3) {}

            Do Until meannum = 3
                Bmeannow(meannum) = B2_Reading()
                Bmean = Bmean + Bmeannow(meannum)
                System.Threading.Thread.Sleep(100)
                'System.Threading.Thread.Sleep(500)
                meannum = meannum + 1
            Loop

            Bmean = Bmean / 3 ''reading B consecutively 3 times and get the mean value of that

            meannum = 0
            Bstdv = 0

            Do Until meannum = 3
                Bstdv = Bstdv + (Bmeannow(meannum) - Bmean) ^ 2
                meannum = meannum + 1
            Loop

            Bstdv = Math.Sqrt(Bstdv / 3)  ''standard deviation calculated


            'Diff = Math.Abs(BSetPoint - Bmean)
            Diff = Math.Abs(Bsetpoint - Bmean)
            ' Difff(X) = Diff

            If (Diff > 0.5) Then
                'If Bmean > BSetPoint Then
                If (Diff > 20 Or Diff = 20) Then
                    If Bmean > Bsetpoint Then
                        Imagnow = Z_ReadCurrent_AGICH2()
                        Imagnow = Imagnow - 0.1
                        Z_AGICH2(Imagnow)
                    Else
                        Imagnow = Z_ReadCurrent_AGICH2()
                        Imagnow = Imagnow + 0.1
                        Z_AGICH2(Imagnow)
                    End If
                End If
                If (Diff > 10 And Diff < 20) Then
                    If Bmean > Bsetpoint Then
                        Imagnow = Z_ReadCurrent_AGICH2()
                        Imagnow = Imagnow - 0.01
                        Z_AGICH2(Imagnow)
                    Else
                        Imagnow = Z_ReadCurrent_AGICH2()
                        Imagnow = Imagnow + 0.01
                        Z_AGICH2(Imagnow)
                    End If
                End If
                If (Diff < 10 And Diff > 5) Then
                    If Bmean > Bsetpoint Then
                        Imagnow = Z_ReadCurrent_AGICH2()
                        Imagnow = Imagnow - 0.001
                        Z_AGICH2(Imagnow)
                    Else
                        Imagnow = Z_ReadCurrent_AGICH2()
                        Imagnow = Imagnow + 0.001
                        Z_AGICH2(Imagnow)
                    End If
                End If

                If (Diff < 5 Or Diff = 5) Then
                    If Bmean > Bsetpoint Then
                        Imagnow = Z_ReadCurrent_AGICH2()
                        Imagnow = Imagnow - 0.0001
                        Z_AGICH2(Imagnow)
                    Else
                        Imagnow = Z_ReadCurrent_AGICH2()
                        Imagnow = Imagnow + 0.0001
                        Z_AGICH2(Imagnow)
                    End If
                End If
            Else
                BStable = True


            End If

            ' Imag(X) = Imagnow
            MagTime = DateTime.Now()

            T = (TTimeSpan(MagTime, InitTime) / 1000)
            ' TTT(X) = T
            err_pre = err
            X += 1
        Loop


        ''System.Threading.Thread.Sleep(1000)
        'MagCurrentSetting(-0.2411)
        'System.Threading.Thread.Sleep(1000)

    End Sub

    Public Sub NewUltraMR()


        DeviceVoltage = New Single(1500) {}
        DeviceVoltage = New Single(1500) {}

        KeiIniVM()

        DUT_AGICH1CURR(0.000002)
        Z_AGICH2(-0.024742)

        ReadTimer()
        IDriveTimer()

        Do Until XXX = 1500


        Loop

        AbortAGI_CH1()

        bTimer.Stop()
        bTimer.Dispose()

        aTimer.Stop()
        aTimer.Dispose()

        Filename = "MRscan.txt"
        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}"
        objWriterTrans.WriteLine("{0,-10}{1,-16}", "BField", "Voltage")
        For x = 0 To 1499
            objWriterTrans.WriteLine(LineFormatTrans, DeviceBField(x), DeviceVoltage(x))
        Next
        objWriterTrans.Close()

    End Sub

    Public Sub NewUltraMR3()
        XXX = 0


        DeviceVoltage = New Single(1000) {}
        DeviceBField = New Single(1000) {}
        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer
        Dim Blocal As Single
        Blocal = 34.3

        x = 0

        IDriveRate = 0.0549
        AGICH2Curr = -1.088  '''''''Initialize the drive current to be -2000uT

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter

        Z_AGICH2(AGICH2Curr) '''''''''Initialize the B field to -2000uT first

        System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at -2000uT

        DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

        System.Threading.Thread.Sleep(200000)  '''''wait till the device enters single exponential decay region

        ReadTimer()     ''''''''start the B value and device current value reading timer : period: 2s


        AGICH2Timer()   '''''''start ramping the B field using controllable drive current rate: period: 1s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -1000) ''''''''' the condition to check if -2000uT - -1000uT is finished?
        Loop

        IDriveRate = 0.014    '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -100) '''''''''the condition to check if -1000uT - -100uT is finished?
        Loop

        IDriveRate = 0.0028     '''''change the drive current rate to 0.0028A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -50) '''''''''the condition to check if -100uT - -50uT is finished?
        Loop

        IDriveRate = 0.0014     '''''change the drive current rate to 0.0014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 0) '''''''''the condition to check if -50uT - 0uT is finished?
        Loop

        IDriveRate = 0.0014     '''''change the drive current rate to 0.0014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 50) ''''''''' the condition to check if 0uT - 50uT is finished?
        Loop

        IDriveRate = 0.0028     '''''change the drive current rate to 0.0028A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 100) '''''''''the condition to check if 50uT - 100uT is finished?
        Loop

        IDriveRate = 0.014     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 1000) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = 0.0549     '''''change the drive current rate to 0.0549A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 2000) ''''''''' the condition to check if 1000uT - 2000uT is finished?
        Loop

        AbortAGI_CH1()

        bTimer.Stop()
        bTimer.Dispose()

        eTimer.Stop()
        eTimer.Dispose()

        Filename = "MRscan.txt"
        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}"
        objWriterTrans.WriteLine("{0,-10}{1,-16}", "Post-Bfield", "Voltage")
        For x = 0 To XXX
            objWriterTrans.WriteLine(LineFormatTrans, DeviceBField(x), DeviceVoltage(x))
        Next
        objWriterTrans.Close()

        Z_AGICH2(-1.088)

    End Sub

    Public Sub NewUltraMR4()
        XXX = 0


        DeviceVoltage = New Single(1000) {}
        DeviceBField = New Single(1000) {}
        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer
        Dim Blocal As Single
        Blocal = 32.2

        x = 0

        IDriveRate = 0.0549
        AGICH2Curr = 0.017839  '''''''Initialize the drive current to be 0uT

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter

        Z_AGICH2(AGICH2Curr) '''''''''Initialize the B field to 0uT first

        System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias



        ReadTimer()     ''''''''start the B value and device current value reading timer : period: 1.2s


        '''''''start ramping the B field using controllable drive current rate: period: 1s



        Do Until XXX = 250 ''''''''' the condition to check if 1000uT - 2000uT is finished?
        Loop

        AbortAGI_CH1()

        bTimer.Stop()
        bTimer.Dispose()



        Filename = "MRscan.txt"
        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}"
        objWriterTrans.WriteLine("{0,-10}{1,-16}", "Post-Bfield", "Voltage")
        For x = 0 To XXX - 1
            objWriterTrans.WriteLine(LineFormatTrans, DeviceBField(x), DeviceVoltage(x))
        Next
        objWriterTrans.Close()

        Z_AGICH2(0.017839)

    End Sub

    Public Sub NewUltraMR5()
        XXX = 0


        DeviceVoltage = New Single(1000) {}
        DeviceBField = New Single(1000) {}
        DeviceEl = New Single(1000) {}


        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer
        Dim Blocal As Single
        Blocal = 32.2

        x = 0

        IDriveRate = 0.0549
        AGICH2Curr = -1.089    '''''''Initialize the drive current to be -2000uT

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter

        '''''''''Initialize the B field to -2000uT first

        Z_AGICH2(0.017839)

        System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at -2000uT

        DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

        System.Threading.Thread.Sleep(200000)  '''''wait till the device enters single exponential decay region

        Z_AGICH2(AGICH2Curr)

        System.Threading.Thread.Sleep(2000)

        ReadTimer()     ''''''''start the B value and device current value reading timer : period: 1.2s


        AGICH2Timer()   '''''''start ramping the B field using controllable drive current rate: period: 1s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -1000) ''''''''' the condition to check if -2000uT - -1000uT is finished?
        Loop

        IDriveRate = 0.014    '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -100) '''''''''the condition to check if -1000uT - -100uT is finished?
        Loop

        IDriveRate = 0.0028     '''''change the drive current rate to 0.0028A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -50) '''''''''the condition to check if -100uT - -50uT is finished?
        Loop

        IDriveRate = 0.0014     '''''change the drive current rate to 0.0014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 0) '''''''''the condition to check if -50uT - 0uT is finished?
        Loop

        IDriveRate = 0.0014     '''''change the drive current rate to 0.0014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 50) ''''''''' the condition to check if 0uT - 50uT is finished?
        Loop

        IDriveRate = 0.0028     '''''change the drive current rate to 0.0028A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 100) '''''''''the condition to check if 50uT - 100uT is finished?
        Loop

        IDriveRate = 0.014     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 1000) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = 0.0549     '''''change the drive current rate to 0.0549A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 2005) ''''''''' the condition to check if 1000uT - 2000uT is finished?
        Loop

        '''''''''''''''''''''''''''''''''''''''Forward part finished'''''''''''''''''''''''''''''''''''''''''''''''''''''


        IDriveRate = -0.0549     '''''change the drive current rate to 0.0549A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < 1000) ''''''''' the condition to check if 1000uT - 2000uT is finished?
        Loop

        IDriveRate = -0.014     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < 100) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.0028     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < 50) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.0014     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < 0) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.0014     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < -50) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.0028     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < -100) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.014     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < -1000) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.0549    '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < -2000) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop



        AbortAGI_CH1()

        bTimer.Stop()
        bTimer.Dispose()

        eTimer.Stop()
        eTimer.Dispose()

        Filename = "MRscan.txt"
        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}"
        objWriterTrans.WriteLine("{0,-10}{1,-16}", "Post-Bfield", "Voltage")
        For x = 0 To XXX - 1
            objWriterTrans.WriteLine(LineFormatTrans, DeviceBField(x), DeviceVoltage(x))
        Next
        objWriterTrans.Close()

        Z_AGICH2(-1.089)

    End Sub


    Public Sub NewUltraMR6()
        XXX = 0


        DeviceVoltage = New Single(20000) {}
        DeviceBField = New Single(20000) {}
        DeviceEl = New Single(20000) {}


        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer
        Dim Blocal As Single
        Dim count As Integer

        Blocal = 32.14                 ''''''''Check B local everytime!

        x = 0

        IDriveRate = 0                    ''''''''Initialize the drive current rate
        AGICH2Curr = (-3000 + Blocal) / 1806.67    '''''''Initialize the drive current to be -3000uT

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

        System.Threading.Thread.Sleep(200000)  '''''wait till the device enters single exponential decay region

        Z_AGICH2(AGICH2Curr)

        System.Threading.Thread.Sleep(2000)

        ReadTimer()     ''''''''start the B value and device current value reading timer : period: 1.2s


        AGICH2Timer()   '''''''start ramping the B field using controllable drive current rate: period: 1s

        Do Until XXX = 15    '''''''''Do a series of voltage measurements under -3000uT for later exponential fitting

        Loop

        IDriveRate = 0.0824



        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -2000) ''''''''' the condition to check if -2000uT - -1000uT is finished?
        Loop

        IDriveRate = 0.0549

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -1000) ''''''''' the condition to check if -2000uT - -1000uT is finished?
        Loop

        IDriveRate = 0.014    '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -500) '''''''''the condition to check if -1000uT - -100uT is finished?
        Loop

        IDriveRate = 0.00412     '''''change the drive current rate to 0.0028A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -95) '''''''''the condition to check if -100uT - -50uT is finished?
        Loop

        IDriveRate = 0.0014     '''''change the drive current rate to 0.0014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 0) '''''''''the condition to check if -50uT - 0uT is finished?
        Loop

        IDriveRate = 0.0014     '''''change the drive current rate to 0.0014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 95) ''''''''' the condition to check if 0uT - 50uT is finished?
        Loop

        IDriveRate = 0.00412     '''''change the drive current rate to 0.0028A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 500) '''''''''the condition to check if 50uT - 100uT is finished?
        Loop

        IDriveRate = 0.014     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 1000) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = 0.0549     '''''change the drive current rate to 0.0549A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 2000) ''''''''' the condition to check if 1000uT - 2000uT is finished?
        Loop

        IDriveRate = 0.0824     '''''change the drive current rate to 0.0549A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 3000) ''''''''' the condition to check if 1000uT - 2000uT is finished?
        Loop


        '''''''''''''''''''''''''''''''''''''''Forward part finished'''''''''''''''''''''''''''''''''''''''''''''''''''''

        IDriveRate = 0
        count = 0

        Do Until count = 15
            System.Threading.Thread.Sleep(1000)      '''''''''Do a series of voltage measurements under -3000uT for later exponential fitting
            count = count + 1
        Loop

        ''''''''''''''''''''''''''''''''''''''Reverse part starts''''''''''''''''''''''''''''''''''''''''''''''''''''''''''



        IDriveRate = -0.0824     '''''change the drive current rate to 0.0549A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < 2000) ''''''''' the condition to check if 1000uT - 2000uT is finished?
        Loop

        IDriveRate = -0.0549     '''''change the drive current rate to 0.0549A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < 1000) ''''''''' the condition to check if 1000uT - 2000uT is finished?
        Loop

        IDriveRate = -0.014     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < 500) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.00412     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < 95) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.0014     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < 0) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.0014     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < -95) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.00412     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < -500) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.014     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < -1000) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.0549    '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < -2000) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.0824    '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < -3000) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = 0
        count = 0

        Do Until count = 15
            System.Threading.Thread.Sleep(1000)      '''''''''Do a series of voltage measurements under -3000uT for later exponential fitting
            count = count + 1
        Loop



        AbortAGI_CH1()

        bTimer.Stop()
        bTimer.Dispose()

        eTimer.Stop()
        eTimer.Dispose()

        Filename = "MRscan.txt"
        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}"
        objWriterTrans.WriteLine("{0,-10}{1,-16}", "Post-Bfield", "Voltage")
        For x = 0 To XXX - 1
            objWriterTrans.WriteLine(LineFormatTrans, DeviceBField(x), DeviceVoltage(x))
        Next
        objWriterTrans.Close()

        Z_AGICH2(((0 + Blocal) / 1806.67))

    End Sub


    Public Sub NewUltraMR7()
        XXX = 0


        DeviceVoltage = New Single(20000) {}
        DeviceBField = New Single(20000) {}
        DeviceEl = New Single(20000) {}


        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer
        Dim Blocal As Single
        Dim count As Integer

        Blocal = 32.14                 ''''''''Check B local everytime!

        x = 0

        IDriveRate = 0                    ''''''''Initialize the drive current rate
        AGICH2Curr = (-400 + Blocal) / 1806.67    '''''''Initialize the drive current to be -400uT

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

        System.Threading.Thread.Sleep(200000)  '''''wait till the device enters single exponential decay region

        Z_AGICH2(AGICH2Curr)

        System.Threading.Thread.Sleep(2000)

        ReadTimer()     ''''''''start the B value and device current value reading timer : period: 1.2s


        AGICH2Timer()   '''''''start ramping the B field using controllable drive current rate: period: 1s

        Do Until XXX = 15    '''''''''Do a series of voltage measurements under -3000uT for later exponential fitting

        Loop

        IDriveRate = 0.0014



        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 400) ''''''''' the condition to check if 400uT is finished?
        Loop



        '''''''''''''''''''''''''''''''''''''''Forward part finished'''''''''''''''''''''''''''''''''''''''''''''''''''''

        IDriveRate = 0
        count = 0

        Do Until count = 15
            System.Threading.Thread.Sleep(1000)      '''''''''Do a series of voltage measurements under -3000uT for later exponential fitting
            count = count + 1
        Loop

        ''''''''''''''''''''''''''''''''''''''Reverse part starts''''''''''''''''''''''''''''''''''''''''''''''''''''''''''



        IDriveRate = -0.0014     '''''change the drive current rate to 0.0549A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < -400) ''''''''' the condition to check if 1000uT - 2000uT is finished?
        Loop

        IDriveRate = 0
        count = 0

        Do Until count = 15
            System.Threading.Thread.Sleep(1000)      '''''''''Do a series of voltage measurements under -3000uT for later exponential fitting
            count = count + 1
        Loop



        AbortAGI_CH1()

        bTimer.Stop()
        bTimer.Dispose()

        eTimer.Stop()
        eTimer.Dispose()

        Filename = "MRscan.txt"
        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}"
        objWriterTrans.WriteLine("{0,-10}{1,-16}", "Post-Bfield", "Voltage")
        For x = 0 To XXX - 1
            objWriterTrans.WriteLine(LineFormatTrans, DeviceBField(x), DeviceVoltage(x))
        Next
        objWriterTrans.Close()

        Z_AGICH2(((0 + Blocal) / 1806.67))

    End Sub


    Public Sub NewUltraMR8()
        XXX = 0


        DeviceVoltage = New Single(20000) {}
        DeviceBField = New Single(20000) {}
        DeviceEl = New Single(20000) {}


        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer
        Dim Blocal As Single
        Dim count As Integer

        Blocal = 32.14               ''''''''Check B local everytime!

        x = 0

        IDriveRate = 0                    ''''''''Initialize the drive current rate
        AGICH2Curr = (-400 + Blocal) / 1806.67    '''''''Initialize the drive current to be -400uT

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

        System.Threading.Thread.Sleep(200000)  '''''wait till the device enters single exponential decay region

        Z_AGICH2(AGICH2Curr)

        System.Threading.Thread.Sleep(2000)

        ReadTimer()     ''''''''start the B value and device current value reading timer : period: 1.2s


        AGICH2Timer()   '''''''start ramping the B field using controllable drive current rate: period: 1s

        Do Until XXX = 15    '''''''''Do a series of voltage measurements under -3000uT for later exponential fitting

        Loop

        IDriveRate = 0.0014



        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 400) ''''''''' the condition to check if 400uT is finished?
        Loop



        '''''''''''''''''''''''''''''''''''''''Forward part finished'''''''''''''''''''''''''''''''''''''''''''''''''''''

        IDriveRate = 0
        count = 0

        Do Until count = 15
            System.Threading.Thread.Sleep(1000)      '''''''''Do a series of voltage measurements under -3000uT for later exponential fitting
            count = count + 1
        Loop

        ''''''''''''''''''''''''''''''''''''''Reverse part starts''''''''''''''''''''''''''''''''''''''''''''''''''''''''''






        AbortAGI_CH1()

        bTimer.Stop()
        bTimer.Dispose()

        eTimer.Stop()
        eTimer.Dispose()

        Filename = "MRscan.txt"
        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}"
        objWriterTrans.WriteLine("{0,-10}{1,-16}", "Post-Bfield", "Voltage")
        For x = 0 To XXX - 1
            objWriterTrans.WriteLine(LineFormatTrans, DeviceBField(x), DeviceVoltage(x))
        Next
        objWriterTrans.Close()

        Z_AGICH2(((0 + Blocal) / 1806.67))

    End Sub

    Public Sub NewUltraMR9()
        XXX = 0


        DeviceVoltage = New Single(20000) {}
        DeviceBField = New Single(20000) {}
        DeviceEl = New Single(20000) {}


        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer
        Dim Blocal As Single
        Dim count As Integer

        Blocal = 32.14                ''''''''Check B local everytime!

        x = 0

        IDriveRate = 0                    ''''''''Initialize the drive current rate
        AGICH2Curr = (-3000 + Blocal) / 1806.67    '''''''Initialize the drive current to be -3000uT

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

        System.Threading.Thread.Sleep(200000)  '''''wait till the device enters single exponential decay region

        Z_AGICH2(AGICH2Curr)

        System.Threading.Thread.Sleep(2000)

        ReadTimer()     ''''''''start the B value and device current value reading timer : period: 1.2s


        AGICH2Timer()   '''''''start ramping the B field using controllable drive current rate: period: 1s

        Do Until XXX = 15    '''''''''Do a series of voltage measurements under -3000uT for later exponential fitting

        Loop

        IDriveRate = 0.0824



        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -2000) ''''''''' the condition to check if -2000uT - -1000uT is finished?
        Loop

        IDriveRate = 0.0549

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -1000) ''''''''' the condition to check if -2000uT - -1000uT is finished?
        Loop

        IDriveRate = 0.014    '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -500) '''''''''the condition to check if -1000uT - -100uT is finished?
        Loop

        IDriveRate = 0.00412     '''''change the drive current rate to 0.0028A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -95) '''''''''the condition to check if -100uT - -50uT is finished?
        Loop

        IDriveRate = 0.0014     '''''change the drive current rate to 0.0014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 0) '''''''''the condition to check if -50uT - 0uT is finished?
        Loop

        IDriveRate = 0.0014     '''''change the drive current rate to 0.0014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 95) ''''''''' the condition to check if 0uT - 50uT is finished?
        Loop

        IDriveRate = 0.00412     '''''change the drive current rate to 0.0028A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 500) '''''''''the condition to check if 50uT - 100uT is finished?
        Loop

        IDriveRate = 0.014     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 1000) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = 0.0549     '''''change the drive current rate to 0.0549A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 2000) ''''''''' the condition to check if 1000uT - 2000uT is finished?
        Loop

        IDriveRate = 0.0824     '''''change the drive current rate to 0.0549A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 3000) ''''''''' the condition to check if 1000uT - 2000uT is finished?
        Loop


        '''''''''''''''''''''''''''''''''''''''Forward part finished'''''''''''''''''''''''''''''''''''''''''''''''''''''

        IDriveRate = 0
        count = 0

        Do Until count = 15
            System.Threading.Thread.Sleep(1000)      '''''''''Do a series of voltage measurements under -3000uT for later exponential fitting
            count = count + 1
        Loop

        ''''''''''''''''''''''''''''''''''''''Reverse part starts''''''''''''''''''''''''''''''''''''''''''''''''''''''''''




        AbortAGI_CH1()

        bTimer.Stop()
        bTimer.Dispose()

        eTimer.Stop()
        eTimer.Dispose()

        Filename = "MRscan.txt"
        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}"
        objWriterTrans.WriteLine("{0,-10}{1,-16}", "Post-Bfield", "Voltage")
        For x = 0 To XXX - 1
            objWriterTrans.WriteLine(LineFormatTrans, DeviceBField(x), DeviceVoltage(x))
        Next
        objWriterTrans.Close()

        Z_AGICH2(((0 + Blocal) / 1806.67))

    End Sub

    Public Sub NewUltraMR10()
        XXX = 0


        DeviceVoltage = New Single(20000) {}
        DeviceBField = New Single(20000) {}
        DeviceEl = New Single(20000) {}


        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer
        Dim Blocal As Single
        Dim count As Integer

        Blocal = 33.3                 ''''''''Check B local everytime!

        x = 0

        IDriveRate = 0                    ''''''''Initialize the drive current rate
        AGICH2Curr = (-3000 + Blocal) / 1806.67    '''''''Initialize the drive current to be -3000uT

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

        System.Threading.Thread.Sleep(600000)  '''''wait till the device enters single exponential decay region

        Z_AGICH2(AGICH2Curr)

        System.Threading.Thread.Sleep(2000)

        ReadTimer()     ''''''''start the B value and device current value reading timer : period: 1.2s


        AGICH2Timer()   '''''''start ramping the B field using controllable drive current rate: period: 1s

        Do Until XXX = 15    '''''''''Do a series of voltage measurements under -3000uT for later exponential fitting

        Loop

        IDriveRate = 0.0824



        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -2000) ''''''''' the condition to check if -2000uT - -1000uT is finished?
        Loop

        IDriveRate = 0.0549

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -1000) ''''''''' the condition to check if -2000uT - -1000uT is finished?
        Loop

        IDriveRate = 0.014    '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -500) '''''''''the condition to check if -1000uT - -100uT is finished?
        Loop

        IDriveRate = 0.00412     '''''change the drive current rate to 0.0028A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -95) '''''''''the condition to check if -100uT - -50uT is finished?
        Loop

        IDriveRate = 0.0014     '''''change the drive current rate to 0.0014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > -60) '''''''''the condition to check if -50uT - 0uT is finished?
        Loop

        IDriveRate = 0.000553    '''''change the drive current rate to 0.000553A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 0) '''''''''the condition to check if -50uT - 0uT is finished?
        Loop

        IDriveRate = 0.000553    '''''change the drive current rate to 0.000553A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 60) '''''''''the condition to check if -50uT - 0uT is finished?
        Loop


        IDriveRate = 0.0014     '''''change the drive current rate to 0.0014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 95) ''''''''' the condition to check if 0uT - 50uT is finished?
        Loop

        IDriveRate = 0.00412     '''''change the drive current rate to 0.0028A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 500) '''''''''the condition to check if 50uT - 100uT is finished?
        Loop

        IDriveRate = 0.014     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 1000) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = 0.0549     '''''change the drive current rate to 0.0549A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 2000) ''''''''' the condition to check if 1000uT - 2000uT is finished?
        Loop

        IDriveRate = 0.0824     '''''change the drive current rate to 0.0549A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) > 3000) ''''''''' the condition to check if 1000uT - 2000uT is finished?
        Loop


        '''''''''''''''''''''''''''''''''''''''Forward part finished'''''''''''''''''''''''''''''''''''''''''''''''''''''

        IDriveRate = 0
        count = 0

        Do Until count = 15
            System.Threading.Thread.Sleep(1000)      '''''''''Do a series of voltage measurements under -3000uT for later exponential fitting
            count = count + 1
        Loop

        ''''''''''''''''''''''''''''''''''''''Reverse part starts''''''''''''''''''''''''''''''''''''''''''''''''''''''''''



        IDriveRate = -0.0824     '''''change the drive current rate to 0.0549A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < 2000) ''''''''' the condition to check if 1000uT - 2000uT is finished?
        Loop

        IDriveRate = -0.0549     '''''change the drive current rate to 0.0549A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < 1000) ''''''''' the condition to check if 1000uT - 2000uT is finished?
        Loop

        IDriveRate = -0.014     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < 500) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.00412     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < 95) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.0014     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < 60) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.000553     '''''change the drive current rate to 0.000553A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < 0) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.000553    '''''change the drive current rate to 0.000553A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < -60) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.0014     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < -95) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.00412     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < -500) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.014     '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < -1000) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.0549    '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < -2000) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = -0.0824    '''''change the drive current rate to 0.014A/s

        Do Until ((AGICH2Curr * 1806.67 - Blocal) < -3000) ''''''''' the condition to check if 100uT - 1000uT is finished?
        Loop

        IDriveRate = 0
        count = 0

        Do Until count = 15
            System.Threading.Thread.Sleep(1000)      '''''''''Do a series of voltage measurements under -3000uT for later exponential fitting
            count = count + 1
        Loop



        AbortAGI_CH1()

        bTimer.Stop()
        bTimer.Dispose()

        eTimer.Stop()
        eTimer.Dispose()

        Filename = "MRscan.txt"
        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}"
        objWriterTrans.WriteLine("{0,-10}{1,-16}", "Post-Bfield", "Voltage")
        For x = 0 To XXX - 1
            objWriterTrans.WriteLine(LineFormatTrans, DeviceBField(x), DeviceVoltage(x))
        Next
        objWriterTrans.Close()

        Z_AGICH2(((0 + Blocal) / 1806.67))

    End Sub

    Public Sub NewUltraMR11()
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime

        Blocal = 30.3                 ''''''''Check B local everytime!

        x = 0

        designedBfield = New Single() {-400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400}

        size = designedBfield.Length()

        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        Do Until x = size
            designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
            x = x + 1
        Loop

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

        System.Threading.Thread.Sleep(600000)  '''''wait till the device enters single exponential decay region

        Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

        System.Threading.Thread.Sleep(2000)   '''''wait the inilization B field to get stable

        x = 0

        inittime = DateTime.Now()

        Do Until x = size
            Z_AGICH2(designedIcoil(x))
            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, for on-null-on pattern would be 2s; for sweeping patter would be 1s.
            newRealBfield(x) = B2_Reading()
            newDeviceVoltage(x) = KeiVoltReading()
            currenttime = DateTime.Now()
            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
            x = x + 1
        Loop

        AbortAGI_CH1()

        x = 0

        Filename = "MRscan.txt"
        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Interval", "Bfield", "Voltage")
        For x = 0 To size - 1
            objWriterTrans.WriteLine(LineFormatTrans, MeasureInterval(x), newRealBfield(x), newDeviceVoltage(x))
        Next
        objWriterTrans.Close()

        Z_AGICH2(((0 + Blocal) / 1806.67))

    End Sub

    Public Sub NewUltraMR12()
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime

        Blocal = 28.06                 ''''''''Check B local everytime!

        x = 0
        y = 0

        designedBfield = New Single() {-100, -95, -90, -85, -80, -75, -70, -65, -60, -55, -50, -45, -40, -35, -30, -25, -20, -15, -10, -5, 0}

        size = designedBfield.Length()

        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        Do Until x = size
            designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
            x = x + 1
        Loop

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

        System.Threading.Thread.Sleep(600000)  '''''wait till the device enters single exponential decay region 600s

        Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

        System.Threading.Thread.Sleep(2000)   '''''wait the inilization B field to get stable

        x = 0

        inittime = DateTime.Now()

        Do Until x = size
            Z_AGICH2(designedIcoil(x))
            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, for on-null-on pattern would be 2s; for sweeping patter would be 1s.
            newRealBfield(x) = B2_Reading()
            newDeviceVoltage(x) = KeiVoltReading()
            currenttime = DateTime.Now()
            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
            x = x + 1
            y = x

            Do Until y = size - 1
                Z_AGICH2(designedIcoil(y))
                System.Threading.Thread.Sleep(1500)
                y = y + 1
            Loop

            Z_AGICH2(designedIcoil(size - 1))
            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, for on-null-on pattern would be 2s; for sweeping patter would be 1s.
            newRealBfield(x) = B2_Reading()
            newDeviceVoltage(x) = KeiVoltReading()
            currenttime = DateTime.Now()
            MeasureInterval(x) = TTimeSpan(currenttime, inittime)

            y = size - 2

            Do Until y = x
                Z_AGICH2(designedIcoil(y))
                System.Threading.Thread.Sleep(1500)
                y = y - 1
            Loop



        Loop

        AbortAGI_CH1()

        x = 0

        Filename = "MRscan.txt"
        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Interval", "Bfield", "Voltage")
        For x = 0 To size - 1
            objWriterTrans.WriteLine(LineFormatTrans, MeasureInterval(x), newRealBfield(x), newDeviceVoltage(x))
        Next
        objWriterTrans.Close()

        Z_AGICH2(((0 + Blocal) / 1806.67))

    End Sub

    Public Sub NewUltraMR13()
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single, MeasureInterval1() As Single, MeasureInterval2() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim transp1 As Single, transp2 As Single, transp3 As Single
        Dim kn As Single, kn1 As Single
        Dim time1 As Single, time2 As Single, tottime As Single
        Dim waittime As Single
        Dim filetime As String
        Dim currtime1 As DateTime

        Blocal = 33.8                 ''''''''Check B local everytime!

        x = 0
        y = 0

        transp1 = 0
        transp2 = 0
        transp3 = 0

        kn = -50
        kn1 = -60

        time1 = 0
        time2 = 0
        tottime = 0
        waittime = 0

        designedBfield = New Single() {-400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400}

        size = designedBfield.Length()

        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}
        MeasureInterval1 = New Single(size) {}
        MeasureInterval2 = New Single(size) {}

        Do Until x = size
            designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
            x = x + 1
        Loop

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

        System.Threading.Thread.Sleep(600000)   '''''''''wait for 10s until the device voltage transient passes the rising bit

        'Do Until (kn > -0.000000119 Or kn = -0.000000119)
        'transp1 = KeiVoltReading()
        'System.Threading.Thread.Sleep(10000)
        ' transp2 = KeiVoltReading()
        '  kn = (transp2 - transp1) / 10
        ' time1 = time1 + 1
        '  System.Threading.Thread.Sleep(10000)
        ' Loop

        ' time1 = (time1 * 10) / 60
        ' kn = -50
        ' kn1 = -60

        ' Do Until (kn1 > kn Or kn1 = kn)
        'transp1 = KeiVoltReading()
        ' System.Threading.Thread.Sleep(10000)
        'transp2 = KeiVoltReading()
        'System.Threading.Thread.Sleep(10000)
        ' transp3 = KeiVoltReading()
        'System.Threading.Thread.Sleep(10000)
        'kn = (transp2 - transp1) / 10
        ' kn1 = (transp3 - transp2) / 10
        ' time2 = time2 + 1
        ' Loop                                                 '''''''''''''''''check if the device enters quasi-linear decaying region

        'time2 = (time2 * 30) / 60

        'tottime = time1 + time2

        Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

        System.Threading.Thread.Sleep(2000)   '''''wait the inilization B field to get stable

        x = 0

        inittime = DateTime.Now()


        Do Until y = 20
            x = 0

            Do Until x = size
                Z_AGICH2(designedIcoil(x))
                waittime = 0
                currtime1 = DateTime.Now()
                Do Until waittime > 1500

                    currenttime = DateTime.Now()
                    waittime = TTimeSpan(currenttime, currtime1)
                Loop                                       '''''''''''waiting time for the B field to get stable, for on-null-on pattern would be 2s; for sweeping patter would be 1s.

                currenttime = DateTime.Now()
                MeasureInterval1(x) = TTimeSpan(currenttime, inittime)
                'System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, for on-null-on pattern would be 2s; for sweeping patter would be 1s.

                newRealBfield(x) = B2_Reading()
                currenttime = DateTime.Now()
                MeasureInterval2(x) = TTimeSpan(currenttime, inittime)

                newDeviceVoltage(x) = KeiVoltReading()
                currenttime = DateTime.Now()
                MeasureInterval(x) = TTimeSpan(currenttime, inittime)

                x = x + 1
            Loop


            'AbortAGI_CH1()

            'x = 0

            filetime = DateTime.Now.ToString()
            filetime = filetime.Replace("/", "_")
            filetime = filetime.Replace(":", "_")

            Filename = filetime + "-" + "MRscan.txt"
            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
            Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}{3,-16:E}{4,-16:E}"
            objWriterTrans.WriteLine("Stabilizing time = " + Format(tottime, "##0.000") + "mins")
            objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}{4,-16}", "time after wait", "time after B reading", "time after V reading", "Bfield", "Voltage")
            For x = 0 To size - 1
                objWriterTrans.WriteLine(LineFormatTrans, MeasureInterval1(x), MeasureInterval2(x), MeasureInterval(x), newRealBfield(x), newDeviceVoltage(x))
            Next
            objWriterTrans.Close()

            y = y + 1
        Loop

        AbortAGI_CH1()
        x = 0

        Z_AGICH2(((0 + Blocal) / 1806.67))

    End Sub
    Public Sub NewUltraMR14()
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim y As Integer
        Dim filetime As String

        Blocal = 33.18                 ''''''''Check B local everytime!

        x = 0
        y = 0

        designedBfield = New Single() {-400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400}

        size = designedBfield.Length()

        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        Do Until x = size
            designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
            x = x + 1
        Loop

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

        System.Threading.Thread.Sleep(600000)  '''''wait till the device enters single exponential decay region

        Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

        System.Threading.Thread.Sleep(2000)   '''''wait the inilization B field to get stable

        x = 0

        inittime = DateTime.Now()

        Do Until y = 20
            x = 0
            Do Until x = size
                Z_AGICH2(designedIcoil(x))
                System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, for on-null-on pattern would be 2s; for sweeping patter would be 1s.
                newRealBfield(x) = B2_Reading()
                newDeviceVoltage(x) = KeiVoltReading()
                currenttime = DateTime.Now()
                MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                x = x + 1
            Loop

            filetime = DateTime.Now.ToString()
            filetime = filetime.Replace("/", "_")
            filetime = filetime.Replace(":", "_")

            Filename = filetime + "-" + "MRscan.txt"
            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
            Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
            objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Interval", "Bfield", "Voltage")
            For x = 0 To size - 1
                objWriterTrans.WriteLine(LineFormatTrans, MeasureInterval(x), newRealBfield(x), newDeviceVoltage(x))
            Next
            objWriterTrans.Close()

            y = y + 1
        Loop
        AbortAGI_CH1()

        Z_AGICH2(((0 + Blocal) / 1806.67))

    End Sub

    Public Sub NewUltraMR15()
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String

        Blocal = -4.64               ''''''''Check B local everytime!

        x = 0
        y = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}

        size = designedBfield.Length()

        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        Do Until x = size
            designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
            x = x + 1
        Loop

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        inittime = DateTime.Now()

        Do Until y = 20
            x = 0
            DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

            System.Threading.Thread.Sleep(600000)  '''''wait till the device enters single exponential decay region

            Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

            System.Threading.Thread.Sleep(2000)
            Do Until x = size
                Z_AGICH2(designedIcoil(x))
                System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, for on-null-on pattern would be 2s; for sweeping patter would be 1s.
                newRealBfield(x) = B2_Reading()
                newDeviceVoltage(x) = KeiVoltReading()
                currenttime = DateTime.Now()
                MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                x = x + 1
            Loop
            AbortAGI_CH1()
            Z_AGICH2(((0 + Blocal) / 1806.67))


            FILETIME = DateTime.Now.ToString()
            FILETIME = FILETIME.Replace("/", "_")
            FILETIME = FILETIME.Replace(":", "_")

            Filename = FILETIME + "-" + "MRscan.txt"
            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
            Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
            objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Interval", "Bfield", "Voltage")
            For x = 0 To size - 1
                objWriterTrans.WriteLine(LineFormatTrans, MeasureInterval(x), newRealBfield(x), newDeviceVoltage(x))
            Next
            objWriterTrans.Close()

            y = y + 1
            System.Threading.Thread.Sleep(10000)
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH2()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()



    End Sub

    Public Sub NewUltraMR16()
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        'Kcoil = 1806.67

        Kcoil = 1800.163 '''''COIL Z
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0}
        designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}

        size = designedBfield.Length()

        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        inittime = DateTime.Now()

        Do Until y = 1
            x = 0
            Blocal = 0
            z = 0
            AbortAGI_CH2()
            System.Threading.Thread.Sleep(2000)
            Do Until z = 3
                Blocal = B2_Reading() + Blocal
                System.Threading.Thread.Sleep(3000)
                z = z + 1
            Loop

            Blocal = -(Blocal / 3)

            Do Until x = size
                designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                x = x + 1
            Loop

            ONAGI_CH2()
            System.Threading.Thread.Sleep(1000)

            Z_AGICH2(((0 + Blocal) / Kcoil))

            System.Threading.Thread.Sleep(2000)


            DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

            System.Threading.Thread.Sleep(600000)  '''''wait till the device enters single exponential decay region

            Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

            System.Threading.Thread.Sleep(2000)

            x = 0
            Do Until x = size
                Diff = 50
                Z_AGICH2(designedIcoil(x))
                System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                Diffnum = 0
                Do Until (Diff < 0.5 Or Diff = 0.5)
                    Bnow = B2_Reading()
                    Diff = Math.Abs(Bnow - designedBfield(x))
                    System.Threading.Thread.Sleep(30)
                    Diffnum = Diffnum + 1
                    If Diffnum > 100 Then
                        If (Bnow - designedBfield(x)) > 0 Then
                            Z_AGICH2(designedIcoil(x) - 0.00025)
                            System.Threading.Thread.Sleep(1000)
                        ElseIf (Bnow - designedBfield(x)) < 0 Then
                            Z_AGICH2(designedIcoil(x) + 0.00025)
                            System.Threading.Thread.Sleep(1000)
                        End If
                    End If

                Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                newRealBfield(x) = Bnow
                newDeviceVoltage(x) = KeiVoltReading()
                currenttime = DateTime.Now()
                MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                x = x + 1
            Loop
            AbortAGI_CH1()
            Z_AGICH2(((0 + Blocal) / Kcoil))


            FILETIME = DateTime.Now.ToString()
            FILETIME = FILETIME.Replace("/", "_")
            FILETIME = FILETIME.Replace(":", "_")

            'Filename = FILETIME + "-" + "MRscan.txt"
            Filename = fileNum.ToString() + ".txt"
            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
            Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
            objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
            For x = 0 To size - 1
                objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
            Next
            objWriterTrans.Close()

            y = y + 1
            fileNum = fileNum + 1
            System.Threading.Thread.Sleep(10000)
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH2()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()



    End Sub

    Public Sub NewUltraMR17()
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim newDeviceLight() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bnow As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0}
        size = designedBfield.Length()

        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}
        newDeviceLight = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter

        InitNewport()

        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        inittime = DateTime.Now()

        Do Until y = 20
            x = 0
            Blocal = 0
            z = 0
            AbortAGI_CH2()
            System.Threading.Thread.Sleep(2000)
            Do Until z = 3
                Blocal = B2_Reading() + Blocal
                System.Threading.Thread.Sleep(3000)
                z = z + 1
            Loop

            Blocal = -(Blocal / 3)

            Do Until x = size
                designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
                x = x + 1
            Loop

            ONAGI_CH2()
            System.Threading.Thread.Sleep(1000)

            Z_AGICH2(((0 + Blocal) / 1806.67))

            System.Threading.Thread.Sleep(2000)


            DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

            System.Threading.Thread.Sleep(600000)  '''''wait till the device enters single exponential decay region

            Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

            System.Threading.Thread.Sleep(2000)

            x = 0
            Do Until x = size
                Diff = 50
                Z_AGICH2(designedIcoil(x))
                System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 

                Do Until (Diff < 5 Or Diff = 5)
                    Bnow = B2_Reading()
                    Diff = Math.Abs(Bnow - designedBfield(x))
                    System.Threading.Thread.Sleep(30)
                Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                newRealBfield(x) = Bnow
                newDeviceVoltage(x) = KeiVoltReading()
                newDeviceLight(x) = ReadIntensity()
                currenttime = DateTime.Now()
                MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                x = x + 1
            Loop
            AbortAGI_CH1()
            Z_AGICH2(((0 + Blocal) / 1806.67))


            FILETIME = DateTime.Now.ToString()
            FILETIME = FILETIME.Replace("/", "_")
            FILETIME = FILETIME.Replace(":", "_")

            Filename = FILETIME + "-" + "MRscan.txt"
            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
            Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}{3,-16:E}"
            objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}", "Interval", "Bfield", "Voltage", "Light Output")
            For x = 0 To size - 1
                objWriterTrans.WriteLine(LineFormatTrans, MeasureInterval(x), newRealBfield(x), newDeviceVoltage(x), newDeviceLight(x))
            Next
            objWriterTrans.Close()

            y = y + 1
            System.Threading.Thread.Sleep(10000)
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH2()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()



    End Sub

    Public Sub NewUltraMR18()
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim newCoilcalculatedCurr() As Single
        Dim newCoilrealCurr() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        'Kcoil = 1806.67
        Kcoil = 1800.163
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -345, 0, -340, 0}
        designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}

        size = designedBfield.Length()

        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}
        newCoilcalculatedCurr = New Single(size) {}
        newCoilrealCurr = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        inittime = DateTime.Now()

        Do Until y = 1
            x = 0
            Blocal = 0
            z = 0
            AbortAGI_CH2()
            System.Threading.Thread.Sleep(2000)
            Do Until z = 3
                Blocal = B2_Reading() + Blocal
                System.Threading.Thread.Sleep(3000)
                z = z + 1
            Loop

            Blocal = -(Blocal / 3)

            Do Until x = size
                designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                x = x + 1
            Loop

            ONAGI_CH2()
            System.Threading.Thread.Sleep(1000)

            Z_AGICH2_MEAS(((0 + Blocal) / Kcoil))

            System.Threading.Thread.Sleep(2000)


            DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

            System.Threading.Thread.Sleep(600000)  '''''wait till the device enters single exponential decay region

            Z_AGICH2_MEAS(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

            System.Threading.Thread.Sleep(2000)

            x = 0
            Do Until x = size
                Diff = 50
                Z_AGICH2_MEAS(designedIcoil(x))
                System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                Diffnum = 0
                Do Until (Diff < 5 Or Diff = 5)
                    Bnow = B2_Reading()
                    Diff = Math.Abs(Bnow - designedBfield(x))
                    System.Threading.Thread.Sleep(30)
                    Diffnum = Diffnum + 1
                    If Diffnum > 100 Then
                        If (Bnow - designedBfield(x)) > 0 Then

                            Z_AGICH2_MEAS(designedIcoil(x) - 0.00025)
                            System.Threading.Thread.Sleep(1000)


                        ElseIf (Bnow - designedBfield(x)) < 0 Then

                            Z_AGICH2_MEAS(designedIcoil(x) + 0.00025)
                            System.Threading.Thread.Sleep(1000)


                        End If
                    End If

                Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                newRealBfield(x) = Bnow
                newDeviceVoltage(x) = KeiVoltReading()
                newCoilcalculatedCurr(x) = designedIcoil(x)
                newCoilrealCurr(x) = AGICH2_coil_current_reading()
                currenttime = DateTime.Now()
                MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                x = x + 1
            Loop
            AbortAGI_CH1()
            Z_AGICH2_MEAS(((0 + Blocal) / Kcoil))


            FILETIME = DateTime.Now.ToString()
            FILETIME = FILETIME.Replace("/", "_")
            FILETIME = FILETIME.Replace(":", "_")

            'Filename = FILETIME + "-" + "MRscan.txt"
            Filename = fileNum.ToString() + ".txt"
            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
            Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}{3,-16:E}{4,-16:E}"
            objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}{4,-16}", "Bfield", "Voltage", "Calculated Drive Current", "Real Drive Current", "Interval")
            For x = 0 To size - 1
                objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), newCoilcalculatedCurr(x), newCoilrealCurr(x), MeasureInterval(x))
            Next
            objWriterTrans.Close()

            y = y + 1
            fileNum = fileNum + 1
            System.Threading.Thread.Sleep(10000)
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH2()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()



    End Sub

    Public Sub NewUltraMR19()
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single

        Dim InitB As Single
        Dim FinB As Single
        Dim InitBCurr As Single
        Dim FinBCurr As Single
        Dim DriveCurr As Single
        Dim Istep As Single




        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        'Kcoil = 1806.67
        Kcoil = 1800.163
        fileNum = 0


        InitB = -185
        FinB = -180


        Istep = 0.000001
        'Istep = 0.01


        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        inittime = DateTime.Now()

        Do Until y = 1
            x = 0
            Blocal = 0
            z = 0

            AbortAGI_CH2()
            System.Threading.Thread.Sleep(2000)
            Do Until z = 3
                Blocal = B2_Reading() + Blocal
                System.Threading.Thread.Sleep(3000)
                z = z + 1
            Loop

            Blocal = -(Blocal / 3)

            InitBCurr = (InitB + Blocal) / Kcoil

            FinBCurr = (FinB + Blocal) / Kcoil

            Diff = Math.Abs(InitBCurr - FinBCurr)

            size = (Diff / Istep) + 1

            newDeviceVoltage = New Single(2 * size + 1) {}
            designedIcoil = New Single(2 * size + 1) {}
            newRealBfield = New Single(2 * size + 1) {}
            MeasureInterval = New Single(2 * size + 1) {}

            ONAGI_CH2()
            System.Threading.Thread.Sleep(1000)

            Z_AGICH2(((0 + Blocal) / Kcoil))

            System.Threading.Thread.Sleep(2000)


            DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

            System.Threading.Thread.Sleep(600000)  '''''wait till the device enters single exponential decay region

            Z_AGICH2(InitBCurr)     '''''''initialize the coil B field to be the first wanted B field in the list

            System.Threading.Thread.Sleep(2000)

            x = 0
            DriveCurr = InitBCurr
            Do Until x = size
                Z_AGICH2(((0 + Blocal) / Kcoil))
                System.Threading.Thread.Sleep(1500)

                newRealBfield(2 * x) = B2_Reading()
                newDeviceVoltage(2 * x) = KeiVoltReading()
                designedIcoil(2 * x) = ((0 + Blocal) / Kcoil)

                Z_AGICH2(DriveCurr)
                System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 

                newRealBfield(2 * x + 1) = B2_Reading()
                newDeviceVoltage(2 * x + 1) = KeiVoltReading()
                designedIcoil(2 * x + 1) = DriveCurr


                x = x + 1
                DriveCurr = DriveCurr + Istep
            Loop

            Z_AGICH2(((0 + Blocal) / Kcoil))
            System.Threading.Thread.Sleep(1500)

            newRealBfield(2 * size) = B2_Reading()
            newDeviceVoltage(2 * size) = KeiVoltReading()
            designedIcoil(2 * size) = ((0 + Blocal) / Kcoil)

            AbortAGI_CH1()
            Z_AGICH2(((0 + Blocal) / Kcoil))


            FILETIME = DateTime.Now.ToString()
            FILETIME = FILETIME.Replace("/", "_")
            FILETIME = FILETIME.Replace(":", "_")

            'Filename = FILETIME + "-" + "MRscan.txt"
            Filename = fileNum.ToString() + ".txt"
            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
            Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
            objWriterTrans.WriteLine("Blocal = " + Format(Blocal, "##0.0000") + "uT")
            objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Designed Current")
            For x = 0 To 2 * size
                objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), designedIcoil(x))
            Next
            objWriterTrans.Close()

            y = y + 1
            fileNum = fileNum + 1
            System.Threading.Thread.Sleep(10000)
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH2()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()



    End Sub


    Public Sub NewUltraMR20()   '''''''USING KEITHLEY AS DEVICE SOURCING UNIT
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        'Kcoil = 1806.67

        Kcoil = 1800.163 '''''COIL Z
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0}
        designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}

        size = designedBfield.Length()

        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        inittime = DateTime.Now()

        Do Until y = 1
            x = 0
            Blocal = 0
            z = 0
            AbortAGI_CH2()
            System.Threading.Thread.Sleep(2000)
            Do Until z = 3
                Blocal = B2_Reading() + Blocal
                System.Threading.Thread.Sleep(3000)
                z = z + 1
            Loop

            Blocal = -(Blocal / 3)

            Do Until x = size
                designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                x = x + 1
            Loop

            ONAGI_CH2()
            System.Threading.Thread.Sleep(1000)

            Z_AGICH2(((0 + Blocal) / Kcoil))

            System.Threading.Thread.Sleep(2000)


            'DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias
            KeiDEVCurrsource(0.000002)    ''''''''source the device with 2uA with Keithley      

            System.Threading.Thread.Sleep(600000)  '''''wait till the device enters single exponential decay region

            Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

            System.Threading.Thread.Sleep(2000)

            x = 0
            Do Until x = size
                Diff = 50
                Z_AGICH2(designedIcoil(x))
                System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                Diffnum = 0
                Do Until (Diff < 0.5 Or Diff = 0.5)
                    Bnow = B2_Reading()
                    Diff = Math.Abs(Bnow - designedBfield(x))
                    System.Threading.Thread.Sleep(30)
                    Diffnum = Diffnum + 1
                    If Diffnum > 100 Then
                        If (Bnow - designedBfield(x)) > 0 Then
                            Z_AGICH2(designedIcoil(x) - 0.00025)
                            System.Threading.Thread.Sleep(1000)
                        ElseIf (Bnow - designedBfield(x)) < 0 Then
                            Z_AGICH2(designedIcoil(x) + 0.00025)
                            System.Threading.Thread.Sleep(1000)
                        End If
                    End If

                Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                newRealBfield(x) = Bnow
                newDeviceVoltage(x) = KeiVoltReading()
                currenttime = DateTime.Now()
                MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                x = x + 1
            Loop
            'AbortAGI_CH1()
            KeiDEVOFF()
            Z_AGICH2(((0 + Blocal) / Kcoil))


            FILETIME = DateTime.Now.ToString()
            FILETIME = FILETIME.Replace("/", "_")
            FILETIME = FILETIME.Replace(":", "_")

            'Filename = FILETIME + "-" + "MRscan.txt"
            Filename = fileNum.ToString() + ".txt"
            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
            Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
            objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
            For x = 0 To size - 1
                objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
            Next
            objWriterTrans.Close()

            y = y + 1
            fileNum = fileNum + 1
            System.Threading.Thread.Sleep(10000)
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH2()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()



    End Sub

    Public Sub NewUltraMR21()    ''''''''manual check 
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        'Kcoil = 1806.67

        Kcoil = 1800.163 '''''COIL Z
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0}
        'designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}
        designedBfield = New Single() {0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0}


        size = designedBfield.Length()

        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        'KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        inittime = DateTime.Now()

        Do Until y = 1
            x = 0
            Blocal = 0
            z = 0
            AbortAGI_CH2()
            System.Threading.Thread.Sleep(2000)
            Do Until z = 3
                Blocal = B2_Reading() + Blocal
                System.Threading.Thread.Sleep(3000)
                z = z + 1
            Loop

            Blocal = -(Blocal / 3)

            Do Until x = size
                designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                x = x + 1
            Loop

            ONAGI_CH2()
            System.Threading.Thread.Sleep(1000)

            x = 0
            Do Until x = size

                Z_AGICH2(designedIcoil(x))
                System.Threading.Thread.Sleep(20000)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                Diffnum = 0
                ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                newRealBfield(x) = B2_Reading()
                'newDeviceVoltage(x) = KeiVoltReading()
                currenttime = DateTime.Now()
                MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                x = x + 1
            Loop
            AbortAGI_CH1()
            Z_AGICH2(((0 + Blocal) / Kcoil))


            FILETIME = DateTime.Now.ToString()
            FILETIME = FILETIME.Replace("/", "_")
            FILETIME = FILETIME.Replace(":", "_")

            'Filename = FILETIME + "-" + "MRscan.txt"
            Filename = fileNum.ToString() + ".txt"
            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
            Dim LineFormatTrans As String = "{0,-10}"
            objWriterTrans.WriteLine("{0,-10}", "Bfield")
            For x = 0 To size - 1
                objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x))
            Next
            objWriterTrans.Close()

            y = y + 1
            fileNum = fileNum + 1
            System.Threading.Thread.Sleep(10000)
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH2()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()



    End Sub

    Public Sub NewUltraMR22()     ''''''''çonstant voltage bias while measuring device current
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer

        Dim newDeviceVoltage() As Single
        Dim newDeviceCurrent() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        'Kcoil = 1806.67

        Kcoil = 1800.163 '''''COIL Z
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0}
        designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}

        size = designedBfield.Length()

        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}
        newDeviceCurrent = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        ''KeiIniVM()    ''''''Initialize Keithley as Voltmeter
        KeiIniAM()    ''''''Ínitialize Keithley as Ampmeter


        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        inittime = DateTime.Now()

        Do Until y = 20
            x = 0
            Blocal = 0
            z = 0
            AbortAGI_CH2()
            System.Threading.Thread.Sleep(2000)
            Do Until z = 3
                Blocal = B2_Reading() + Blocal
                System.Threading.Thread.Sleep(3000)
                z = z + 1
            Loop

            Blocal = -(Blocal / 3)

            Do Until x = size
                designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                x = x + 1
            Loop

            ONAGI_CH2()
            System.Threading.Thread.Sleep(1000)

            Z_AGICH2(((0 + Blocal) / Kcoil))

            System.Threading.Thread.Sleep(2000)


            '' DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias
            DUT_AGICH1VOLT(3.15)        '''''''source the device with 3.1V constant voltage bias

            System.Threading.Thread.Sleep(600000)  '''''wait till the device enters single exponential decay region

            Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

            System.Threading.Thread.Sleep(2000)

            x = 0
            Do Until x = size
                Diff = 50
                Z_AGICH2(designedIcoil(x))
                System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                Diffnum = 0
                Do Until (Diff < 0.5 Or Diff = 0.5)
                    Bnow = B2_Reading()
                    Diff = Math.Abs(Bnow - designedBfield(x))
                    System.Threading.Thread.Sleep(30)
                    Diffnum = Diffnum + 1
                    If Diffnum > 100 Then
                        If (Bnow - designedBfield(x)) > 0 Then
                            Z_AGICH2(designedIcoil(x) - 0.00025)
                            System.Threading.Thread.Sleep(1000)
                        ElseIf (Bnow - designedBfield(x)) < 0 Then
                            Z_AGICH2(designedIcoil(x) + 0.00025)
                            System.Threading.Thread.Sleep(1000)
                        End If
                    End If

                Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                newRealBfield(x) = Bnow
                ''newDeviceVoltage(x) = KeiVoltReading()
                newDeviceCurrent(x) = KeiCurrReading()
                currenttime = DateTime.Now()
                MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                x = x + 1
            Loop
            AbortAGI_CH1()
            Z_AGICH2(((0 + Blocal) / Kcoil))


            FILETIME = DateTime.Now.ToString()
            FILETIME = FILETIME.Replace("/", "_")
            FILETIME = FILETIME.Replace(":", "_")

            'Filename = FILETIME + "-" + "MRscan.txt"
            Filename = fileNum.ToString() + ".txt"
            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
            Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
            objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Current", "Interval")
            For x = 0 To size - 1
                objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceCurrent(x), MeasureInterval(x))
            Next
            objWriterTrans.Close()

            y = y + 1
            fileNum = fileNum + 1
            System.Threading.Thread.Sleep(10000)
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH2()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()



    End Sub

    Public Sub NewUltraMR23()                              ''''''''''''''''''''''''''''''using Keithley source meter to drive Z coil........................................
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        'Kcoil = 1806.67

        'Kcoil = 1800.163 '''''COIL Z
        Kcoil = 1813.13  '''''COIL Z with Keithley source meter
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -250, 0, -100, 0}
        'designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}


        designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}

        'designedBfield = New Single() {0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -400, 0, -300, 0, -200, 0, -100, 0, 0, 0, 100, 0, 200, 0, 300, 0, 400, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}

        'designedBfield = New Single() {0, -600, 0, -580, 0, -560, 0, -540, 0, -520, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 520, 0, 540, 0, 560, 0, 580, 0, 600, 0}


        size = designedBfield.Length()

        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        'KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        inittime = DateTime.Now()

        Do Until y = 45
            x = 0
            Blocal = 0
            z = 0

            KeiIniVM()

            'AbortAGI_CH2()
            AbortKEI_SM()
            System.Threading.Thread.Sleep(2000)
            Do Until z = 3
                Blocal = B2_Reading() + Blocal
                System.Threading.Thread.Sleep(3000)
                z = z + 1
            Loop

            Blocal = -(Blocal / 3)

            Do Until x = size
                designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                x = x + 1
            Loop

            'ONAGI_CH2()
            ONKEI_SM()
            System.Threading.Thread.Sleep(1000)

            'Z_AGICH2(((0 + Blocal) / Kcoil))
            Z_KEI(((0 + Blocal) / Kcoil))


            System.Threading.Thread.Sleep(2000)


            DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

            System.Threading.Thread.Sleep(600000)  '''''wait till the device enters single exponential decay region

            'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

            Z_KEI(designedIcoil(0))

            System.Threading.Thread.Sleep(2000)

            x = 0
            Do Until x = size
                Diff = 50
                'Z_AGICH2(designedIcoil(x))
                Z_KEI(designedIcoil(x))
                System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                Diffnum = 0
                Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                    'Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                    Bnow = B2_Reading()
                    Diff = Math.Abs(Bnow - designedBfield(x))
                    System.Threading.Thread.Sleep(30)
                    Diffnum = Diffnum + 1
                    If Diffnum > 100 Then
                        If (Bnow - designedBfield(x)) > 0 Then
                            'Z_AGICH2(designedIcoil(x) - 0.00025)
                            Z_KEI(designedIcoil(x) - 0.00025)
                            System.Threading.Thread.Sleep(1000)
                        ElseIf (Bnow - designedBfield(x)) < 0 Then
                            'Z_AGICH2(designedIcoil(x) + 0.00025)
                            Z_KEI(designedIcoil(x) + 0.00025)
                            System.Threading.Thread.Sleep(1000)
                        End If
                    End If

                Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                newRealBfield(x) = Bnow
                newDeviceVoltage(x) = KeiVoltReading()
                currenttime = DateTime.Now()
                MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                x = x + 1
            Loop
            AbortAGI_CH1()

            AbortKEI_4200()

            'Z_AGICH2(((0 + Blocal) / Kcoil))
            Z_KEI(((0 + Blocal) / Kcoil))

            FILETIME = DateTime.Now.ToString()
            FILETIME = FILETIME.Replace("/", "_")
            FILETIME = FILETIME.Replace(":", "_")

            'Filename = FILETIME + "-" + "MRscan.txt"
            Filename = fileNum.ToString() + ".txt"
            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
            Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
            objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
            For x = 0 To size - 1
                objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
            Next
            objWriterTrans.Close()

            y = y + 1
            fileNum = fileNum + 1
            System.Threading.Thread.Sleep(10000)
        Loop




        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortKEI_SM()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()



    End Sub

    Public Sub NewUltraMR24()                            '''''''''''''''''''''''''''''try catch solution / using keitley source meter..........
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        'Kcoil = 1806.67

        'Kcoil = 1800.163 '''''COIL Z
        Kcoil = 1813.13  '''''COIL Z with Keithley source meter
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -250, 0, -100, 0}
        'designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}

        ''''small field
        'designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}

        '''''ultra small field
        designedBfield = New Single() {0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0}

        ''''''large field 
        'designedBfield = New Single() {0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -400, 0, -300, 0, -200, 0, -100, 0, 0, 0, 100, 0, 200, 0, 300, 0, 400, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}

        'designedBfield = New Single() {0, -600, 0, -580, 0, -560, 0, -540, 0, -520, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 520, 0, 540, 0, 560, 0, 580, 0, 600, 0}


        size = designedBfield.Length()

        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        'KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        inittime = DateTime.Now()

        Try

            Do Until y = 500
                x = 0
                Blocal = 0
                z = 0

                KeiIniVM()

                'AbortAGI_CH2()
                AbortKEI_SM()
                System.Threading.Thread.Sleep(2000)
                Do Until z = 3
                    Blocal = B2_Reading() + Blocal
                    System.Threading.Thread.Sleep(3000)
                    z = z + 1
                Loop

                Blocal = -(Blocal / 3)

                Do Until x = size
                    designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                    x = x + 1
                Loop

                'ONAGI_CH2()
                ONKEI_SM()
                System.Threading.Thread.Sleep(1000)

                'Z_AGICH2(((0 + Blocal) / Kcoil))
                Z_KEI(((0 + Blocal) / Kcoil))


                System.Threading.Thread.Sleep(2000)


                DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

                System.Threading.Thread.Sleep(600000)  '''''wait till the device enters single exponential decay region

                'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                Z_KEI(designedIcoil(0))

                System.Threading.Thread.Sleep(2000)

                x = 0
                Do Until x = size
                    Diff = 50
                    'Z_AGICH2(designedIcoil(x))
                    Z_KEI(designedIcoil(x))
                    System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                    Diffnum = 0
                    Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                        'Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                        Bnow = B2_Reading()
                        Diff = Math.Abs(Bnow - designedBfield(x))
                        System.Threading.Thread.Sleep(30)
                        Diffnum = Diffnum + 1
                        If Diffnum > 100 Then
                            If (Bnow - designedBfield(x)) > 0 Then
                                'Z_AGICH2(designedIcoil(x) - 0.00025)
                                Z_KEI(designedIcoil(x) - 0.00025)
                                System.Threading.Thread.Sleep(1000)
                            ElseIf (Bnow - designedBfield(x)) < 0 Then
                                'Z_AGICH2(designedIcoil(x) + 0.00025)
                                Z_KEI(designedIcoil(x) + 0.00025)
                                System.Threading.Thread.Sleep(1000)
                            End If
                        End If

                    Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                    newRealBfield(x) = Bnow
                    newDeviceVoltage(x) = KeiVoltReading()
                    currenttime = DateTime.Now()
                    MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                    x = x + 1
                Loop
                AbortAGI_CH1()

                AbortKEI_4200()

                'Z_AGICH2(((0 + Blocal) / Kcoil))
                Z_KEI(((0 + Blocal) / Kcoil))

                FILETIME = DateTime.Now.ToString()
                FILETIME = FILETIME.Replace("/", "_")
                FILETIME = FILETIME.Replace(":", "_")

                'Filename = FILETIME + "-" + "MRscan.txt"
                Filename = fileNum.ToString() + ".txt"
                Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                For x = 0 To size - 1
                    objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                Next
                objWriterTrans.Close()

                y = y + 1
                fileNum = fileNum + 1
                System.Threading.Thread.Sleep(10000)
            Loop

        Catch ex As NationalInstruments.NI4882.GpibException
            System.Threading.Thread.Sleep(10000)
            AbortAGI_CH1()
            System.Threading.Thread.Sleep(5000)
            AbortKEI_SM()
            System.Threading.Thread.Sleep(5000)
            AbortKEI_4200()
            System.Threading.Thread.Sleep(5000)

            Do Until y = 500
                x = 0
                Blocal = 0
                z = 0

                KeiIniVM()

                'AbortAGI_CH2()
                AbortKEI_SM()
                System.Threading.Thread.Sleep(2000)
                Do Until z = 3
                    Blocal = B2_Reading() + Blocal
                    System.Threading.Thread.Sleep(3000)
                    z = z + 1
                Loop

                Blocal = -(Blocal / 3)

                Do Until x = size
                    designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                    x = x + 1
                Loop

                'ONAGI_CH2()
                ONKEI_SM()
                System.Threading.Thread.Sleep(1000)

                'Z_AGICH2(((0 + Blocal) / Kcoil))
                Z_KEI(((0 + Blocal) / Kcoil))


                System.Threading.Thread.Sleep(2000)


                DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias

                System.Threading.Thread.Sleep(600000)  '''''wait till the device enters single exponential decay region

                'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                Z_KEI(designedIcoil(0))

                System.Threading.Thread.Sleep(2000)

                x = 0
                Do Until x = size
                    Diff = 50
                    'Z_AGICH2(designedIcoil(x))
                    Z_KEI(designedIcoil(x))
                    System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                    Diffnum = 0
                    Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                        'Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                        Bnow = B2_Reading()
                        Diff = Math.Abs(Bnow - designedBfield(x))
                        System.Threading.Thread.Sleep(30)
                        Diffnum = Diffnum + 1
                        If Diffnum > 100 Then
                            If (Bnow - designedBfield(x)) > 0 Then
                                'Z_AGICH2(designedIcoil(x) - 0.00025)
                                Z_KEI(designedIcoil(x) - 0.00025)
                                System.Threading.Thread.Sleep(1000)
                            ElseIf (Bnow - designedBfield(x)) < 0 Then
                                'Z_AGICH2(designedIcoil(x) + 0.00025)
                                Z_KEI(designedIcoil(x) + 0.00025)
                                System.Threading.Thread.Sleep(1000)
                            End If
                        End If

                    Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                    newRealBfield(x) = Bnow
                    newDeviceVoltage(x) = KeiVoltReading()
                    currenttime = DateTime.Now()
                    MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                    x = x + 1
                Loop
                AbortAGI_CH1()

                AbortKEI_4200()

                'Z_AGICH2(((0 + Blocal) / Kcoil))
                Z_KEI(((0 + Blocal) / Kcoil))

                FILETIME = DateTime.Now.ToString()
                FILETIME = FILETIME.Replace("/", "_")
                FILETIME = FILETIME.Replace(":", "_")

                'Filename = FILETIME + "-" + "MRscan.txt"
                Filename = fileNum.ToString() + ".txt"
                Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                For x = 0 To size - 1
                    objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                Next
                objWriterTrans.Close()

                y = y + 1
                fileNum = fileNum + 1
                System.Threading.Thread.Sleep(10000)
            Loop

        Finally
            System.Threading.Thread.Sleep(5000)
            AbortAGI_CH1()
            System.Threading.Thread.Sleep(5000)
            AbortKEI_SM()
            System.Threading.Thread.Sleep(5000)
            Siglent_Abort()
        End Try




    End Sub

    Public Sub NewUltraMR25()                            '''''''''''''''''''''''''''''try catch solution / using keitley source meter /  CONSTANT device voltage..........
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer

        Dim newDeviceVoltage() As Single
        Dim newDeviceCurrent() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        'Kcoil = 1806.67

        'Kcoil = 1800.163 '''''COIL Z
        Kcoil = 1813.13  '''''COIL Z with Keithley source meter
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -250, 0, -100, 0}
        'designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}

        ''''small field
        designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}

        '''''ultra small field
        'designedBfield = New Single() {0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0}

        ''''''large field 
        'designedBfield = New Single() {0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -400, 0, -300, 0, -200, 0, -100, 0, 0, 0, 100, 0, 200, 0, 300, 0, 400, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}

        'designedBfield = New Single() {0, -600, 0, -580, 0, -560, 0, -540, 0, -520, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 520, 0, 540, 0, 560, 0, 580, 0, 600, 0}


        size = designedBfield.Length()

        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}
        newDeviceCurrent = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        'KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        inittime = DateTime.Now()

        Try

            Do Until y = 100
                x = 0
                Blocal = 0
                z = 0

                'KeiIniVM()                                      ''''''''''''''''''''''''initialize Keithley 4200 as a voltmeter
                KeiIniAM()    ''''''Ínitialize Keithley 4200 as Ampmeter

                'AbortAGI_CH2()
                AbortKEI_SM()
                System.Threading.Thread.Sleep(2000)
                Do Until z = 3
                    Blocal = B2_Reading() + Blocal
                    System.Threading.Thread.Sleep(3000)
                    z = z + 1
                Loop

                Blocal = -(Blocal / 3)

                Do Until x = size
                    designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                    x = x + 1
                Loop

                'ONAGI_CH2()
                ONKEI_SM()
                System.Threading.Thread.Sleep(1000)

                'Z_AGICH2(((0 + Blocal) / Kcoil))
                Z_KEI(((0 + Blocal) / Kcoil))


                System.Threading.Thread.Sleep(2000)


                ' DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias
                DUT_AGICH1VOLT(3.22)      ''''''''source the device with 3.22V constant voltage bias

                System.Threading.Thread.Sleep(600000)  '''''wait till the device enters single exponential decay region

                'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                Z_KEI(designedIcoil(0))

                System.Threading.Thread.Sleep(2000)

                x = 0
                Do Until x = size
                    Diff = 50
                    'Z_AGICH2(designedIcoil(x))
                    Z_KEI(designedIcoil(x))
                    System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                    Diffnum = 0
                    Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                        'Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                        Bnow = B2_Reading()
                        Diff = Math.Abs(Bnow - designedBfield(x))
                        System.Threading.Thread.Sleep(30)
                        Diffnum = Diffnum + 1
                        If Diffnum > 100 Then
                            If (Bnow - designedBfield(x)) > 0 Then
                                'Z_AGICH2(designedIcoil(x) - 0.00025)
                                Z_KEI(designedIcoil(x) - 0.00025)
                                System.Threading.Thread.Sleep(1000)
                            ElseIf (Bnow - designedBfield(x)) < 0 Then
                                'Z_AGICH2(designedIcoil(x) + 0.00025)
                                Z_KEI(designedIcoil(x) + 0.00025)
                                System.Threading.Thread.Sleep(1000)
                            End If
                        End If

                    Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                    newRealBfield(x) = Bnow
                    'newDeviceVoltage(x) = KeiVoltReading()
                    newDeviceCurrent(x) = KeiCurrReading()
                    currenttime = DateTime.Now()
                    MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                    x = x + 1
                Loop
                AbortAGI_CH1()

                AbortKEI_4200AM()

                'Z_AGICH2(((0 + Blocal) / Kcoil))
                Z_KEI(((0 + Blocal) / Kcoil))

                FILETIME = DateTime.Now.ToString()
                FILETIME = FILETIME.Replace("/", "_")
                FILETIME = FILETIME.Replace(":", "_")

                'Filename = FILETIME + "-" + "MRscan.txt"
                Filename = fileNum.ToString() + ".txt"
                Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Current", "Interval")
                For x = 0 To size - 1
                    objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceCurrent(x), MeasureInterval(x))
                Next
                objWriterTrans.Close()

                y = y + 1
                fileNum = fileNum + 1
                System.Threading.Thread.Sleep(10000)
            Loop

        Catch ex As NationalInstruments.NI4882.GpibException
            System.Threading.Thread.Sleep(10000)
            AbortAGI_CH1()
            System.Threading.Thread.Sleep(5000)
            AbortKEI_SM()
            System.Threading.Thread.Sleep(5000)
            AbortKEI_4200()
            System.Threading.Thread.Sleep(5000)

            Do Until y = 100
                x = 0
                Blocal = 0
                z = 0

                'KeiIniVM()                                      ''''''''''''''''''''''''initialize Keithley 4200 as a voltmeter
                KeiIniAM()    ''''''Ínitialize Keithley 4200 as Ampmeter

                'AbortAGI_CH2()
                AbortKEI_SM()
                System.Threading.Thread.Sleep(2000)
                Do Until z = 3
                    Blocal = B2_Reading() + Blocal
                    System.Threading.Thread.Sleep(3000)
                    z = z + 1
                Loop

                Blocal = -(Blocal / 3)

                Do Until x = size
                    designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                    x = x + 1
                Loop

                'ONAGI_CH2()
                ONKEI_SM()
                System.Threading.Thread.Sleep(1000)

                'Z_AGICH2(((0 + Blocal) / Kcoil))
                Z_KEI(((0 + Blocal) / Kcoil))


                System.Threading.Thread.Sleep(2000)


                ' DUT_AGICH1CURR(0.000002)  ''''''''source the device with 2uA constant current bias
                DUT_AGICH1VOLT(3.22)      ''''''''source the device with 3.15V constant voltage bias

                System.Threading.Thread.Sleep(600000)  '''''wait till the device enters single exponential decay region

                'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                Z_KEI(designedIcoil(0))

                System.Threading.Thread.Sleep(2000)

                x = 0
                Do Until x = size
                    Diff = 50
                    'Z_AGICH2(designedIcoil(x))
                    Z_KEI(designedIcoil(x))
                    System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                    Diffnum = 0
                    Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                        'Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                        Bnow = B2_Reading()
                        Diff = Math.Abs(Bnow - designedBfield(x))
                        System.Threading.Thread.Sleep(30)
                        Diffnum = Diffnum + 1
                        If Diffnum > 100 Then
                            If (Bnow - designedBfield(x)) > 0 Then
                                'Z_AGICH2(designedIcoil(x) - 0.00025)
                                Z_KEI(designedIcoil(x) - 0.00025)
                                System.Threading.Thread.Sleep(1000)
                            ElseIf (Bnow - designedBfield(x)) < 0 Then
                                'Z_AGICH2(designedIcoil(x) + 0.00025)
                                Z_KEI(designedIcoil(x) + 0.00025)
                                System.Threading.Thread.Sleep(1000)
                            End If
                        End If

                    Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                    newRealBfield(x) = Bnow
                    'newDeviceVoltage(x) = KeiVoltReading()
                    newDeviceCurrent(x) = KeiCurrReading()
                    currenttime = DateTime.Now()
                    MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                    x = x + 1
                Loop
                AbortAGI_CH1()

                AbortKEI_4200AM()

                'Z_AGICH2(((0 + Blocal) / Kcoil))
                Z_KEI(((0 + Blocal) / Kcoil))

                FILETIME = DateTime.Now.ToString()
                FILETIME = FILETIME.Replace("/", "_")
                FILETIME = FILETIME.Replace(":", "_")

                'Filename = FILETIME + "-" + "MRscan.txt"
                Filename = fileNum.ToString() + ".txt"
                Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Current", "Interval")
                For x = 0 To size - 1
                    objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceCurrent(x), MeasureInterval(x))
                Next
                objWriterTrans.Close()

                y = y + 1
                fileNum = fileNum + 1
                System.Threading.Thread.Sleep(10000)
            Loop

        Finally
            System.Threading.Thread.Sleep(5000)
            AbortAGI_CH1()
            System.Threading.Thread.Sleep(5000)
            AbortKEI_SM()
            System.Threading.Thread.Sleep(5000)
            Siglent_Abort()
        End Try




    End Sub

    Public Sub NewUltraMR26()                            '''''''''''''''''''''''''''''try catch solution / using keitley source meter /  constant device current / different device driving current ''''''STANDARD USMFE MEASUREMENT without MEL measurement
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer
        Dim currentlistnum As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single
        Dim devicecurrentlist() As Single
        Dim devicecurrentlistsize As Integer
        Dim Brev As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        currentlistnum = 0
        Brev = -1
        'Kcoil = 1806.67

        'Kcoil = 1800.163 '''''COIL Z
        'Kcoil = 1644.96 ''''''coil z / device current up
        'Kcoil = 1813.13  '''''COIL Z with Keithley source meter
        'Kcoil = 1613.055 ''''''COIL X
        Kcoil = 1584.1  '''''COIL Y
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -500, 0, -400, 0}
        'designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}

        ''''''''''ultra small field
        'designedBfield = New Single() {0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0}

        ''''small field
        'designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}
        designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}

        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, 500, 0, 500, 0, 500, 0, 500, 0, -500}


        '''''''''designedBfield = New Single() {0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}
        ''''''hysteresis 
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}

        'designedBfield = New Single() {0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0}

        '''''ultra small field
        'designedBfield = New Single() {0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0}

        ''''''large field 
        'designedBfield = New Single() {0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -400, 0, -300, 0, -200, 0, -100, 0, 0, 0, 100, 0, 200, 0, 300, 0, 400, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}

        '''''''large field + small field
        'designedBfield = New Single() {0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -480, 0, -460, 0, -440, 0, -420, 0, -400, 0, -380, 0, -360, 0, -340, 0, -320, 0, -300, 0, -280, 0, -260, 0, -240, 0, -220, 0, -200, 0, -180, 0, -160, 0, -140, 0, -120, 0, -100, 0, -80, 0, -60, 0, -40, 0, -20, 0, 0, 0, 20, 0, 40, 0, 60, 0, 80, 0, 100, 0, 120, 0, 140, 0, 160, 0, 180, 0, 200, 0, 220, 0, 240, 0, 260, 0, 280, 0, 300, 0, 320, 0, 340, 0, 360, 0, 380, 0, 400, 0, 420, 0, 440, 0, 460, 0, 480, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}


        'designedBfield = New Single() {0, -600, 0, -580, 0, -560, 0, -540, 0, -520, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 520, 0, 540, 0, 560, 0, 580, 0, 600, 0}

        devicecurrentlist = New Single() {0.000002}



        size = designedBfield.Length()
        devicecurrentlistsize = devicecurrentlist.Length()


        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        'KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        Do Until currentlistnum = devicecurrentlistsize

            If devicecurrentlist(currentlistnum) < 0.000001 Then
                y = 0
                fileNum = 0

                inittime = DateTime.Now()

                Try

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                End Try

            Else

                fileNum = 0
                y = 0

                inittime = DateTime.Now()

                Try

                    Do Until y = 100
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)


                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 100
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop
                End Try
            End If





            currentlistnum = currentlistnum + 1
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortKEI_SM()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()





    End Sub


    Public Sub test150818()                            '''''''''''''''''''''''''''''try catch solution / using keitley source meter /  constant device current / different device driving current ''''''STANDARD USMFE MEASUREMENT without MEL measurement
        
        Dim num As Integer
        Dim xx As Single

        KeiIniVM()

        Do Until num = 100
            DUT_AGICH1CURR(0.000002)
            System.Threading.Thread.Sleep(1000)
            xx = KeiVoltReading()
            AbortAGI_CH1()
            num = num + 1
        Loop
        
    End Sub


    Public Sub test170818()

        Dim currentlistnum() As Single
        Dim i, xx As Single
        Dim size As Integer
        Dim num As Integer

        currentlistnum = New Single() {0.000000002, 0.000000003, 0.000000004, 0.000000005, 0.000000006, 0.000000007, 0.000000008, 0.000000009, 0.00000001, 0.000000011, 0.000000012, 0.000000013, 0.000000014, 0.000000015, 0.000000016, 0.000000017, 0.000000018, 0.000000019, 0.00000002, 0.000000021, 0.000000022, 0.000000023, 0.000000024, 0.000000025, 0.000000026, 0.000000027, 0.000000028, 0.000000029, 0.00000003, 0.000000031, 0.000000032, 0.000000033, 0.000000034, 0.000000035, 0.000000036, 0.000000037, 0.000000038, 0.000000039, 0.00000004, 0.000000041, 0.000000042, 0.000000043, 0.000000044, 0.000000045, 0.000000046, 0.000000047, 0.000000048, 0.000000049, 0.00000005, 0.000000051, 0.000000052, 0.000000053, 0.000000054, 0.000000055, 0.000000056, 0.000000057, 0.000000058, 0.000000059, 0.00000006, 0.000000061, 0.000000062, 0.000000063, 0.000000064, 0.000000065, 0.000000066, 0.000000067, 0.000000068, 0.000000069, 0.00000007, 0.000000071, 0.000000072, 0.000000073, 0.000000074, 0.000000075, 0.000000076, 0.000000077, 0.000000078, 0.000000079, 0.00000008, 0.000000081, 0.000000082, 0.000000083, 0.000000084, 0.000000085, 0.000000086, 0.000000087, 0.000000088, 0.000000089, 0.00000009, 0.000000091, 0.000000092, 0.000000093, 0.000000094, 0.000000095, 0.000000096, 0.000000097, 0.000000098, 0.000000099, 0.0000001, 0.000000101, 0.000000102, 0.000000103, 0.000000104, 0.000000105, 0.000000106, 0.000000107, 0.000000108, 0.000000109, 0.00000011, 0.000000111, 0.000000112, 0.000000113, 0.000000114, 0.000000115, 0.000000116, 0.000000117, 0.000000118, 0.000000119, 0.00000012, 0.000000121, 0.000000122, 0.000000123, 0.000000124, 0.000000125, 0.000000126, 0.000000127, 0.000000128, 0.000000129, 0.00000013, 0.000000131, 0.000000132, 0.000000133, 0.000000134, 0.000000135, 0.000000136, 0.000000137, 0.000000138, 0.000000139, 0.00000014, 0.000000141, 0.000000142, 0.000000143, 0.000000144, 0.000000145, 0.000000146, 0.000000147, 0.000000148, 0.000000149, 0.00000015, 0.000000151, 0.000000152, 0.000000153, 0.000000154, 0.000000155, 0.000000156, 0.000000157, 0.000000158, 0.000000159, 0.00000016, 0.000000161, 0.000000162, 0.000000163, 0.000000164, 0.000000165, 0.000000166, 0.000000167, 0.000000168, 0.000000169, 0.00000017, 0.000000171, 0.000000172, 0.000000173, 0.000000174, 0.000000175, 0.000000176, 0.000000177, 0.000000178, 0.000000179, 0.00000018, 0.000000181, 0.000000182, 0.000000183, 0.000000184, 0.000000185, 0.000000186, 0.000000187, 0.000000188, 0.000000189, 0.00000019, 0.000000191, 0.000000192, 0.000000193, 0.000000194, 0.000000195, 0.000000196, 0.000000197, 0.000000198, 0.000000199, 0.0000002, 0.000000201, 0.000000202, 0.000000203, 0.000000204, 0.000000205, 0.000000206, 0.000000207, 0.000000208, 0.000000209, 0.00000021, 0.000000211, 0.000000212, 0.000000213, 0.000000214, 0.000000215, 0.000000216, 0.000000217, 0.000000218, 0.000000219, 0.00000022, 0.000000221, 0.000000222, 0.000000223, 0.000000224, 0.000000225, 0.000000226, 0.000000227, 0.000000228, 0.000000229, 0.00000023, 0.000000231, 0.000000232, 0.000000233, 0.000000234, 0.000000235, 0.000000236, 0.000000237, 0.000000238, 0.000000239, 0.00000024, 0.000000241, 0.000000242, 0.000000243, 0.000000244, 0.000000245, 0.000000246, 0.000000247, 0.000000248, 0.000000249, 0.00000025, 0.000000251, 0.000000252, 0.000000253, 0.000000254, 0.000000255, 0.000000256, 0.000000257, 0.000000258, 0.000000259, 0.00000026, 0.000000261, 0.000000262, 0.000000263, 0.000000264, 0.000000265, 0.000000266, 0.000000267, 0.000000268, 0.000000269, 0.00000027, 0.000000271, 0.000000272, 0.000000273, 0.000000274, 0.000000275, 0.000000276, 0.000000277, 0.000000278, 0.000000279, 0.00000028, 0.000000281, 0.000000282, 0.000000283, 0.000000284, 0.000000285, 0.000000286, 0.000000287, 0.000000288, 0.000000289, 0.00000029, 0.000000291, 0.000000292, 0.000000293, 0.000000294, 0.000000295, 0.000000296, 0.000000297, 0.000000298, 0.000000299, 0.0000003, 0.000000301, 0.000000302, 0.000000303, 0.000000304, 0.000000305, 0.000000306, 0.000000307, 0.000000308, 0.000000309, 0.00000031, 0.000000311, 0.000000312, 0.000000313, 0.000000314, 0.000000315, 0.000000316, 0.000000317, 0.000000318, 0.000000319, 0.00000032, 0.000000321, 0.000000322, 0.000000323, 0.000000324, 0.000000325, 0.000000326, 0.000000327, 0.000000328, 0.000000329, 0.00000033, 0.000000331, 0.000000332, 0.000000333, 0.000000334, 0.000000335, 0.000000336, 0.000000337, 0.000000338, 0.000000339, 0.00000034, 0.000000341, 0.000000342, 0.000000343, 0.000000344, 0.000000345, 0.000000346, 0.000000347, 0.000000348, 0.000000349, 0.00000035, 0.000000351, 0.000000352, 0.000000353, 0.000000354, 0.000000355, 0.000000356, 0.000000357, 0.000000358, 0.000000359, 0.00000036, 0.000000361, 0.000000362, 0.000000363, 0.000000364, 0.000000365, 0.000000366, 0.000000367, 0.000000368, 0.000000369, 0.00000037, 0.000000371, 0.000000372, 0.000000373, 0.000000374, 0.000000375, 0.000000376, 0.000000377, 0.000000378, 0.000000379, 0.00000038, 0.000000381, 0.000000382, 0.000000383, 0.000000384, 0.000000385, 0.000000386, 0.000000387, 0.000000388, 0.000000389, 0.00000039, 0.000000391, 0.000000392, 0.000000393, 0.000000394, 0.000000395, 0.000000396, 0.000000397, 0.000000398, 0.000000399, 0.0000004, 0.000000401, 0.000000402, 0.000000403, 0.000000404, 0.000000405, 0.000000406, 0.000000407, 0.000000408, 0.000000409, 0.00000041, 0.000000411, 0.000000412, 0.000000413, 0.000000414, 0.000000415, 0.000000416, 0.000000417, 0.000000418, 0.000000419, 0.00000042, 0.000000421, 0.000000422, 0.000000423, 0.000000424, 0.000000425, 0.000000426, 0.000000427, 0.000000428, 0.000000429, 0.00000043, 0.000000431, 0.000000432, 0.000000433, 0.000000434, 0.000000435, 0.000000436, 0.000000437, 0.000000438, 0.000000439, 0.00000044, 0.000000441, 0.000000442, 0.000000443, 0.000000444, 0.000000445, 0.000000446, 0.000000447, 0.000000448, 0.000000449, 0.00000045, 0.000000451, 0.000000452, 0.000000453, 0.000000454, 0.000000455, 0.000000456, 0.000000457, 0.000000458, 0.000000459, 0.00000046, 0.000000461, 0.000000462, 0.000000463, 0.000000464, 0.000000465, 0.000000466, 0.000000467, 0.000000468, 0.000000469, 0.00000047, 0.000000471, 0.000000472, 0.000000473, 0.000000474, 0.000000475, 0.000000476, 0.000000477, 0.000000478, 0.000000479, 0.00000048, 0.000000481, 0.000000482, 0.000000483, 0.000000484, 0.000000485, 0.000000486, 0.000000487, 0.000000488, 0.000000489, 0.00000049, 0.000000491, 0.000000492, 0.000000493, 0.000000494, 0.000000495, 0.000000496, 0.000000497, 0.000000498, 0.000000499, 0.0000005, 0.000000501, 0.000000502, 0.000000503, 0.000000504, 0.000000505, 0.000000506, 0.000000507, 0.000000508, 0.000000509, 0.00000051, 0.000000511, 0.000000512, 0.000000513, 0.000000514, 0.000000515, 0.000000516, 0.000000517, 0.000000518, 0.000000519, 0.00000052, 0.000000521, 0.000000522, 0.000000523, 0.000000524, 0.000000525, 0.000000526, 0.000000527, 0.000000528, 0.000000529, 0.00000053, 0.000000531, 0.000000532, 0.000000533, 0.000000534, 0.000000535, 0.000000536, 0.000000537, 0.000000538, 0.000000539, 0.00000054, 0.000000541, 0.000000542, 0.000000543, 0.000000544, 0.000000545, 0.000000546, 0.000000547, 0.000000548, 0.000000549, 0.00000055, 0.000000551, 0.000000552, 0.000000553, 0.000000554, 0.000000555, 0.000000556, 0.000000557, 0.000000558, 0.000000559, 0.00000056, 0.000000561, 0.000000562, 0.000000563, 0.000000564, 0.000000565, 0.000000566, 0.000000567, 0.000000568, 0.000000569, 0.00000057, 0.000000571, 0.000000572, 0.000000573, 0.000000574, 0.000000575, 0.000000576, 0.000000577, 0.000000578, 0.000000579, 0.00000058, 0.000000581, 0.000000582, 0.000000583, 0.000000584, 0.000000585, 0.000000586, 0.000000587, 0.000000588, 0.000000589, 0.00000059, 0.000000591, 0.000000592, 0.000000593, 0.000000594, 0.000000595, 0.000000596, 0.000000597, 0.000000598, 0.000000599, 0.0000006, 0.000000601, 0.000000602, 0.000000603, 0.000000604, 0.000000605, 0.000000606, 0.000000607, 0.000000608, 0.000000609, 0.00000061, 0.000000611, 0.000000612, 0.000000613, 0.000000614, 0.000000615, 0.000000616, 0.000000617, 0.000000618, 0.000000619, 0.00000062, 0.000000621, 0.000000622, 0.000000623, 0.000000624, 0.000000625, 0.000000626, 0.000000627, 0.000000628, 0.000000629, 0.00000063, 0.000000631, 0.000000632, 0.000000633, 0.000000634, 0.000000635, 0.000000636, 0.000000637, 0.000000638, 0.000000639, 0.00000064, 0.000000641, 0.000000642, 0.000000643, 0.000000644, 0.000000645, 0.000000646, 0.000000647, 0.000000648, 0.000000649, 0.00000065, 0.000000651, 0.000000652, 0.000000653, 0.000000654, 0.000000655, 0.000000656, 0.000000657, 0.000000658, 0.000000659, 0.00000066, 0.000000661, 0.000000662, 0.000000663, 0.000000664, 0.000000665, 0.000000666, 0.000000667, 0.000000668, 0.000000669, 0.00000067, 0.000000671, 0.000000672, 0.000000673, 0.000000674, 0.000000675, 0.000000676, 0.000000677, 0.000000678, 0.000000679, 0.00000068, 0.000000681, 0.000000682, 0.000000683, 0.000000684, 0.000000685, 0.000000686, 0.000000687, 0.000000688, 0.000000689, 0.00000069, 0.000000691, 0.000000692, 0.000000693, 0.000000694, 0.000000695, 0.000000696, 0.000000697, 0.000000698, 0.000000699, 0.0000007, 0.000000701, 0.000000702, 0.000000703, 0.000000704, 0.000000705, 0.000000706, 0.000000707, 0.000000708, 0.000000709, 0.00000071, 0.000000711, 0.000000712, 0.000000713, 0.000000714, 0.000000715, 0.000000716, 0.000000717, 0.000000718, 0.000000719, 0.00000072, 0.000000721, 0.000000722, 0.000000723, 0.000000724, 0.000000725, 0.000000726, 0.000000727, 0.000000728, 0.000000729, 0.00000073, 0.000000731, 0.000000732, 0.000000733, 0.000000734, 0.000000735, 0.000000736, 0.000000737, 0.000000738, 0.000000739, 0.00000074, 0.000000741, 0.000000742, 0.000000743, 0.000000744, 0.000000745, 0.000000746, 0.000000747, 0.000000748, 0.000000749, 0.00000075, 0.000000751, 0.000000752, 0.000000753, 0.000000754, 0.000000755, 0.000000756, 0.000000757, 0.000000758, 0.000000759, 0.00000076, 0.000000761, 0.000000762, 0.000000763, 0.000000764, 0.000000765, 0.000000766, 0.000000767, 0.000000768, 0.000000769, 0.00000077, 0.000000771, 0.000000772, 0.000000773, 0.000000774, 0.000000775, 0.000000776, 0.000000777, 0.000000778, 0.000000779, 0.00000078, 0.000000781, 0.000000782, 0.000000783, 0.000000784, 0.000000785, 0.000000786, 0.000000787, 0.000000788, 0.000000789, 0.00000079, 0.000000791, 0.000000792, 0.000000793, 0.000000794, 0.000000795, 0.000000796, 0.000000797, 0.000000798, 0.000000799, 0.0000008, 0.000000801, 0.000000802, 0.000000803, 0.000000804, 0.000000805, 0.000000806, 0.000000807, 0.000000808, 0.000000809, 0.00000081, 0.000000811, 0.000000812, 0.000000813, 0.000000814, 0.000000815, 0.000000816, 0.000000817, 0.000000818, 0.000000819, 0.00000082, 0.000000821, 0.000000822, 0.000000823, 0.000000824, 0.000000825, 0.000000826, 0.000000827, 0.000000828, 0.000000829, 0.00000083, 0.000000831, 0.000000832, 0.000000833, 0.000000834, 0.000000835, 0.000000836, 0.000000837, 0.000000838, 0.000000839, 0.00000084, 0.000000841, 0.000000842, 0.000000843, 0.000000844, 0.000000845, 0.000000846, 0.000000847, 0.000000848, 0.000000849, 0.00000085, 0.000000851, 0.000000852, 0.000000853, 0.000000854, 0.000000855, 0.000000856, 0.000000857, 0.000000858, 0.000000859, 0.00000086, 0.000000861, 0.000000862, 0.000000863, 0.000000864, 0.000000865, 0.000000866, 0.000000867, 0.000000868, 0.000000869, 0.00000087, 0.000000871, 0.000000872, 0.000000873, 0.000000874, 0.000000875, 0.000000876, 0.000000877, 0.000000878, 0.000000879, 0.00000088, 0.000000881, 0.000000882, 0.000000883, 0.000000884, 0.000000885, 0.000000886, 0.000000887, 0.000000888, 0.000000889, 0.00000089, 0.000000891, 0.000000892, 0.000000893, 0.000000894, 0.000000895, 0.000000896, 0.000000897, 0.000000898, 0.000000899, 0.0000009, 0.000000901, 0.000000902, 0.000000903, 0.000000904, 0.000000905, 0.000000906, 0.000000907, 0.000000908, 0.000000909, 0.00000091, 0.000000911, 0.000000912, 0.000000913, 0.000000914, 0.000000915, 0.000000916, 0.000000917, 0.000000918, 0.000000919, 0.00000092, 0.000000921, 0.000000922, 0.000000923, 0.000000924, 0.000000925, 0.000000926, 0.000000927, 0.000000928, 0.000000929, 0.00000093, 0.000000931, 0.000000932, 0.000000933, 0.000000934, 0.000000935, 0.000000936, 0.000000937, 0.000000938, 0.000000939, 0.00000094, 0.000000941, 0.000000942, 0.000000943, 0.000000944, 0.000000945, 0.000000946, 0.000000947, 0.000000948, 0.000000949, 0.00000095, 0.000000951, 0.000000952, 0.000000953, 0.000000954, 0.000000955, 0.000000956, 0.000000957, 0.000000958, 0.000000959, 0.00000096, 0.000000961, 0.000000962, 0.000000963, 0.000000964, 0.000000965, 0.000000966, 0.000000967, 0.000000968, 0.000000969, 0.00000097, 0.000000971, 0.000000972, 0.000000973, 0.000000974, 0.000000975, 0.000000976, 0.000000977, 0.000000978, 0.000000979, 0.00000098, 0.000000981, 0.000000982, 0.000000983, 0.000000984, 0.000000985, 0.000000986, 0.000000987, 0.000000988, 0.000000989, 0.00000099, 0.000000991, 0.000000992, 0.000000993, 0.000000994, 0.000000995, 0.000000996, 0.000000997, 0.000000998, 0.000000999, 0.000001, 0.000001001, 0.000001002, 0.000001003, 0.000001004, 0.000001005, 0.000001006, 0.000001007, 0.000001008, 0.000001009, 0.00000101, 0.000001011, 0.000001012, 0.000001013, 0.000001014, 0.000001015, 0.000001016, 0.000001017, 0.000001018, 0.000001019, 0.00000102, 0.000001021, 0.000001022, 0.000001023, 0.000001024, 0.000001025, 0.000001026, 0.000001027, 0.000001028, 0.000001029, 0.00000103, 0.000001031, 0.000001032, 0.000001033, 0.000001034, 0.000001035, 0.000001036, 0.000001037, 0.000001038, 0.000001039, 0.00000104, 0.000001041, 0.000001042, 0.000001043, 0.000001044, 0.000001045, 0.000001046, 0.000001047, 0.000001048, 0.000001049, 0.00000105, 0.000001051, 0.000001052, 0.000001053, 0.000001054, 0.000001055, 0.000001056, 0.000001057, 0.000001058, 0.000001059, 0.00000106, 0.000001061, 0.000001062, 0.000001063, 0.000001064, 0.000001065, 0.000001066, 0.000001067, 0.000001068, 0.000001069, 0.00000107, 0.000001071, 0.000001072, 0.000001073, 0.000001074, 0.000001075, 0.000001076, 0.000001077, 0.000001078, 0.000001079, 0.00000108, 0.000001081, 0.000001082, 0.000001083, 0.000001084, 0.000001085, 0.000001086, 0.000001087, 0.000001088, 0.000001089, 0.00000109, 0.000001091, 0.000001092, 0.000001093, 0.000001094, 0.000001095, 0.000001096, 0.000001097, 0.000001098, 0.000001099, 0.0000011, 0.000001101, 0.000001102, 0.000001103, 0.000001104, 0.000001105, 0.000001106, 0.000001107, 0.000001108, 0.000001109, 0.00000111, 0.000001111, 0.000001112, 0.000001113, 0.000001114, 0.000001115, 0.000001116, 0.000001117, 0.000001118, 0.000001119, 0.00000112, 0.000001121, 0.000001122, 0.000001123, 0.000001124, 0.000001125, 0.000001126, 0.000001127, 0.000001128, 0.000001129, 0.00000113, 0.000001131, 0.000001132, 0.000001133, 0.000001134, 0.000001135, 0.000001136, 0.000001137, 0.000001138, 0.000001139, 0.00000114, 0.000001141, 0.000001142, 0.000001143, 0.000001144, 0.000001145, 0.000001146, 0.000001147, 0.000001148, 0.000001149, 0.00000115, 0.000001151, 0.000001152, 0.000001153, 0.000001154, 0.000001155, 0.000001156, 0.000001157, 0.000001158, 0.000001159, 0.00000116, 0.000001161, 0.000001162, 0.000001163, 0.000001164, 0.000001165, 0.000001166, 0.000001167, 0.000001168, 0.000001169, 0.00000117, 0.000001171, 0.000001172, 0.000001173, 0.000001174, 0.000001175, 0.000001176, 0.000001177, 0.000001178, 0.000001179, 0.00000118, 0.000001181, 0.000001182, 0.000001183, 0.000001184, 0.000001185, 0.000001186, 0.000001187, 0.000001188, 0.000001189, 0.00000119, 0.000001191, 0.000001192, 0.000001193, 0.000001194, 0.000001195, 0.000001196, 0.000001197, 0.000001198, 0.000001199, 0.0000012, 0.000001201, 0.000001202, 0.000001203, 0.000001204, 0.000001205, 0.000001206, 0.000001207, 0.000001208, 0.000001209, 0.00000121, 0.000001211, 0.000001212, 0.000001213, 0.000001214, 0.000001215, 0.000001216, 0.000001217, 0.000001218, 0.000001219, 0.00000122, 0.000001221, 0.000001222, 0.000001223, 0.000001224, 0.000001225, 0.000001226, 0.000001227, 0.000001228, 0.000001229, 0.00000123, 0.000001231, 0.000001232, 0.000001233, 0.000001234, 0.000001235, 0.000001236, 0.000001237, 0.000001238, 0.000001239, 0.00000124, 0.000001241, 0.000001242, 0.000001243, 0.000001244, 0.000001245, 0.000001246, 0.000001247, 0.000001248, 0.000001249, 0.00000125, 0.000001251, 0.000001252, 0.000001253, 0.000001254, 0.000001255, 0.000001256, 0.000001257, 0.000001258, 0.000001259, 0.00000126, 0.000001261, 0.000001262, 0.000001263, 0.000001264, 0.000001265, 0.000001266, 0.000001267, 0.000001268, 0.000001269, 0.00000127, 0.000001271, 0.000001272, 0.000001273, 0.000001274, 0.000001275, 0.000001276, 0.000001277, 0.000001278, 0.000001279, 0.00000128, 0.000001281, 0.000001282, 0.000001283, 0.000001284, 0.000001285, 0.000001286, 0.000001287, 0.000001288, 0.000001289, 0.00000129, 0.000001291, 0.000001292, 0.000001293, 0.000001294, 0.000001295, 0.000001296, 0.000001297, 0.000001298, 0.000001299, 0.0000013, 0.000001301, 0.000001302, 0.000001303, 0.000001304, 0.000001305, 0.000001306, 0.000001307, 0.000001308, 0.000001309, 0.00000131, 0.000001311, 0.000001312, 0.000001313, 0.000001314, 0.000001315, 0.000001316, 0.000001317, 0.000001318, 0.000001319, 0.00000132, 0.000001321, 0.000001322, 0.000001323, 0.000001324, 0.000001325, 0.000001326, 0.000001327, 0.000001328, 0.000001329, 0.00000133, 0.000001331, 0.000001332, 0.000001333, 0.000001334, 0.000001335, 0.000001336, 0.000001337, 0.000001338, 0.000001339, 0.00000134, 0.000001341, 0.000001342, 0.000001343, 0.000001344, 0.000001345, 0.000001346, 0.000001347, 0.000001348, 0.000001349, 0.00000135, 0.000001351, 0.000001352, 0.000001353, 0.000001354, 0.000001355, 0.000001356, 0.000001357, 0.000001358, 0.000001359, 0.00000136, 0.000001361, 0.000001362, 0.000001363, 0.000001364, 0.000001365, 0.000001366, 0.000001367, 0.000001368, 0.000001369, 0.00000137, 0.000001371, 0.000001372, 0.000001373, 0.000001374, 0.000001375, 0.000001376, 0.000001377, 0.000001378, 0.000001379, 0.00000138, 0.000001381, 0.000001382, 0.000001383, 0.000001384, 0.000001385, 0.000001386, 0.000001387, 0.000001388, 0.000001389, 0.00000139, 0.000001391, 0.000001392, 0.000001393, 0.000001394, 0.000001395, 0.000001396, 0.000001397, 0.000001398, 0.000001399, 0.0000014, 0.000001401, 0.000001402, 0.000001403, 0.000001404, 0.000001405, 0.000001406, 0.000001407, 0.000001408, 0.000001409, 0.00000141, 0.000001411, 0.000001412, 0.000001413, 0.000001414, 0.000001415, 0.000001416, 0.000001417, 0.000001418, 0.000001419, 0.00000142, 0.000001421, 0.000001422, 0.000001423, 0.000001424, 0.000001425, 0.000001426, 0.000001427, 0.000001428, 0.000001429, 0.00000143, 0.000001431, 0.000001432, 0.000001433, 0.000001434, 0.000001435, 0.000001436, 0.000001437, 0.000001438, 0.000001439, 0.00000144, 0.000001441, 0.000001442, 0.000001443, 0.000001444, 0.000001445, 0.000001446, 0.000001447, 0.000001448, 0.000001449, 0.00000145, 0.000001451, 0.000001452, 0.000001453, 0.000001454, 0.000001455, 0.000001456, 0.000001457, 0.000001458, 0.000001459, 0.00000146, 0.000001461, 0.000001462, 0.000001463, 0.000001464, 0.000001465, 0.000001466, 0.000001467, 0.000001468, 0.000001469, 0.00000147, 0.000001471, 0.000001472, 0.000001473, 0.000001474, 0.000001475, 0.000001476, 0.000001477, 0.000001478, 0.000001479, 0.00000148, 0.000001481, 0.000001482, 0.000001483, 0.000001484, 0.000001485, 0.000001486, 0.000001487, 0.000001488, 0.000001489, 0.00000149, 0.000001491, 0.000001492, 0.000001493, 0.000001494, 0.000001495, 0.000001496, 0.000001497, 0.000001498, 0.000001499, 0.0000015, 0.000001501, 0.000001502, 0.000001503, 0.000001504, 0.000001505, 0.000001506, 0.000001507, 0.000001508, 0.000001509, 0.00000151, 0.000001511, 0.000001512, 0.000001513, 0.000001514, 0.000001515, 0.000001516, 0.000001517, 0.000001518, 0.000001519, 0.00000152, 0.000001521, 0.000001522, 0.000001523, 0.000001524, 0.000001525, 0.000001526, 0.000001527, 0.000001528, 0.000001529, 0.00000153, 0.000001531, 0.000001532, 0.000001533, 0.000001534, 0.000001535, 0.000001536, 0.000001537, 0.000001538, 0.000001539, 0.00000154, 0.000001541, 0.000001542, 0.000001543, 0.000001544, 0.000001545, 0.000001546, 0.000001547, 0.000001548, 0.000001549, 0.00000155, 0.000001551, 0.000001552, 0.000001553, 0.000001554, 0.000001555, 0.000001556, 0.000001557, 0.000001558, 0.000001559, 0.00000156, 0.000001561, 0.000001562, 0.000001563, 0.000001564, 0.000001565, 0.000001566, 0.000001567, 0.000001568, 0.000001569, 0.00000157, 0.000001571, 0.000001572, 0.000001573, 0.000001574, 0.000001575, 0.000001576, 0.000001577, 0.000001578, 0.000001579, 0.00000158, 0.000001581, 0.000001582, 0.000001583, 0.000001584, 0.000001585, 0.000001586, 0.000001587, 0.000001588, 0.000001589, 0.00000159, 0.000001591, 0.000001592, 0.000001593, 0.000001594, 0.000001595, 0.000001596, 0.000001597, 0.000001598, 0.000001599, 0.0000016, 0.000001601, 0.000001602, 0.000001603, 0.000001604, 0.000001605, 0.000001606, 0.000001607, 0.000001608, 0.000001609, 0.00000161, 0.000001611, 0.000001612, 0.000001613, 0.000001614, 0.000001615, 0.000001616, 0.000001617, 0.000001618, 0.000001619, 0.00000162, 0.000001621, 0.000001622, 0.000001623, 0.000001624, 0.000001625, 0.000001626, 0.000001627, 0.000001628, 0.000001629, 0.00000163, 0.000001631, 0.000001632, 0.000001633, 0.000001634, 0.000001635, 0.000001636, 0.000001637, 0.000001638, 0.000001639, 0.00000164, 0.000001641, 0.000001642, 0.000001643, 0.000001644, 0.000001645, 0.000001646, 0.000001647, 0.000001648, 0.000001649, 0.00000165, 0.000001651, 0.000001652, 0.000001653, 0.000001654, 0.000001655, 0.000001656, 0.000001657, 0.000001658, 0.000001659, 0.00000166, 0.000001661, 0.000001662, 0.000001663, 0.000001664, 0.000001665, 0.000001666, 0.000001667, 0.000001668, 0.000001669, 0.00000167, 0.000001671, 0.000001672, 0.000001673, 0.000001674, 0.000001675, 0.000001676, 0.000001677, 0.000001678, 0.000001679, 0.00000168, 0.000001681, 0.000001682, 0.000001683, 0.000001684, 0.000001685, 0.000001686, 0.000001687, 0.000001688, 0.000001689, 0.00000169, 0.000001691, 0.000001692, 0.000001693, 0.000001694, 0.000001695, 0.000001696, 0.000001697, 0.000001698, 0.000001699, 0.0000017, 0.000001701, 0.000001702, 0.000001703, 0.000001704, 0.000001705, 0.000001706, 0.000001707, 0.000001708, 0.000001709, 0.00000171, 0.000001711, 0.000001712, 0.000001713, 0.000001714, 0.000001715, 0.000001716, 0.000001717, 0.000001718, 0.000001719, 0.00000172, 0.000001721, 0.000001722, 0.000001723, 0.000001724, 0.000001725, 0.000001726, 0.000001727, 0.000001728, 0.000001729, 0.00000173, 0.000001731, 0.000001732, 0.000001733, 0.000001734, 0.000001735, 0.000001736, 0.000001737, 0.000001738, 0.000001739, 0.00000174, 0.000001741, 0.000001742, 0.000001743, 0.000001744, 0.000001745, 0.000001746, 0.000001747, 0.000001748, 0.000001749, 0.00000175, 0.000001751, 0.000001752, 0.000001753, 0.000001754, 0.000001755, 0.000001756, 0.000001757, 0.000001758, 0.000001759, 0.00000176, 0.000001761, 0.000001762, 0.000001763, 0.000001764, 0.000001765, 0.000001766, 0.000001767, 0.000001768, 0.000001769, 0.00000177, 0.000001771, 0.000001772, 0.000001773, 0.000001774, 0.000001775, 0.000001776, 0.000001777, 0.000001778, 0.000001779, 0.00000178, 0.000001781, 0.000001782, 0.000001783, 0.000001784, 0.000001785, 0.000001786, 0.000001787, 0.000001788, 0.000001789, 0.00000179, 0.000001791, 0.000001792, 0.000001793, 0.000001794, 0.000001795, 0.000001796, 0.000001797, 0.000001798, 0.000001799, 0.0000018, 0.000001801, 0.000001802, 0.000001803, 0.000001804, 0.000001805, 0.000001806, 0.000001807, 0.000001808, 0.000001809, 0.00000181, 0.000001811, 0.000001812, 0.000001813, 0.000001814, 0.000001815, 0.000001816, 0.000001817, 0.000001818, 0.000001819, 0.00000182, 0.000001821, 0.000001822, 0.000001823, 0.000001824, 0.000001825, 0.000001826, 0.000001827, 0.000001828, 0.000001829, 0.00000183, 0.000001831, 0.000001832, 0.000001833, 0.000001834, 0.000001835, 0.000001836, 0.000001837, 0.000001838, 0.000001839, 0.00000184, 0.000001841, 0.000001842, 0.000001843, 0.000001844, 0.000001845, 0.000001846, 0.000001847, 0.000001848, 0.000001849, 0.00000185, 0.000001851, 0.000001852, 0.000001853, 0.000001854, 0.000001855, 0.000001856, 0.000001857, 0.000001858, 0.000001859, 0.00000186, 0.000001861, 0.000001862, 0.000001863, 0.000001864, 0.000001865, 0.000001866, 0.000001867, 0.000001868, 0.000001869, 0.00000187, 0.000001871, 0.000001872, 0.000001873, 0.000001874, 0.000001875, 0.000001876, 0.000001877, 0.000001878, 0.000001879, 0.00000188, 0.000001881, 0.000001882, 0.000001883, 0.000001884, 0.000001885, 0.000001886, 0.000001887, 0.000001888, 0.000001889, 0.00000189, 0.000001891, 0.000001892, 0.000001893, 0.000001894, 0.000001895, 0.000001896, 0.000001897, 0.000001898, 0.000001899, 0.0000019, 0.000001901, 0.000001902, 0.000001903, 0.000001904, 0.000001905, 0.000001906, 0.000001907, 0.000001908, 0.000001909, 0.00000191, 0.000001911, 0.000001912, 0.000001913, 0.000001914, 0.000001915, 0.000001916, 0.000001917, 0.000001918, 0.000001919, 0.00000192, 0.000001921, 0.000001922, 0.000001923, 0.000001924, 0.000001925, 0.000001926, 0.000001927, 0.000001928, 0.000001929, 0.00000193, 0.000001931, 0.000001932, 0.000001933, 0.000001934, 0.000001935, 0.000001936, 0.000001937, 0.000001938, 0.000001939, 0.00000194, 0.000001941, 0.000001942, 0.000001943, 0.000001944, 0.000001945, 0.000001946, 0.000001947, 0.000001948, 0.000001949, 0.00000195, 0.000001951, 0.000001952, 0.000001953, 0.000001954, 0.000001955, 0.000001956, 0.000001957, 0.000001958, 0.000001959, 0.00000196, 0.000001961, 0.000001962, 0.000001963, 0.000001964, 0.000001965, 0.000001966, 0.000001967, 0.000001968, 0.000001969, 0.00000197, 0.000001971, 0.000001972, 0.000001973, 0.000001974, 0.000001975, 0.000001976, 0.000001977, 0.000001978, 0.000001979, 0.00000198, 0.000001981, 0.000001982, 0.000001983, 0.000001984, 0.000001985, 0.000001986, 0.000001987, 0.000001988, 0.000001989, 0.00000199, 0.000001991, 0.000001992, 0.000001993, 0.000001994, 0.000001995, 0.000001996, 0.000001997, 0.000001998, 0.000001999, 0.000002}

        size = currentlistnum.Length()

        KeiIniVM()
        i = 0

        Do Until i = size
            DUT_AGICH1CURR(currentlistnum(i))
            num = 0
            Do Until num = 20
                xx = KeiVoltReading()
                num = num + 1
            Loop
            i = i + 1
        Loop

        AbortAGI_CH1()

    End Sub

    Public Sub fre()

        Dim ioMgr As Ivi.Visa.Interop.ResourceManager
        Dim instrument As Ivi.Visa.Interop.FormattedIO488
        Dim idn As String

        ioMgr = New Ivi.Visa.Interop.ResourceManager
        instrument = New Ivi.Visa.Interop.FormattedIO488

        instrument.IO = ioMgr.Open("ASRL4::INSTR")

        instrument.WriteString("FREQ 1000000")

        instrument.IO.Close()


    End Sub

    Public Sub NewUltraMR27()                            ''''''''''''''''''''''''''''With pulse generator in / AC coil in
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer
        Dim currentlistnum As Integer

        Dim newDeviceVoltage(,) As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield(,) As Single

        Dim MeasureInterval(,) As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single
        Dim devicecurrentlist() As Single
        Dim devicecurrentlistsize As Integer
        Dim Brev As Single

        Dim designedFreq() As Single
        Dim xx As Integer
        Dim sizefreq As Integer


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        currentlistnum = 0
        Brev = -1
        'Kcoil = 1806.67

        'Kcoil = 1800.163 '''''COIL Z
        'Kcoil = 1644.96 ''''''coil z / device current up
        Kcoil = 1813.13  '''''COIL Z with Keithley source meter
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -500, 0, -400, 0}
        'designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}

        ''''''''''ultra small field
        'designedBfield = New Single() {0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0}

        ''''small field
        'designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}
        designedBfield = New Single() {0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0}
        'designedBfield = New Single() {0, -290, 0, -290, 0, -290, 0, -290, 0, -290, 0, -290, 0, -290, 0, -290, 0, -290, 0, -290, 0, -290, 0, -290, 0, -280, 0, -270, 0, -260, 0, 260, 0, 270, 0, 280, 0, 290, 0}
        'designedBfield = New Single() {0, -500, 0, 200, 0, 500, 0}


        '''''''''designedBfield = New Single() {0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}
        ''''''hysteresis 
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}

        'designedBfield = New Single() {0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0}

        '''''ultra small field
        'designedBfield = New Single() {0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0}

        ''''''large field 
        'designedBfield = New Single() {0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -400, 0, -300, 0, -200, 0, -100, 0, 0, 0, 100, 0, 200, 0, 300, 0, 400, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}

        '''''''large field + small field
        'designedBfield = New Single() {0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -480, 0, -460, 0, -440, 0, -420, 0, -400, 0, -380, 0, -360, 0, -340, 0, -320, 0, -300, 0, -280, 0, -260, 0, -240, 0, -220, 0, -200, 0, -180, 0, -160, 0, -140, 0, -120, 0, -100, 0, -80, 0, -60, 0, -40, 0, -20, 0, 0, 0, 20, 0, 40, 0, 60, 0, 80, 0, 100, 0, 120, 0, 140, 0, 160, 0, 180, 0, 200, 0, 220, 0, 240, 0, 260, 0, 280, 0, 300, 0, 320, 0, 340, 0, 360, 0, 380, 0, 400, 0, 420, 0, 440, 0, 460, 0, 480, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}


        'designedBfield = New Single() {0, -600, 0, -580, 0, -560, 0, -540, 0, -520, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 520, 0, 540, 0, 560, 0, 580, 0, 600, 0}

        'designedFreq = {10, 50, 75, 100, 170, 250, 350, 500, 600, 750, 1000, 1500, 2500, 5000, 6500, 7500, 10000, 15000, 25000, 50000, 75000, 100000, 150000, 250000, 500000, 750000, 1000000, 2500000, 5000000, 10000000, 25000000, 50000000} '32 frequencies
        designedFreq = {10, 100, 1000} '3 frequencies


        'designedFreq = {10, 500, 1000000}

        devicecurrentlist = New Single() {0.000002}



        size = designedBfield.Length()
        devicecurrentlistsize = devicecurrentlist.Length()
        sizefreq = designedFreq.Length()


        newDeviceVoltage = New Single(size, sizefreq) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size, sizefreq) {}
        MeasureInterval = New Single(size, sizefreq) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        'KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        Do Until currentlistnum = devicecurrentlistsize

            If devicecurrentlist(currentlistnum) < 0.000001 Then
                y = 0
                fileNum = 0

                inittime = DateTime.Now()

                Try

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x, xx) = Bnow
                            newDeviceVoltage(x, xx) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x, xx) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x, xx), newDeviceVoltage(x, xx), MeasureInterval(x, xx))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x, xx) = Bnow
                            newDeviceVoltage(x, xx) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x, xx) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x, xx), newDeviceVoltage(x, xx), MeasureInterval(x, xx))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                End Try

            Else

                fileNum = 0
                y = 0

                inittime = DateTime.Now()

                Try

                    Do Until y = 100
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)

                        Set_Pulse_Generator()
                        System.Threading.Thread.Sleep(2000)

                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)


                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))




                        System.Threading.Thread.Sleep(2000)

                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        xx = 0

                        Do Until xx = sizefreq

                            FRE_PulseGenerator(designedFreq(xx))

                            System.Threading.Thread.Sleep(1000)

                            x = 0
                            Do Until x = size
                                Diff = 50
                                'Z_AGICH2(designedIcoil(x))
                                Z_KEI(designedIcoil(x))
                                System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                                Diffnum = 0
                                'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                                Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                    Bnow = B2_Reading()
                                    Diff = Math.Abs(Bnow - designedBfield(x))
                                    System.Threading.Thread.Sleep(30)
                                    Diffnum = Diffnum + 1
                                    If Diffnum > 100 Then
                                        If (Bnow - designedBfield(x)) > 0 Then
                                            'Z_AGICH2(designedIcoil(x) - 0.00025)
                                            Z_KEI(designedIcoil(x) - 0.00025)
                                            System.Threading.Thread.Sleep(1000)
                                        ElseIf (Bnow - designedBfield(x)) < 0 Then
                                            'Z_AGICH2(designedIcoil(x) + 0.00025)
                                            Z_KEI(designedIcoil(x) + 0.00025)
                                            System.Threading.Thread.Sleep(1000)
                                        End If
                                    End If

                                Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                                newRealBfield(x, xx) = Bnow
                                newDeviceVoltage(x, xx) = KeiVoltReading()
                                currenttime = DateTime.Now()
                                MeasureInterval(x, xx) = TTimeSpan(currenttime, inittime)
                                x = x + 1
                            Loop

                            xx = xx + 1
                        Loop


                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        PG_OFF()

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"


                        'Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        'Dim LineFormatTrans As String = "{0,-16:E}{1,-16:E}{2,-16:E}{3,-16:E}{4,-16:E}{5,-16:E}{6,-16:E}{7,-16:E}{8,-16:E}{9,-16:E}{10,-16:E}{11,-16:E}{12,-16:E}{13,-16:E}{14,-16:E}{15,-16:E}{16,-16:E}{17,-16:E}{18,-16:E}{19,-16:E}{20,-16:E}{21,-16:E}{22,-16:E}{23,-16:E}{24,-16:E}{25,-16:E}{26,-16:E}{27,-16:E}{28,-16:E}{29,-16:E}{30,-16:E}{31,-16:E}"
                        'objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}{4,-16}{5,-16}{6,-16}{7,-16}{8,-16}{9,-16}{10,-16}{11,-16}{12,-16}{13,-16}{14,-16}{15,-16}{16,-16}{17,-16}{18,-16}{19,-16}{20,-16}{21,-16}{22,-16}{23,-16}{24,-16}{25,-16}{26,-16}{27,-16}{28,-16}{29,-16}{30,-16}{31,-16}", "10Hz", "50Hz", "75Hz", "100Hz", "170Hz", "250Hz", "350Hz", "500Hz", "600Hz", "750Hz", "1000Hz", "1500Hz", "2500Hz", "5000Hz", "6500Hz", "7500Hz", "10kHz", "15kHz", "25kHz", "50kHz", "75kHz", "100kHz", "150kHz", "250kHz", "500kHz", "750kHz", "1MHz", "2.5MHz", "5MHz", "10MHz", "25MHz", "50MHz")
                        'For x = 0 To size - 1
                        'objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x, 0), newRealBfield(x, 1), newRealBfield(x, 2), newRealBfield(x, 3), newRealBfield(x, 4), newRealBfield(x, 5), newRealBfield(x, 6), newRealBfield(x, 7), newRealBfield(x, 8), newRealBfield(x, 9), newRealBfield(x, 10), newRealBfield(x, 11), newRealBfield(x, 12), newRealBfield(x, 13), newRealBfield(x, 14), newRealBfield(x, 15), newRealBfield(x, 16), newRealBfield(x, 17), newRealBfield(x, 18), newRealBfield(x, 19), newRealBfield(x, 20), newRealBfield(x, 21), newRealBfield(x, 22), newRealBfield(x, 23), newRealBfield(x, 24), newRealBfield(x, 25), newRealBfield(x, 26), newRealBfield(x, 27), newRealBfield(x, 28), newRealBfield(x, 29), newRealBfield(x, 30), newRealBfield(x, 31), newRealBfield(x, 32))
                        'Next
                        'objWriterTrans.Close()

                        'Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A B field-" + fileNum.ToString() + ".txt"

                        ' Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        ' Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}{3,-16:E}{4,-16:E}{5,-16:E}{6,-16:E}{7,-16:E}{8,-16:E}{9,-16:E}{10,-16:E}{11,-16:E}{12,-16:E}{13,-16:E}{14,-16:E}{15,-16:E}{16,-16:E}{17,-16:E}{18,-16:E}{19,-16:E}{20,-16:E}{21,-16:E}{22,-16:E}{23,-16:E}{24,-16:E}{25,-16:E}{26,-16:E}{27,-16:E}{28,-16:E}{29,-16:E}{30,-16:E}{31,-16:E}"
                        ' objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}{4,-16}{5,-16}{6,-16}{7,-16}{8,-16}{9,-16}{10,-16}{11,-16}{12,-16}{13,-16}{14,-16}{15,-16}{16,-16}{17,-16}{18,-16}{19,-16}{20,-16}{21,-16}{22,-16}{23,-16}{24,-16}{25,-16}{26,-16}{27,-16}{28,-16}{29,-16}{30,-16}{31,-16}", "10Hz", "50Hz", "75Hz", "100Hz", "170Hz", "250Hz", "350Hz", "500Hz", "600Hz", "750Hz", "1000Hz", "1500Hz", "2500Hz", "5000Hz", "6500Hz", "7500Hz", "10kHz", "15kHz", "25kHz", "50kHz", "75kHz", "100kHz", "150kHz", "250kHz", "500kHz", "750kHz", "1MHz", "2.5MHz", "5MHz", "10MHz", "25MHz", "50MHz")
                        ' For x = 0 To size - 1
                        'objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x, 0), newRealBfield(x, 1), newRealBfield(x, 2), newRealBfield(x, 3), newRealBfield(x, 4), newRealBfield(x, 5), newRealBfield(x, 6), newRealBfield(x, 7), newRealBfield(x, 8), newRealBfield(x, 9), newRealBfield(x, 10), newRealBfield(x, 11), newRealBfield(x, 12), newRealBfield(x, 13), newRealBfield(x, 14), newRealBfield(x, 15), newRealBfield(x, 16), newRealBfield(x, 17), newRealBfield(x, 18), newRealBfield(x, 19), newRealBfield(x, 20), newRealBfield(x, 21), newRealBfield(x, 22), newRealBfield(x, 23), newRealBfield(x, 24), newRealBfield(x, 25), newRealBfield(x, 26), newRealBfield(x, 27), newRealBfield(x, 28), newRealBfield(x, 29), newRealBfield(x, 30), newRealBfield(x, 31))
                        'Next
                        ' objWriterTrans.Close()


                        'Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A Device voltage-" + fileNum.ToString() + ".txt"

                        ' Dim objWriterTrans1 As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        ' Dim LineFormatTrans1 As String = "{0,-10}{1,-16:E}{2,-16:E}{3,-16:E}{4,-16:E}{5,-16:E}{6,-16:E}{7,-16:E}{8,-16:E}{9,-16:E}{10,-16:E}{11,-16:E}{12,-16:E}{13,-16:E}{14,-16:E}{15,-16:E}{16,-16:E}{17,-16:E}{18,-16:E}{19,-16:E}{20,-16:E}{21,-16:E}{22,-16:E}{23,-16:E}{24,-16:E}{25,-16:E}{26,-16:E}{27,-16:E}{28,-16:E}{29,-16:E}{30,-16:E}{31,-16:E}"
                        ' objWriterTrans1.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}{4,-16}{5,-16}{6,-16}{7,-16}{8,-16}{9,-16}{10,-16}{11,-16}{12,-16}{13,-16}{14,-16}{15,-16}{16,-16}{17,-16}{18,-16}{19,-16}{20,-16}{21,-16}{22,-16}{23,-16}{24,-16}{25,-16}{26,-16}{27,-16}{28,-16}{29,-16}{30,-16}{31,-16}", "10Hz", "50Hz", "75Hz", "100Hz", "170Hz", "250Hz", "350Hz", "500Hz", "600Hz", "750Hz", "1000Hz", "1500Hz", "2500Hz", "5000Hz", "6500Hz", "7500Hz", "10kHz", "15kHz", "25kHz", "50kHz", "75kHz", "100kHz", "150kHz", "250kHz", "500kHz", "750kHz", "1MHz", "2.5MHz", "5MHz", "10MHz", "25MHz", "50MHz")
                        ' For x = 0 To size - 1
                        'objWriterTrans1.WriteLine(LineFormatTrans1, newDeviceVoltage(x, 0), newDeviceVoltage(x, 1), newDeviceVoltage(x, 2), newDeviceVoltage(x, 3), newDeviceVoltage(x, 4), newDeviceVoltage(x, 5), newDeviceVoltage(x, 6), newDeviceVoltage(x, 7), newDeviceVoltage(x, 8), newDeviceVoltage(x, 9), newDeviceVoltage(x, 10), newDeviceVoltage(x, 11), newDeviceVoltage(x, 12), newDeviceVoltage(x, 13), newDeviceVoltage(x, 14), newDeviceVoltage(x, 15), newDeviceVoltage(x, 16), newDeviceVoltage(x, 17), newDeviceVoltage(x, 18), newDeviceVoltage(x, 19), newDeviceVoltage(x, 20), newDeviceVoltage(x, 21), newDeviceVoltage(x, 22), newDeviceVoltage(x, 23), newDeviceVoltage(x, 24), newDeviceVoltage(x, 25), newDeviceVoltage(x, 26), newDeviceVoltage(x, 27), newDeviceVoltage(x, 28), newDeviceVoltage(x, 29), newDeviceVoltage(x, 30), newDeviceVoltage(x, 31))
                        ' Next
                        ' objWriterTrans1.Close()


                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A B field-" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "10Hz", "100Hz", "1000Hz")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x, 0), newRealBfield(x, 1), newRealBfield(x, 2))
                        Next
                        objWriterTrans.Close()


                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A Device voltage-" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans1 As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans1 As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans1.WriteLine("{0,-10}{1,-16}{2,-16}", "10Hz", "100Hz", "1000Hz")
                        For x = 0 To size - 1
                            objWriterTrans1.WriteLine(LineFormatTrans1, newDeviceVoltage(x, 0), newDeviceVoltage(x, 1), newDeviceVoltage(x, 2))
                        Next
                        objWriterTrans1.Close()



                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 200
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x, xx) = Bnow
                            newDeviceVoltage(x, xx) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x, xx) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A Device voltage-" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans1 As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans1 As String = "{0,-10}{1,-16:E}{2,-16:E}{3,-16:E}{4,-16:E}{5,-16:E}{6,-16:E}{7,-16:E}{8,-16:E}{9,-16:E}{10,-16:E}"
                        objWriterTrans1.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}{4,-16}{5,-16}{6,-16}{7,-16}{8,-16}{9,-16}{10,-16}", "10Hz", "50Hz", "75Hz", "100Hz", "170Hz", "250Hz", "350Hz", "500Hz", "600Hz", "750Hz", "1000Hz")
                        For x = 0 To size - 1
                            objWriterTrans1.WriteLine(LineFormatTrans1, newDeviceVoltage(x, 0), newDeviceVoltage(x, 1), newDeviceVoltage(x, 2), newDeviceVoltage(x, 3), newDeviceVoltage(x, 4), newDeviceVoltage(x, 5), newDeviceVoltage(x, 6), newDeviceVoltage(x, 7), newDeviceVoltage(x, 8), newDeviceVoltage(x, 9), newDeviceVoltage(x, 10))
                        Next
                        objWriterTrans1.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop
                End Try
            End If


            currentlistnum = currentlistnum + 1

        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortKEI_SM()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()
        System.Threading.Thread.Sleep(5000)
        PG_OFF()

    End Sub


    Public Sub NewUltraMR28()                            '''''''''''''''''''''''''''''try catch solution / using keitley source meter /  constant device current / different device driving current 
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer
        Dim currentlistnum As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single
        Dim devicecurrentlist() As Single
        Dim devicecurrentlistsize As Integer
        Dim Brev As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        currentlistnum = 0
        Brev = -1
        'Kcoil = 1806.67

        'Kcoil = 1800.163 '''''COIL Z
        'Kcoil = 1644.96 ''''''coil z / device current up
        Kcoil = 1813.13  '''''COIL Z with Keithley source meter
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -500, 0, -400, 0}
        'designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}

        ''''''''''ultra small field
        'designedBfield = New Single() {0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0}

        ''''small field
        'designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}
        designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}

        '''''''''designedBfield = New Single() {0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}
        ''''''hysteresis 
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}

        'designedBfield = New Single() {0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0}

        '''''ultra small field
        'designedBfield = New Single() {0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0}

        ''''''large field 
        'designedBfield = New Single() {0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -400, 0, -300, 0, -200, 0, -100, 0, 0, 0, 100, 0, 200, 0, 300, 0, 400, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}

        '''''''large field + small field
        'designedBfield = New Single() {0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -480, 0, -460, 0, -440, 0, -420, 0, -400, 0, -380, 0, -360, 0, -340, 0, -320, 0, -300, 0, -280, 0, -260, 0, -240, 0, -220, 0, -200, 0, -180, 0, -160, 0, -140, 0, -120, 0, -100, 0, -80, 0, -60, 0, -40, 0, -20, 0, 0, 0, 20, 0, 40, 0, 60, 0, 80, 0, 100, 0, 120, 0, 140, 0, 160, 0, 180, 0, 200, 0, 220, 0, 240, 0, 260, 0, 280, 0, 300, 0, 320, 0, 340, 0, 360, 0, 380, 0, 400, 0, 420, 0, 440, 0, 460, 0, 480, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}


        'designedBfield = New Single() {0, -600, 0, -580, 0, -560, 0, -540, 0, -520, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 520, 0, 540, 0, 560, 0, 580, 0, 600, 0}

        devicecurrentlist = New Single() {0.000002}



        size = designedBfield.Length()
        devicecurrentlistsize = devicecurrentlist.Length()


        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        'KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        Do Until currentlistnum = devicecurrentlistsize

            If devicecurrentlist(currentlistnum) < 0.000001 Then
                y = 0
                fileNum = 0

                inittime = DateTime.Now()

                Try

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                End Try

            Else

                fileNum = 0
                y = 0

                inittime = DateTime.Now()

                Try

                    Do Until y = 1
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)

                        ' Do Until z = 3
                        'Blocal = B2_Reading() + Blocal
                        'System.Threading.Thread.Sleep(3000)
                        'z = z + 1
                        'Loop

                        Blocal = 10.5

                        Blocal = -(Blocal)


                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 100
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop
                End Try
            End If





            currentlistnum = currentlistnum + 1
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortKEI_SM()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()





    End Sub


    Public Sub NewUltraMR29()                            ''''''''''''''''''new recipe of adding a large constant polarising B field'''''' 
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer
        Dim smllcoilsize As Integer
        Dim currentlistnum As Integer
        Dim kk As Integer, zz As Integer, xx As Integer
        Dim Blocalsm As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedBsmfield() As Single
        Dim designedIcoil() As Single
        Dim designedIsmcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bcheck As Single
        Dim B1 As Single, B2 As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim Ksmcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single
        Dim devicecurrentlist() As Single
        Dim devicecurrentlistsize As Integer
        Dim Brev As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        currentlistnum = 0
        Brev = -1
        'Kcoil = 1806.67

        'Kcoil = 1800.163 '''''COIL Z
        'Kcoil = 1644.96 ''''''coil z / device current up
        Kcoil = 1778.3  '''''COIL Z with Keithley source meter
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        Ksmcoil = 163.61 ''''''small coil coefficient
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -500, 0, -400, 0}
        'designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}

        ''''''''''ultra small field
        'designedBfield = New Single() {0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0}

        ''''small field
        'designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}

        ' designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}

        'designedBfield = New Single() {0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}

        designedBfield = New Single() {0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -495, 0, 500, 0, -490, 0, 500, 0, -485, 0, 500, 0, -480, 0, 500, 0, -475, 0, 500, 0, -470, 0, 500, 0, -465, 0, 500, 0, -460, 0, 500, 0, -455, 0, 500, 0, -450, 0, 500, 0, -445, 0, 500, 0, -440, 0, 500, 0, -435, 0, 500, 0, -430, 0, 500, 0, -425, 0, 500, 0, -420, 0, 500, 0, -415, 0, 500, 0, -410, 0, 500, 0, -405, 0, 500, 0, -400, 0, 500, 0, -395, 0, 500, 0, -390, 0, 500, 0, -385, 0, 500, 0, -380, 0, 500, 0, -375, 0, 500, 0, -370, 0, 500, 0, -365, 0, 500, 0, -360, 0, 500, 0, -355, 0, 500, 0, -350, 0, 500, 0, -345, 0, 500, 0, -340, 0, 500, 0, -335, 0, 500, 0, -330, 0, 500, 0, -325, 0, 500, 0, -320, 0, 500, 0, -315, 0, 500, 0, -310, 0, 500, 0, -305, 0, 500, 0, -300, 0, 500, 0, -297.5, 0, 500, 0, -295, 0, 500, 0, -292.5, 0, 500, 0, -290, 0, 500, 0, -287.5, 0, 500, 0, -285, 0, 500, 0, -282.5, 0, 500, 0, -280, 0, 500, 0, -277.5, 0, 500, 0, -275, 0, 500, 0, -272.5, 0, 500, 0, -270, 0, 500, 0, -267.5, 0, 500, 0, -265, 0, 500, 0, -262.5, 0, 500, 0, -260, 0, 500, 0, -257.5, 0, 500, 0, -255, 0, 500, 0, -252.5, 0, 500, 0, -250, 0, 500, 0, -247.5, 0, 500, 0, -245, 0, 500, 0, -242.5, 0, 500, 0, -240, 0, 500, 0, -237.5, 0, 500, 0, -235, 0, 500, 0, -232.5, 0, 500, 0, -230, 0, 500, 0, -227.5, 0, 500, 0, -225, 0, 500, 0, -222.5, 0, 500, 0, -220, 0, 500, 0, -217.5, 0, 500, 0, -215, 0, 500, 0, -212.5, 0, 500, 0, -210, 0, 500, 0, -207.5, 0, 500, 0, -205, 0, 500, 0, -202.5, 0, 500, 0, -200, 0, 500, 0, -197.5, 0, 500, 0, -195, 0, 500, 0, -192.5, 0, 500, 0, -190, 0, 500, 0, -187.5, 0, 500, 0, -185, 0, 500, 0, -182.5, 0, 500, 0, -180, 0, 500, 0, -177.5, 0, 500, 0, -175, 0, 500, 0, -172.5, 0, 500, 0, -170, 0, 500, 0, -167.5, 0, 500, 0, -165, 0, 500, 0, -162.5, 0, 500, 0, -160, 0, 500, 0, -157.5, 0, 500, 0, -155, 0, 500, 0, -152.5, 0, 500, 0, -150, 0, 500, 0, -147.5, 0, 500, 0, -145, 0, 500, 0, -142.5, 0, 500, 0, -140, 0, 500, 0, -137.5, 0, 500, 0, -135, 0, 500, 0, -132.5, 0, 500, 0, -130, 0, 500, 0, -127.5, 0, 500, 0, -125, 0, 500, 0, -122.5, 0, 500, 0, -120, 0, 500, 0, -117.5, 0, 500, 0, -115, 0, 500, 0, -112.5, 0, 500, 0, -110, 0, 500, 0, -109, 0, 500, 0, -108, 0, 500, 0, -107, 0, 500, 0, -106, 0, 500, 0, -105, 0, 500, 0, -104, 0, 500, 0, -103, 0, 500, 0, -102, 0, 500, 0, -101, 0, 500, 0, -100, 0, 500, 0, -99, 0, 500, 0, -98, 0, 500, 0, -97, 0, 500, 0, -96, 0, 500, 0, -95, 0, 500, 0, -94, 0, 500, 0, -93, 0, 500, 0, -92, 0, 500, 0, -91, 0, 500, 0, -90, 0, 500, 0, -89, 0, 500, 0, -88, 0, 500, 0, -87, 0, 500, 0, -86, 0, 500, 0, -85, 0, 500, 0, -84, 0, 500, 0, -83, 0, 500, 0, -82, 0, 500, 0, -81, 0, 500, 0, -80, 0, 500, 0, -79, 0, 500, 0, -78, 0, 500, 0, -77, 0, 500, 0, -76, 0, 500, 0, -75, 0, 500, 0, -74, 0, 500, 0, -73, 0, 500, 0, -72, 0, 500, 0, -71, 0, 500, 0, -70, 0, 500, 0, -69, 0, 500, 0, -68, 0, 500, 0, -67, 0, 500, 0, -66, 0, 500, 0, -65, 0, 500, 0, -64, 0, 500, 0, -63, 0, 500, 0, -62, 0, 500, 0, -61, 0, 500, 0, -60, 0, 500, 0, -59, 0, 500, 0, -58, 0, 500, 0, -57, 0, 500, 0, -56, 0, 500, 0, -55, 0, 500, 0, -54, 0, 500, 0, -53, 0, 500, 0, -52, 0, 500, 0, -51, 0, 500, 0, -50, 0, 500, 0, -49, 0, 500, 0, -48, 0, 500, 0, -47, 0, 500, 0, -46, 0, 500, 0, -45, 0, 500, 0, -44, 0, 500, 0, -43, 0, 500, 0, -42, 0, 500, 0, -41, 0, 500, 0, -40, 0, 500, 0, -39, 0, 500, 0, -38, 0, 500, 0, -37, 0, 500, 0, -36, 0, 500, 0, -35, 0, 500, 0, -34, 0, 500, 0, -33, 0, 500, 0, -32, 0, 500, 0, -31, 0, 500, 0, -30, 0, 500, 0, -29, 0, 500, 0, -28, 0, 500, 0, -27, 0, 500, 0, -26, 0, 500, 0, -25, 0, 500, 0, -24, 0, 500, 0, -23, 0, 500, 0, -22, 0, 500, 0, -21, 0, 500, 0, -20, 0, 500, 0, -19, 0, 500, 0, -18, 0, 500, 0, -17, 0, 500, 0, -16, 0, 500, 0, -15, 0, 500, 0, -14, 0, 500, 0, -13, 0, 500, 0, -12, 0, 500, 0, -11, 0, 500, 0, -10, 0, 500, 0, -9, 0, 500, 0, -8, 0, 500, 0, -7, 0, 500, 0, -6, 0, 500, 0, -5, 0, 500, 0, -4, 0, 500, 0, -3, 0, 500, 0, -2, 0, 500, 0, -1, 0, 500, 0, 0, 0, 500, 0, 1, 0, 500, 0, 2, 0, 500, 0, 3, 0, 500, 0, 4, 0, 500, 0, 5, 0, 500, 0, 6, 0, 500, 0, 7, 0, 500, 0, 8, 0, 500, 0, 9, 0, 500, 0, 10, 0, 500, 0, 11, 0, 500, 0, 12, 0, 500, 0, 13, 0, 500, 0, 14, 0, 500, 0, 15, 0, 500, 0, 16, 0, 500, 0, 17, 0, 500, 0, 18, 0, 500, 0, 19, 0, 500, 0, 20, 0, 500, 0, 21, 0, 500, 0, 22, 0, 500, 0, 23, 0, 500, 0, 24, 0, 500, 0, 25, 0, 500, 0, 26, 0, 500, 0, 27, 0, 500, 0, 28, 0, 500, 0, 29, 0, 500, 0, 30, 0, 500, 0, 31, 0, 500, 0, 32, 0, 500, 0, 33, 0, 500, 0, 34, 0, 500, 0, 35, 0, 500, 0, 36, 0, 500, 0, 37, 0, 500, 0, 38, 0, 500, 0, 39, 0, 500, 0, 40, 0, 500, 0, 41, 0, 500, 0, 42, 0, 500, 0, 43, 0, 500, 0, 44, 0, 500, 0, 45, 0, 500, 0, 46, 0, 500, 0, 47, 0, 500, 0, 48, 0, 500, 0, 49, 0, 500, 0, 50, 0, 500, 0, 51, 0, 500, 0, 52, 0, 500, 0, 53, 0, 500, 0, 54, 0, 500, 0, 55, 0, 500, 0, 56, 0, 500, 0, 57, 0, 500, 0, 58, 0, 500, 0, 59, 0, 500, 0, 60, 0, 500, 0, 61, 0, 500, 0, 62, 0, 500, 0, 63, 0, 500, 0, 64, 0, 500, 0, 65, 0, 500, 0, 66, 0, 500, 0, 67, 0, 500, 0, 68, 0, 500, 0, 69, 0, 500, 0, 70, 0, 500, 0, 71, 0, 500, 0, 72, 0, 500, 0, 73, 0, 500, 0, 74, 0, 500, 0, 75, 0, 500, 0, 76, 0, 500, 0, 77, 0, 500, 0, 78, 0, 500, 0, 79, 0, 500, 0, 80, 0, 500, 0, 81, 0, 500, 0, 82, 0, 500, 0, 83, 0, 500, 0, 84, 0, 500, 0, 85, 0, 500, 0, 86, 0, 500, 0, 87, 0, 500, 0, 88, 0, 500, 0, 89, 0, 500, 0, 90, 0, 500, 0, 91, 0, 500, 0, 92, 0, 500, 0, 93, 0, 500, 0, 94, 0, 500, 0, 95, 0, 500, 0, 96, 0, 500, 0, 97, 0, 500, 0, 98, 0, 500, 0, 99, 0, 500, 0, 100, 0, 500, 0, 101, 0, 500, 0, 102, 0, 500, 0, 103, 0, 500, 0, 104, 0, 500, 0, 105, 0, 500, 0, 106, 0, 500, 0, 107, 0, 500, 0, 108, 0, 500, 0, 109, 0, 500, 0, 110, 0, 500, 0, 112.5, 0, 500, 0, 115, 0, 500, 0, 117.5, 0, 500, 0, 120, 0, 500, 0, 122.5, 0, 500, 0, 125, 0, 500, 0, 127.5, 0, 500, 0, 130, 0, 500, 0, 132.5, 0, 500, 0, 135, 0, 500, 0, 137.5, 0, 500, 0, 140, 0, 500, 0, 142.5, 0, 500, 0, 145, 0, 500, 0, 147.5, 0, 500, 0, 150, 0, 500, 0, 152.5, 0, 500, 0, 155, 0, 500, 0, 157.5, 0, 500, 0, 160, 0, 500, 0, 162.5, 0, 500, 0, 165, 0, 500, 0, 167.5, 0, 500, 0, 170, 0, 500, 0, 172.5, 0, 500, 0, 175, 0, 500, 0, 177.5, 0, 500, 0, 180, 0, 500, 0, 182.5, 0, 500, 0, 185, 0, 500, 0, 187.5, 0, 500, 0, 190, 0, 500, 0, 192.5, 0, 500, 0, 195, 0, 500, 0, 197.5, 0, 500, 0, 200, 0, 500, 0, 202.5, 0, 500, 0, 205, 0, 500, 0, 207.5, 0, 500, 0, 210, 0, 500, 0, 212.5, 0, 500, 0, 215, 0, 500, 0, 217.5, 0, 500, 0, 220, 0, 500, 0, 222.5, 0, 500, 0, 225, 0, 500, 0, 227.5, 0, 500, 0, 230, 0, 500, 0, 232.5, 0, 500, 0, 235, 0, 500, 0, 237.5, 0, 500, 0, 240, 0, 500, 0, 242.5, 0, 500, 0, 245, 0, 500, 0, 247.5, 0, 500, 0, 250, 0, 500, 0, 252.5, 0, 500, 0, 255, 0, 500, 0, 257.5, 0, 500, 0, 260, 0, 500, 0, 262.5, 0, 500, 0, 265, 0, 500, 0, 267.5, 0, 500, 0, 270, 0, 500, 0, 272.5, 0, 500, 0, 275, 0, 500, 0, 277.5, 0, 500, 0, 280, 0, 500, 0, 282.5, 0, 500, 0, 285, 0, 500, 0, 287.5, 0, 500, 0, 290, 0, 500, 0, 292.5, 0, 500, 0, 295, 0, 500, 0, 297.5, 0, 500, 0, 300, 0, 500, 0, 305, 0, 500, 0, 310, 0, 500, 0, 315, 0, 500, 0, 320, 0, 500, 0, 325, 0, 500, 0, 330, 0, 500, 0, 335, 0, 500, 0, 340, 0, 500, 0, 345, 0, 500, 0, 350, 0, 500, 0, 355, 0, 500, 0, 360, 0, 500, 0, 365, 0, 500, 0, 370, 0, 500, 0, 375, 0, 500, 0, 380, 0, 500, 0, 385, 0, 500, 0, 390, 0, 500, 0, 395, 0, 500, 0, 400, 0, 500, 0, 405, 0, 500, 0, 410, 0, 500, 0, 415, 0, 500, 0, 420, 0, 500, 0, 425, 0, 500, 0, 430, 0, 500, 0, 435, 0, 500, 0, 440, 0, 500, 0, 445, 0, 500, 0, 450, 0, 500, 0, 455, 0, 500, 0, 460, 0, 500, 0, 465, 0, 500, 0, 470, 0, 500, 0, 475, 0, 500, 0, 480, 0, 500, 0, 485, 0, 500, 0, 490, 0, 500, 0, 495, 0, 500, 0, 500, 0, 500, 0}


        ''designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -500, 0, -490, 0, -500, 0, -485, 0, -500, 0, -480, 0, -500, 0, -475, 0, -500, 0, -470, 0, -500, 0, -465, 0, -500, 0, -460, 0, -500, 0, -455, 0, -500, 0, -450, 0, -500, 0, -445, 0, -500, 0, -440, 0, -500, 0, -435, 0, -500, 0, -430, 0, -500, 0, -425, 0, -500, 0, -420, 0, -500, 0, -415, 0, -500, 0, -410, 0, -500, 0, -405, 0, -500, 0, -400, 0, -500, 0, -395, 0, -500, 0, -390, 0, -500, 0, -385, 0, -500, 0, -380, 0, -500, 0, -375, 0, -500, 0, -370, 0, -500, 0, -365, 0, -500, 0, -360, 0, -500, 0, -355, 0, -500, 0, -350, 0, -500, 0, -345, 0, -500, 0, -340, 0, -500, 0, -335, 0, -500, 0, -330, 0, -500, 0, -325, 0, -500, 0, -320, 0, -500, 0, -315, 0, -500, 0, -310, 0, -500, 0, -305, 0, -500, 0, -300, 0, -500, 0, -297.5, 0, -500, 0, -295, 0, -500, 0, -292.5, 0, -500, 0, -290, 0, -500, 0, -287.5, 0, -500, 0, -285, 0, -500, 0, -282.5, 0, -500, 0, -280, 0, -500, 0, -277.5, 0, -500, 0, -275, 0, -500, 0, -272.5, 0, -500, 0, -270, 0, -500, 0, -267.5, 0, -500, 0, -265, 0, -500, 0, -262.5, 0, -500, 0, -260, 0, -500, 0, -257.5, 0, -500, 0, -255, 0, -500, 0, -252.5, 0, -500, 0, -250, 0, -500, 0, -247.5, 0, -500, 0, -245, 0, -500, 0, -242.5, 0, -500, 0, -240, 0, -500, 0, -237.5, 0, -500, 0, -235, 0, -500, 0, -232.5, 0, -500, 0, -230, 0, -500, 0, -227.5, 0, -500, 0, -225, 0, -500, 0, -222.5, 0, -500, 0, -220, 0, -500, 0, -217.5, 0, -500, 0, -215, 0, -500, 0, -212.5, 0, -500, 0, -210, 0, -500, 0, -207.5, 0, -500, 0, -205, 0, -500, 0, -202.5, 0, -500, 0, -200, 0, -500, 0, -197.5, 0, -500, 0, -195, 0, -500, 0, -192.5, 0, -500, 0, -190, 0, -500, 0, -187.5, 0, -500, 0, -185, 0, -500, 0, -182.5, 0, -500, 0, -180, 0, -500, 0, -177.5, 0, -500, 0, -175, 0, -500, 0, -172.5, 0, -500, 0, -170, 0, -500, 0, -167.5, 0, -500, 0, -165, 0, -500, 0, -162.5, 0, -500, 0, -160, 0, -500, 0, -157.5, 0, -500, 0, -155, 0, -500, 0, -152.5, 0, -500, 0, -150, 0, -500, 0, -147.5, 0, -500, 0, -145, 0, -500, 0, -142.5, 0, -500, 0, -140, 0, -500, 0, -137.5, 0, -500, 0, -135, 0, -500, 0, -132.5, 0, -500, 0, -130, 0, -500, 0, -127.5, 0, -500, 0, -125, 0, -500, 0, -122.5, 0, -500, 0, -120, 0, -500, 0, -117.5, 0, -500, 0, -115, 0, -500, 0, -112.5, 0, -500, 0, -110, 0, -500, 0, -109, 0, -500, 0, -108, 0, -500, 0, -107, 0, -500, 0, -106, 0, -500, 0, -105, 0, -500, 0, -104, 0, -500, 0, -103, 0, -500, 0, -102, 0, -500, 0, -101, 0, -500, 0, -100, 0, -500, 0, -99, 0, -500, 0, -98, 0, -500, 0, -97, 0, -500, 0, -96, 0, -500, 0, -95, 0, -500, 0, -94, 0, -500, 0, -93, 0, -500, 0, -92, 0, -500, 0, -91, 0, -500, 0, -90, 0, -500, 0, -89, 0, -500, 0, -88, 0, -500, 0, -87, 0, -500, 0, -86, 0, -500, 0, -85, 0, -500, 0, -84, 0, -500, 0, -83, 0, -500, 0, -82, 0, -500, 0, -81, 0, -500, 0, -80, 0, -500, 0, -79, 0, -500, 0, -78, 0, -500, 0, -77, 0, -500, 0, -76, 0, -500, 0, -75, 0, -500, 0, -74, 0, -500, 0, -73, 0, -500, 0, -72, 0, -500, 0, -71, 0, -500, 0, -70, 0, -500, 0, -69, 0, -500, 0, -68, 0, -500, 0, -67, 0, -500, 0, -66, 0, -500, 0, -65, 0, -500, 0, -64, 0, -500, 0, -63, 0, -500, 0, -62, 0, -500, 0, -61, 0, -500, 0, -60, 0, -500, 0, -59, 0, -500, 0, -58, 0, -500, 0, -57, 0, -500, 0, -56, 0, -500, 0, -55, 0, -500, 0, -54, 0, -500, 0, -53, 0, -500, 0, -52, 0, -500, 0, -51, 0, -500, 0, -50, 0, -500, 0, -49, 0, -500, 0, -48, 0, -500, 0, -47, 0, -500, 0, -46, 0, -500, 0, -45, 0, -500, 0, -44, 0, -500, 0, -43, 0, -500, 0, -42, 0, -500, 0, -41, 0, -500, 0, -40, 0, -500, 0, -39, 0, -500, 0, -38, 0, -500, 0, -37, 0, -500, 0, -36, 0, -500, 0, -35, 0, -500, 0, -34, 0, -500, 0, -33, 0, -500, 0, -32, 0, -500, 0, -31, 0, -500, 0, -30, 0, -500, 0, -29, 0, -500, 0, -28, 0, -500, 0, -27, 0, -500, 0, -26, 0, -500, 0, -25, 0, -500, 0, -24, 0, -500, 0, -23, 0, -500, 0, -22, 0, -500, 0, -21, 0, -500, 0, -20, 0, -500, 0, -19, 0, -500, 0, -18, 0, -500, 0, -17, 0, -500, 0, -16, 0, -500, 0, -15, 0, -500, 0, -14, 0, -500, 0, -13, 0, -500, 0, -12, 0, -500, 0, -11, 0, -500, 0, -10, 0, -500, 0, -9, 0, -500, 0, -8, 0, -500, 0, -7, 0, -500, 0, -6, 0, -500, 0, -5, 0, -500, 0, -4, 0, -500, 0, -3, 0, -500, 0, -2, 0, -500, 0, -1, 0, -500, 0, 0, 0, -500, 0, 1, 0, -500, 0, 2, 0, -500, 0, 3, 0, -500, 0, 4, 0, -500, 0, 5, 0, -500, 0, 6, 0, -500, 0, 7, 0, -500, 0, 8, 0, -500, 0, 9, 0, -500, 0, 10, 0, -500, 0, 11, 0, -500, 0, 12, 0, -500, 0, 13, 0, -500, 0, 14, 0, -500, 0, 15, 0, -500, 0, 16, 0, -500, 0, 17, 0, -500, 0, 18, 0, -500, 0, 19, 0, -500, 0, 20, 0, -500, 0, 21, 0, -500, 0, 22, 0, -500, 0, 23, 0, -500, 0, 24, 0, -500, 0, 25, 0, -500, 0, 26, 0, -500, 0, 27, 0, -500, 0, 28, 0, -500, 0, 29, 0, -500, 0, 30, 0, -500, 0, 31, 0, -500, 0, 32, 0, -500, 0, 33, 0, -500, 0, 34, 0, -500, 0, 35, 0, -500, 0, 36, 0, -500, 0, 37, 0, -500, 0, 38, 0, -500, 0, 39, 0, -500, 0, 40, 0, -500, 0, 41, 0, -500, 0, 42, 0, -500, 0, 43, 0, -500, 0, 44, 0, -500, 0, 45, 0, -500, 0, 46, 0, -500, 0, 47, 0, -500, 0, 48, 0, -500, 0, 49, 0, -500, 0, 50, 0, -500, 0, 51, 0, -500, 0, 52, 0, -500, 0, 53, 0, -500, 0, 54, 0, -500, 0, 55, 0, -500, 0, 56, 0, -500, 0, 57, 0, -500, 0, 58, 0, -500, 0, 59, 0, -500, 0, 60, 0, -500, 0, 61, 0, -500, 0, 62, 0, -500, 0, 63, 0, -500, 0, 64, 0, -500, 0, 65, 0, -500, 0, 66, 0, -500, 0, 67, 0, -500, 0, 68, 0, -500, 0, 69, 0, -500, 0, 70, 0, -500, 0, 71, 0, -500, 0, 72, 0, -500, 0, 73, 0, -500, 0, 74, 0, -500, 0, 75, 0, -500, 0, 76, 0, -500, 0, 77, 0, -500, 0, 78, 0, -500, 0, 79, 0, -500, 0, 80, 0, -500, 0, 81, 0, -500, 0, 82, 0, -500, 0, 83, 0, -500, 0, 84, 0, -500, 0, 85, 0, -500, 0, 86, 0, -500, 0, 87, 0, -500, 0, 88, 0, -500, 0, 89, 0, -500, 0, 90, 0, -500, 0, 91, 0, -500, 0, 92, 0, -500, 0, 93, 0, -500, 0, 94, 0, -500, 0, 95, 0, -500, 0, 96, 0, -500, 0, 97, 0, -500, 0, 98, 0, -500, 0, 99, 0, -500, 0, 100, 0, -500, 0, 101, 0, -500, 0, 102, 0, -500, 0, 103, 0, -500, 0, 104, 0, -500, 0, 105, 0, -500, 0, 106, 0, -500, 0, 107, 0, -500, 0, 108, 0, -500, 0, 109, 0, -500, 0, 110, 0, -500, 0, 112.5, 0, -500, 0, 115, 0, -500, 0, 117.5, 0, -500, 0, 120, 0, -500, 0, 122.5, 0, -500, 0, 125, 0, -500, 0, 127.5, 0, -500, 0, 130, 0, -500, 0, 132.5, 0, -500, 0, 135, 0, -500, 0, 137.5, 0, -500, 0, 140, 0, -500, 0, 142.5, 0, -500, 0, 145, 0, -500, 0, 147.5, 0, -500, 0, 150, 0, -500, 0, 152.5, 0, -500, 0, 155, 0, -500, 0, 157.5, 0, -500, 0, 160, 0, -500, 0, 162.5, 0, -500, 0, 165, 0, -500, 0, 167.5, 0, -500, 0, 170, 0, -500, 0, 172.5, 0, -500, 0, 175, 0, -500, 0, 177.5, 0, -500, 0, 180, 0, -500, 0, 182.5, 0, -500, 0, 185, 0, -500, 0, 187.5, 0, -500, 0, 190, 0, -500, 0, 192.5, 0, -500, 0, 195, 0, -500, 0, 197.5, 0, -500, 0, 200, 0, -500, 0, 202.5, 0, -500, 0, 205, 0, -500, 0, 207.5, 0, -500, 0, 210, 0, -500, 0, 212.5, 0, -500, 0, 215, 0, -500, 0, 217.5, 0, -500, 0, 220, 0, -500, 0, 222.5, 0, -500, 0, 225, 0, -500, 0, 227.5, 0, -500, 0, 230, 0, -500, 0, 232.5, 0, -500, 0, 235, 0, -500, 0, 237.5, 0, -500, 0, 240, 0, -500, 0, 242.5, 0, -500, 0, 245, 0, -500, 0, 247.5, 0, -500, 0, 250, 0, -500, 0, 252.5, 0, -500, 0, 255, 0, -500, 0, 257.5, 0, -500, 0, 260, 0, -500, 0, 262.5, 0, -500, 0, 265, 0, -500, 0, 267.5, 0, -500, 0, 270, 0, -500, 0, 272.5, 0, -500, 0, 275, 0, -500, 0, 277.5, 0, -500, 0, 280, 0, -500, 0, 282.5, 0, -500, 0, 285, 0, -500, 0, 287.5, 0, -500, 0, 290, 0, -500, 0, 292.5, 0, -500, 0, 295, 0, -500, 0, 297.5, 0, -500, 0, 300, 0, -500, 0, 305, 0, -500, 0, 310, 0, -500, 0, 315, 0, -500, 0, 320, 0, -500, 0, 325, 0, -500, 0, 330, 0, -500, 0, 335, 0, -500, 0, 340, 0, -500, 0, 345, 0, -500, 0, 350, 0, -500, 0, 355, 0, -500, 0, 360, 0, -500, 0, 365, 0, -500, 0, 370, 0, -500, 0, 375, 0, -500, 0, 380, 0, -500, 0, 385, 0, -500, 0, 390, 0, -500, 0, 395, 0, -500, 0, 400, 0, -500, 0, 405, 0, -500, 0, 410, 0, -500, 0, 415, 0, -500, 0, 420, 0, -500, 0, 425, 0, -500, 0, 430, 0, -500, 0, 435, 0, -500, 0, 440, 0, -500, 0, 445, 0, -500, 0, 450, 0, -500, 0, 455, 0, -500, 0, 460, 0, -500, 0, 465, 0, -500, 0, 470, 0, -500, 0, 475, 0, -500, 0, 480, 0, -500, 0, 485, 0, -500, 0, 490, 0, -500, 0, 495, 0, -500, 0, 500, 0, -500, 0}

        'designedBfield = New Single() {0, -500, 0, -450, 0}
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, 500, 0, 500, 0, 500, 0, 500, 0, -500}
        designedBsmfield = New Single() {-150}

        '''''''''designedBfield = New Single() {0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}
        ''''''hysteresis 
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}

        'designedBfield = New Single() {0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0}

        '''''ultra small field
        'designedBfield = New Single() {0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0}

        ''''''large field 
        'designedBfield = New Single() {0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -400, 0, -300, 0, -200, 0, -100, 0, 0, 0, 100, 0, 200, 0, 300, 0, 400, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}

        '''''''large field + small field
        'designedBfield = New Single() {0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -480, 0, -460, 0, -440, 0, -420, 0, -400, 0, -380, 0, -360, 0, -340, 0, -320, 0, -300, 0, -280, 0, -260, 0, -240, 0, -220, 0, -200, 0, -180, 0, -160, 0, -140, 0, -120, 0, -100, 0, -80, 0, -60, 0, -40, 0, -20, 0, 0, 0, 20, 0, 40, 0, 60, 0, 80, 0, 100, 0, 120, 0, 140, 0, 160, 0, 180, 0, 200, 0, 220, 0, 240, 0, 260, 0, 280, 0, 300, 0, 320, 0, 340, 0, 360, 0, 380, 0, 400, 0, 420, 0, 440, 0, 460, 0, 480, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}


        'designedBfield = New Single() {0, -600, 0, -580, 0, -560, 0, -540, 0, -520, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 520, 0, 540, 0, 560, 0, 580, 0, 600, 0}

        devicecurrentlist = New Single() {0.000002}



        size = designedBfield.Length()
        devicecurrentlistsize = devicecurrentlist.Length()
        smllcoilsize = designedBsmfield.Length()


        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        designedIsmcoil = New Single(smllcoilsize) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        'KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        Do Until currentlistnum = devicecurrentlistsize

            If devicecurrentlist(currentlistnum) < 0.000001 Then
                y = 0
                fileNum = 0

                inittime = DateTime.Now()

                Try

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                End Try

            Else

                Try
                    kk = 0

                    Do Until kk = smllcoilsize

                        Key2612OFF()
                        System.Threading.Thread.Sleep(500)
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(500)

                        zz = 0
                        Blocalsm = 0
                        Kcoil = 1778.3

                        Do Until zz = 3
                            Blocalsm = B2_Reading() + Blocalsm
                            System.Threading.Thread.Sleep(3000)
                            zz = zz + 1
                        Loop

                        Blocalsm = -(Blocalsm / 3)

                        xx = 0
                        Do Until xx = smllcoilsize
                            designedIsmcoil(xx) = (designedBsmfield(xx) + Blocalsm) / Ksmcoil
                            xx = xx + 1
                        Loop

                        System.Threading.Thread.Sleep(1000)

                        KEY2612Curr(designedIsmcoil(kk))

                        System.Threading.Thread.Sleep(1000)

                        Key2612ON()

                        fileNum = 0
                        y = 0

                        inittime = DateTime.Now()


                        Do Until y = 100
                            x = 0
                            Blocal = 0
                            z = 0

                            KeiIniVM()

                            'AbortAGI_CH2()
                            AbortKEI_SM()
                            System.Threading.Thread.Sleep(2000)
                            Do Until z = 3
                                Blocal = B2_Reading() + Blocal
                                System.Threading.Thread.Sleep(3000)
                                z = z + 1
                            Loop

                            Blocal = -(Blocal / 3)


                            Do Until x = size
                                designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                                x = x + 1
                            Loop

                            'ONAGI_CH2()
                            ONKEI_SM()
                            System.Threading.Thread.Sleep(1000)

                            'Z_AGICH2(((0 + Blocal) / Kcoil))
                            Z_KEI(((0 + Blocal) / Kcoil))

                            System.Threading.Thread.Sleep(2000)
                            ''''''''check if it is real zero with gradient field on'''''''
                            Bcheck = B2_Reading()

                            Do Until Math.Abs(Bcheck) < 2.2
                                Z_KEI(-0.5)
                                System.Threading.Thread.Sleep(500)
                                B1 = B2_Reading()
                                System.Threading.Thread.Sleep(500)
                                Z_KEI(-0.2)
                                System.Threading.Thread.Sleep(500)
                                B2 = B2_Reading()
                                System.Threading.Thread.Sleep(500)
                                Kcoil = (B2 - B1) / ((-0.2) - (-0.5))
                                System.Threading.Thread.Sleep(500)

                                x = 0
                                Blocal = 0
                                z = 0

                                KeiIniVM()

                                'AbortAGI_CH2()
                                AbortKEI_SM()
                                System.Threading.Thread.Sleep(2000)
                                Do Until z = 3
                                    Blocal = B2_Reading() + Blocal
                                    System.Threading.Thread.Sleep(3000)
                                    z = z + 1
                                Loop

                                Blocal = -(Blocal / 3)


                                Do Until x = size
                                    designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                                    x = x + 1
                                Loop

                                'ONAGI_CH2()
                                ONKEI_SM()
                                System.Threading.Thread.Sleep(1000)

                                'Z_AGICH2(((0 + Blocal) / Kcoil))
                                Z_KEI(((0 + Blocal) / Kcoil))
                                System.Threading.Thread.Sleep(8000)
                                Bcheck = B2_Reading()
                            Loop




                            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                            System.Threading.Thread.Sleep(2000)


                            DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                            System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                            'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                            Z_KEI(designedIcoil(0))

                            System.Threading.Thread.Sleep(2000)

                            x = 0
                            Do Until x = size
                                Diff = 50
                                'Z_AGICH2(designedIcoil(x))
                                Z_KEI(designedIcoil(x))
                                System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                                Diffnum = 0
                                'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                                Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                    Bnow = B2_Reading()
                                    Diff = Math.Abs(Bnow - designedBfield(x))
                                    System.Threading.Thread.Sleep(30)
                                    Diffnum = Diffnum + 1
                                    If Diffnum > 100 Then
                                        If (Bnow - designedBfield(x)) > 0 Then
                                            'Z_AGICH2(designedIcoil(x) - 0.00025)
                                            Z_KEI(designedIcoil(x) - 0.00025)
                                            System.Threading.Thread.Sleep(1000)
                                        ElseIf (Bnow - designedBfield(x)) < 0 Then
                                            'Z_AGICH2(designedIcoil(x) + 0.00025)
                                            Z_KEI(designedIcoil(x) + 0.00025)
                                            System.Threading.Thread.Sleep(1000)
                                        End If
                                    End If

                                Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                                newRealBfield(x) = Bnow
                                newDeviceVoltage(x) = KeiVoltReading()
                                currenttime = DateTime.Now()
                                MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                                x = x + 1
                            Loop
                            AbortAGI_CH1()

                            'AbortKEI_4200()

                            'Z_AGICH2(((0 + Blocal) / Kcoil))
                            Z_KEI(((0 + Blocal) / Kcoil))

                            FILETIME = DateTime.Now.ToString()
                            FILETIME = FILETIME.Replace("/", "_")
                            FILETIME = FILETIME.Replace(":", "_")

                            'Filename = FILETIME + "-" + "MRscan.txt"
                            Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + "smll " + designedBsmfield(kk).ToString() + ".txt"

                            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                            Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                            objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                            For x = 0 To size - 1
                                objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                            Next
                            objWriterTrans.Close()

                            y = y + 1
                            fileNum = fileNum + 1
                            System.Threading.Thread.Sleep(10000)
                        Loop

                        kk = kk + 1
                    Loop




                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 100
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop
                End Try
            End If





            currentlistnum = currentlistnum + 1
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortKEI_SM()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()
        System.Threading.Thread.Sleep(5000)
        Key2612OFF()




    End Sub


    Public Sub NewUltraMR30()                            '''''''''''''''''''''''''''''try catch solution / using keitley source meter /  constant device current / different device driving current 
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer
        Dim smllcoilsize As Integer
        Dim currentlistnum As Integer
        Dim kk As Integer, zz As Integer, xx As Integer
        Dim Blocalsm As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedBsmfield() As Single
        Dim designedIcoil() As Single
        Dim designedIsmcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bcheck As Single
        Dim B1 As Single, B2 As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim Ksmcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single
        Dim devicecurrentlist() As Single
        Dim devicecurrentlistsize As Integer
        Dim Brev As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        currentlistnum = 0
        Brev = -1
        'Kcoil = 1806.67

        'Kcoil = 1800.163 '''''COIL Z
        'Kcoil = 1644.96 ''''''coil z / device current up
        '''Kcoil = 1813.13  '''''COIL Z with Keithley source meter
        Kcoil = 1777.5
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        Ksmcoil = 365.47 ''''''small coil coefficient
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -500, 0, -400, 0}
        'designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}

        ''''''''''ultra small field
        'designedBfield = New Single() {0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0}

        ''''small field
        'designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}
        designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}
        'designedBfield = New Single() {0, -500, 0, -450, 0}
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, 500, 0, 500, 0, 500, 0, 500, 0, -500}
        'designedBsmfield = New Single() {-350, -150, 150, 350}
        designedBsmfield = New Single() {-350}

        '''''''''designedBfield = New Single() {0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}
        ''''''hysteresis 
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}

        'designedBfield = New Single() {0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0}

        '''''ultra small field
        'designedBfield = New Single() {0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0}

        ''''''large field 
        'designedBfield = New Single() {0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -400, 0, -300, 0, -200, 0, -100, 0, 0, 0, 100, 0, 200, 0, 300, 0, 400, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}

        '''''''large field + small field
        'designedBfield = New Single() {0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -480, 0, -460, 0, -440, 0, -420, 0, -400, 0, -380, 0, -360, 0, -340, 0, -320, 0, -300, 0, -280, 0, -260, 0, -240, 0, -220, 0, -200, 0, -180, 0, -160, 0, -140, 0, -120, 0, -100, 0, -80, 0, -60, 0, -40, 0, -20, 0, 0, 0, 20, 0, 40, 0, 60, 0, 80, 0, 100, 0, 120, 0, 140, 0, 160, 0, 180, 0, 200, 0, 220, 0, 240, 0, 260, 0, 280, 0, 300, 0, 320, 0, 340, 0, 360, 0, 380, 0, 400, 0, 420, 0, 440, 0, 460, 0, 480, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}


        'designedBfield = New Single() {0, -600, 0, -580, 0, -560, 0, -540, 0, -520, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 520, 0, 540, 0, 560, 0, 580, 0, 600, 0}

        devicecurrentlist = New Single() {0.000002}



        size = designedBfield.Length()
        devicecurrentlistsize = devicecurrentlist.Length()
        smllcoilsize = designedBsmfield.Length()


        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        designedIsmcoil = New Single(smllcoilsize) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        'KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        Do Until currentlistnum = devicecurrentlistsize

            If devicecurrentlist(currentlistnum) < 0.000001 Then
                y = 0
                fileNum = 0

                inittime = DateTime.Now()

                Try

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                End Try

            Else

                Try
                    kk = 0

                    Do Until kk = smllcoilsize

                        Key2612OFF()
                        System.Threading.Thread.Sleep(500)
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(500)

                        zz = 0
                        Blocalsm = 0
                        'Kcoil = 1813.13
                        Kcoil = 1777.5

                        'Do Until zz = 3
                        'Blocalsm = B2_Reading() + Blocalsm
                        'System.Threading.Thread.Sleep(3000)
                        'zz = zz + 1
                        'Loop

                        'Blocalsm = -(Blocalsm / 3)
                        Blocalsm = -6

                        xx = 0
                        Do Until xx = smllcoilsize
                            designedIsmcoil(xx) = (designedBsmfield(xx) + Blocalsm) / Ksmcoil
                            xx = xx + 1
                        Loop

                        System.Threading.Thread.Sleep(1000)

                        KEY2612Curr(designedIsmcoil(kk))

                        System.Threading.Thread.Sleep(1000)

                        Key2612ON()

                        fileNum = 0
                        y = 0

                        inittime = DateTime.Now()


                        Do Until y = 1
                            x = 0
                            Blocal = 0
                            z = 0

                            KeiIniVM()

                            'AbortAGI_CH2()
                            AbortKEI_SM()
                            System.Threading.Thread.Sleep(2000)
                            'Do Until z = 3
                            'Blocal = B2_Reading() + Blocal
                            'System.Threading.Thread.Sleep(3000)
                            'z = z + 1
                            'Loop

                            'Blocal = -(Blocal / 3)

                            Blocal = -39.96434



                            Do Until x = size
                                designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                                x = x + 1
                            Loop

                            'ONAGI_CH2()
                            ONKEI_SM()
                            System.Threading.Thread.Sleep(1000)

                            'Z_AGICH2(((0 + Blocal) / Kcoil))
                            Z_KEI(((0 + Blocal) / Kcoil))

                            System.Threading.Thread.Sleep(2000)
                            ''''''''check if it is real zero with gradient field on'''''''
                            Bcheck = B2_Reading()
                            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                            ' Do Until Math.Abs(Bcheck) < 2.2
                            'Z_KEI(-0.5)
                            'System.Threading.Thread.Sleep(500)
                            ' B1 = B2_Reading()
                            'System.Threading.Thread.Sleep(500)
                            'Z_KEI(-0.2)
                            'System.Threading.Thread.Sleep(500)
                            'B2 = B2_Reading()
                            'System.Threading.Thread.Sleep(500)
                            ' Kcoil = (B2 - B1) / ((-0.2) - (-0.5))
                            'System.Threading.Thread.Sleep(500)

                            'x = 0
                            'Blocal = 0
                            'z = 0

                            ''KeiIniVM()

                            '''AbortAGI_CH2()
                            'AbortKEI_SM()
                            'System.Threading.Thread.Sleep(2000)
                            'Do Until z = 3
                            'Blocal = B2_Reading() + Blocal
                            'System.Threading.Thread.Sleep(3000)
                            ' z = z + 1
                            'Loop

                            'Blocal = -(Blocal / 3)


                            ' Do Until x = size
                            'designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            ' x = x + 1
                            'Loop

                            '''ONAGI_CH2()
                            'ONKEI_SM()
                            'System.Threading.Thread.Sleep(1000)

                            '''Z_AGICH2(((0 + Blocal) / Kcoil))
                            'Z_KEI(((0 + Blocal) / Kcoil))
                            ' System.Threading.Thread.Sleep(8000)
                            'Bcheck = B2_Reading()
                            'Loop

                            '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''


                            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                            System.Threading.Thread.Sleep(2000)


                            'DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                            System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                            'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                            Z_KEI(designedIcoil(0))

                            System.Threading.Thread.Sleep(2000)

                            x = 0
                            Do Until x = size
                                'Diff = 50
                                'Z_AGICH2(designedIcoil(x))
                                Z_KEI(designedIcoil(x))
                                System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                                Diffnum = 0
                                'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                                'Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                ' Diff = Math.Abs(Bnow - designedBfield(x))
                                ' System.Threading.Thread.Sleep(30)
                                ' Diffnum = Diffnum + 1
                                'If Diffnum > 100 Then
                                'If (Bnow - designedBfield(x)) > 0 Then
                                ''Z_AGICH2(designedIcoil(x) - 0.00025)
                                'Z_KEI(designedIcoil(x) - 0.00025)
                                'System.Threading.Thread.Sleep(1000)
                                'ElseIf (Bnow - designedBfield(x)) < 0 Then
                                ''Z_AGICH2(designedIcoil(x) + 0.00025)
                                ' Z_KEI(designedIcoil(x) + 0.00025)
                                'System.Threading.Thread.Sleep(1000)
                                'End If
                                'End If

                                'Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                                newRealBfield(x) = Bnow
                                'newDeviceVoltage(x) = KeiVoltReading()
                                currenttime = DateTime.Now()
                                MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                                x = x + 1
                            Loop
                            AbortAGI_CH1()

                            'AbortKEI_4200()

                            'Z_AGICH2(((0 + Blocal) / Kcoil))
                            Z_KEI(((0 + Blocal) / Kcoil))

                            FILETIME = DateTime.Now.ToString()
                            FILETIME = FILETIME.Replace("/", "_")
                            FILETIME = FILETIME.Replace(":", "_")

                            'Filename = FILETIME + "-" + "MRscan.txt"
                            Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + "smll " + designedBsmfield(kk).ToString() + "-smll local" + Blocalsm.ToString + "-larg local" + Blocal.ToString + ".txt"

                            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                            Dim LineFormatTrans As String = "{0,-10}{1,-16:E}"
                            objWriterTrans.WriteLine("{0,-10}{1,-16}", "Bfield", "Interval")
                            For x = 0 To size - 1
                                objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), MeasureInterval(x))
                            Next
                            objWriterTrans.Close()

                            y = y + 1
                            fileNum = fileNum + 1
                            System.Threading.Thread.Sleep(10000)
                        Loop

                        kk = kk + 1
                    Loop




                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 100
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop
                End Try
            End If





            currentlistnum = currentlistnum + 1
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortKEI_SM()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()
        System.Threading.Thread.Sleep(5000)
        Key2612OFF()




    End Sub


    Public Sub NewUltraMR31()                            ''''''''''''just for B checking 
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer
        Dim smllcoilsize As Integer
        Dim currentlistnum As Integer
        Dim kk As Integer, zz As Integer, xx As Integer
        Dim Blocalsm As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedBsmfield() As Single
        Dim designedIcoil() As Single
        Dim designedIsmcoil() As Single
        Dim newRealBfield() As Single
        Dim newCheckBield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bcheck As Single
        Dim B1 As Single, B2 As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim Ksmcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single
        Dim devicecurrentlist() As Single
        Dim devicecurrentlistsize As Integer
        Dim Brev As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        currentlistnum = 0
        Brev = -1
        'Kcoil = 1806.67

        'Kcoil = 1800.163 '''''COIL Z
        'Kcoil = 1644.96 ''''''coil z / device current up
        Kcoil = 1781.3  '''''COIL Z with Keithley source meter
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        Ksmcoil = 342.82 ''''''small coil coefficient
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -500, 0, -400, 0}
        'designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}

        ''''''''''ultra small field
        'designedBfield = New Single() {0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0}

        ''''small field
        'designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}
        designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}

        ' designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}

        'designedBfield = New Single() {0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}

        'designedBfield = New Single() {0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -495, 0, 500, 0, -490, 0, 500, 0, -485, 0, 500, 0, -480, 0, 500, 0, -475, 0, 500, 0, -470, 0, 500, 0, -465, 0, 500, 0, -460, 0, 500, 0, -455, 0, 500, 0, -450, 0, 500, 0, -445, 0, 500, 0, -440, 0, 500, 0, -435, 0, 500, 0, -430, 0, 500, 0, -425, 0, 500, 0, -420, 0, 500, 0, -415, 0, 500, 0, -410, 0, 500, 0, -405, 0, 500, 0, -400, 0, 500, 0, -395, 0, 500, 0, -390, 0, 500, 0, -385, 0, 500, 0, -380, 0, 500, 0, -375, 0, 500, 0, -370, 0, 500, 0, -365, 0, 500, 0, -360, 0, 500, 0, -355, 0, 500, 0, -350, 0, 500, 0, -345, 0, 500, 0, -340, 0, 500, 0, -335, 0, 500, 0, -330, 0, 500, 0, -325, 0, 500, 0, -320, 0, 500, 0, -315, 0, 500, 0, -310, 0, 500, 0, -305, 0, 500, 0, -300, 0, 500, 0, -297.5, 0, 500, 0, -295, 0, 500, 0, -292.5, 0, 500, 0, -290, 0, 500, 0, -287.5, 0, 500, 0, -285, 0, 500, 0, -282.5, 0, 500, 0, -280, 0, 500, 0, -277.5, 0, 500, 0, -275, 0, 500, 0, -272.5, 0, 500, 0, -270, 0, 500, 0, -267.5, 0, 500, 0, -265, 0, 500, 0, -262.5, 0, 500, 0, -260, 0, 500, 0, -257.5, 0, 500, 0, -255, 0, 500, 0, -252.5, 0, 500, 0, -250, 0, 500, 0, -247.5, 0, 500, 0, -245, 0, 500, 0, -242.5, 0, 500, 0, -240, 0, 500, 0, -237.5, 0, 500, 0, -235, 0, 500, 0, -232.5, 0, 500, 0, -230, 0, 500, 0, -227.5, 0, 500, 0, -225, 0, 500, 0, -222.5, 0, 500, 0, -220, 0, 500, 0, -217.5, 0, 500, 0, -215, 0, 500, 0, -212.5, 0, 500, 0, -210, 0, 500, 0, -207.5, 0, 500, 0, -205, 0, 500, 0, -202.5, 0, 500, 0, -200, 0, 500, 0, -197.5, 0, 500, 0, -195, 0, 500, 0, -192.5, 0, 500, 0, -190, 0, 500, 0, -187.5, 0, 500, 0, -185, 0, 500, 0, -182.5, 0, 500, 0, -180, 0, 500, 0, -177.5, 0, 500, 0, -175, 0, 500, 0, -172.5, 0, 500, 0, -170, 0, 500, 0, -167.5, 0, 500, 0, -165, 0, 500, 0, -162.5, 0, 500, 0, -160, 0, 500, 0, -157.5, 0, 500, 0, -155, 0, 500, 0, -152.5, 0, 500, 0, -150, 0, 500, 0, -147.5, 0, 500, 0, -145, 0, 500, 0, -142.5, 0, 500, 0, -140, 0, 500, 0, -137.5, 0, 500, 0, -135, 0, 500, 0, -132.5, 0, 500, 0, -130, 0, 500, 0, -127.5, 0, 500, 0, -125, 0, 500, 0, -122.5, 0, 500, 0, -120, 0, 500, 0, -117.5, 0, 500, 0, -115, 0, 500, 0, -112.5, 0, 500, 0, -110, 0, 500, 0, -109, 0, 500, 0, -108, 0, 500, 0, -107, 0, 500, 0, -106, 0, 500, 0, -105, 0, 500, 0, -104, 0, 500, 0, -103, 0, 500, 0, -102, 0, 500, 0, -101, 0, 500, 0, -100, 0, 500, 0, -99, 0, 500, 0, -98, 0, 500, 0, -97, 0, 500, 0, -96, 0, 500, 0, -95, 0, 500, 0, -94, 0, 500, 0, -93, 0, 500, 0, -92, 0, 500, 0, -91, 0, 500, 0, -90, 0, 500, 0, -89, 0, 500, 0, -88, 0, 500, 0, -87, 0, 500, 0, -86, 0, 500, 0, -85, 0, 500, 0, -84, 0, 500, 0, -83, 0, 500, 0, -82, 0, 500, 0, -81, 0, 500, 0, -80, 0, 500, 0, -79, 0, 500, 0, -78, 0, 500, 0, -77, 0, 500, 0, -76, 0, 500, 0, -75, 0, 500, 0, -74, 0, 500, 0, -73, 0, 500, 0, -72, 0, 500, 0, -71, 0, 500, 0, -70, 0, 500, 0, -69, 0, 500, 0, -68, 0, 500, 0, -67, 0, 500, 0, -66, 0, 500, 0, -65, 0, 500, 0, -64, 0, 500, 0, -63, 0, 500, 0, -62, 0, 500, 0, -61, 0, 500, 0, -60, 0, 500, 0, -59, 0, 500, 0, -58, 0, 500, 0, -57, 0, 500, 0, -56, 0, 500, 0, -55, 0, 500, 0, -54, 0, 500, 0, -53, 0, 500, 0, -52, 0, 500, 0, -51, 0, 500, 0, -50, 0, 500, 0, -49, 0, 500, 0, -48, 0, 500, 0, -47, 0, 500, 0, -46, 0, 500, 0, -45, 0, 500, 0, -44, 0, 500, 0, -43, 0, 500, 0, -42, 0, 500, 0, -41, 0, 500, 0, -40, 0, 500, 0, -39, 0, 500, 0, -38, 0, 500, 0, -37, 0, 500, 0, -36, 0, 500, 0, -35, 0, 500, 0, -34, 0, 500, 0, -33, 0, 500, 0, -32, 0, 500, 0, -31, 0, 500, 0, -30, 0, 500, 0, -29, 0, 500, 0, -28, 0, 500, 0, -27, 0, 500, 0, -26, 0, 500, 0, -25, 0, 500, 0, -24, 0, 500, 0, -23, 0, 500, 0, -22, 0, 500, 0, -21, 0, 500, 0, -20, 0, 500, 0, -19, 0, 500, 0, -18, 0, 500, 0, -17, 0, 500, 0, -16, 0, 500, 0, -15, 0, 500, 0, -14, 0, 500, 0, -13, 0, 500, 0, -12, 0, 500, 0, -11, 0, 500, 0, -10, 0, 500, 0, -9, 0, 500, 0, -8, 0, 500, 0, -7, 0, 500, 0, -6, 0, 500, 0, -5, 0, 500, 0, -4, 0, 500, 0, -3, 0, 500, 0, -2, 0, 500, 0, -1, 0, 500, 0, 0, 0, 500, 0, 1, 0, 500, 0, 2, 0, 500, 0, 3, 0, 500, 0, 4, 0, 500, 0, 5, 0, 500, 0, 6, 0, 500, 0, 7, 0, 500, 0, 8, 0, 500, 0, 9, 0, 500, 0, 10, 0, 500, 0, 11, 0, 500, 0, 12, 0, 500, 0, 13, 0, 500, 0, 14, 0, 500, 0, 15, 0, 500, 0, 16, 0, 500, 0, 17, 0, 500, 0, 18, 0, 500, 0, 19, 0, 500, 0, 20, 0, 500, 0, 21, 0, 500, 0, 22, 0, 500, 0, 23, 0, 500, 0, 24, 0, 500, 0, 25, 0, 500, 0, 26, 0, 500, 0, 27, 0, 500, 0, 28, 0, 500, 0, 29, 0, 500, 0, 30, 0, 500, 0, 31, 0, 500, 0, 32, 0, 500, 0, 33, 0, 500, 0, 34, 0, 500, 0, 35, 0, 500, 0, 36, 0, 500, 0, 37, 0, 500, 0, 38, 0, 500, 0, 39, 0, 500, 0, 40, 0, 500, 0, 41, 0, 500, 0, 42, 0, 500, 0, 43, 0, 500, 0, 44, 0, 500, 0, 45, 0, 500, 0, 46, 0, 500, 0, 47, 0, 500, 0, 48, 0, 500, 0, 49, 0, 500, 0, 50, 0, 500, 0, 51, 0, 500, 0, 52, 0, 500, 0, 53, 0, 500, 0, 54, 0, 500, 0, 55, 0, 500, 0, 56, 0, 500, 0, 57, 0, 500, 0, 58, 0, 500, 0, 59, 0, 500, 0, 60, 0, 500, 0, 61, 0, 500, 0, 62, 0, 500, 0, 63, 0, 500, 0, 64, 0, 500, 0, 65, 0, 500, 0, 66, 0, 500, 0, 67, 0, 500, 0, 68, 0, 500, 0, 69, 0, 500, 0, 70, 0, 500, 0, 71, 0, 500, 0, 72, 0, 500, 0, 73, 0, 500, 0, 74, 0, 500, 0, 75, 0, 500, 0, 76, 0, 500, 0, 77, 0, 500, 0, 78, 0, 500, 0, 79, 0, 500, 0, 80, 0, 500, 0, 81, 0, 500, 0, 82, 0, 500, 0, 83, 0, 500, 0, 84, 0, 500, 0, 85, 0, 500, 0, 86, 0, 500, 0, 87, 0, 500, 0, 88, 0, 500, 0, 89, 0, 500, 0, 90, 0, 500, 0, 91, 0, 500, 0, 92, 0, 500, 0, 93, 0, 500, 0, 94, 0, 500, 0, 95, 0, 500, 0, 96, 0, 500, 0, 97, 0, 500, 0, 98, 0, 500, 0, 99, 0, 500, 0, 100, 0, 500, 0, 101, 0, 500, 0, 102, 0, 500, 0, 103, 0, 500, 0, 104, 0, 500, 0, 105, 0, 500, 0, 106, 0, 500, 0, 107, 0, 500, 0, 108, 0, 500, 0, 109, 0, 500, 0, 110, 0, 500, 0, 112.5, 0, 500, 0, 115, 0, 500, 0, 117.5, 0, 500, 0, 120, 0, 500, 0, 122.5, 0, 500, 0, 125, 0, 500, 0, 127.5, 0, 500, 0, 130, 0, 500, 0, 132.5, 0, 500, 0, 135, 0, 500, 0, 137.5, 0, 500, 0, 140, 0, 500, 0, 142.5, 0, 500, 0, 145, 0, 500, 0, 147.5, 0, 500, 0, 150, 0, 500, 0, 152.5, 0, 500, 0, 155, 0, 500, 0, 157.5, 0, 500, 0, 160, 0, 500, 0, 162.5, 0, 500, 0, 165, 0, 500, 0, 167.5, 0, 500, 0, 170, 0, 500, 0, 172.5, 0, 500, 0, 175, 0, 500, 0, 177.5, 0, 500, 0, 180, 0, 500, 0, 182.5, 0, 500, 0, 185, 0, 500, 0, 187.5, 0, 500, 0, 190, 0, 500, 0, 192.5, 0, 500, 0, 195, 0, 500, 0, 197.5, 0, 500, 0, 200, 0, 500, 0, 202.5, 0, 500, 0, 205, 0, 500, 0, 207.5, 0, 500, 0, 210, 0, 500, 0, 212.5, 0, 500, 0, 215, 0, 500, 0, 217.5, 0, 500, 0, 220, 0, 500, 0, 222.5, 0, 500, 0, 225, 0, 500, 0, 227.5, 0, 500, 0, 230, 0, 500, 0, 232.5, 0, 500, 0, 235, 0, 500, 0, 237.5, 0, 500, 0, 240, 0, 500, 0, 242.5, 0, 500, 0, 245, 0, 500, 0, 247.5, 0, 500, 0, 250, 0, 500, 0, 252.5, 0, 500, 0, 255, 0, 500, 0, 257.5, 0, 500, 0, 260, 0, 500, 0, 262.5, 0, 500, 0, 265, 0, 500, 0, 267.5, 0, 500, 0, 270, 0, 500, 0, 272.5, 0, 500, 0, 275, 0, 500, 0, 277.5, 0, 500, 0, 280, 0, 500, 0, 282.5, 0, 500, 0, 285, 0, 500, 0, 287.5, 0, 500, 0, 290, 0, 500, 0, 292.5, 0, 500, 0, 295, 0, 500, 0, 297.5, 0, 500, 0, 300, 0, 500, 0, 305, 0, 500, 0, 310, 0, 500, 0, 315, 0, 500, 0, 320, 0, 500, 0, 325, 0, 500, 0, 330, 0, 500, 0, 335, 0, 500, 0, 340, 0, 500, 0, 345, 0, 500, 0, 350, 0, 500, 0, 355, 0, 500, 0, 360, 0, 500, 0, 365, 0, 500, 0, 370, 0, 500, 0, 375, 0, 500, 0, 380, 0, 500, 0, 385, 0, 500, 0, 390, 0, 500, 0, 395, 0, 500, 0, 400, 0, 500, 0, 405, 0, 500, 0, 410, 0, 500, 0, 415, 0, 500, 0, 420, 0, 500, 0, 425, 0, 500, 0, 430, 0, 500, 0, 435, 0, 500, 0, 440, 0, 500, 0, 445, 0, 500, 0, 450, 0, 500, 0, 455, 0, 500, 0, 460, 0, 500, 0, 465, 0, 500, 0, 470, 0, 500, 0, 475, 0, 500, 0, 480, 0, 500, 0, 485, 0, 500, 0, 490, 0, 500, 0, 495, 0, 500, 0, 500, 0, 500, 0}

        'designedBfield = New Single() {0, -500, 0, -450, 0}
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, 500, 0, 500, 0, 500, 0, 500, 0, -500}
        designedBsmfield = New Single() {-150}

        '''''''''designedBfield = New Single() {0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}
        ''''''hysteresis 
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}

        'designedBfield = New Single() {0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0}

        '''''ultra small field
        'designedBfield = New Single() {0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0}

        ''''''large field 
        'designedBfield = New Single() {0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -400, 0, -300, 0, -200, 0, -100, 0, 0, 0, 100, 0, 200, 0, 300, 0, 400, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}

        '''''''large field + small field
        'designedBfield = New Single() {0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -480, 0, -460, 0, -440, 0, -420, 0, -400, 0, -380, 0, -360, 0, -340, 0, -320, 0, -300, 0, -280, 0, -260, 0, -240, 0, -220, 0, -200, 0, -180, 0, -160, 0, -140, 0, -120, 0, -100, 0, -80, 0, -60, 0, -40, 0, -20, 0, 0, 0, 20, 0, 40, 0, 60, 0, 80, 0, 100, 0, 120, 0, 140, 0, 160, 0, 180, 0, 200, 0, 220, 0, 240, 0, 260, 0, 280, 0, 300, 0, 320, 0, 340, 0, 360, 0, 380, 0, 400, 0, 420, 0, 440, 0, 460, 0, 480, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}


        'designedBfield = New Single() {0, -600, 0, -580, 0, -560, 0, -540, 0, -520, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 520, 0, 540, 0, 560, 0, 580, 0, 600, 0}

        devicecurrentlist = New Single() {0.000002}



        size = designedBfield.Length()
        devicecurrentlistsize = devicecurrentlist.Length()
        smllcoilsize = designedBsmfield.Length()


        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        designedIsmcoil = New Single(smllcoilsize) {}
        newRealBfield = New Single(size) {}
        newCheckBield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        'KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        Do Until currentlistnum = devicecurrentlistsize

            If devicecurrentlist(currentlistnum) < 0.000001 Then
                y = 0
                fileNum = 0

                inittime = DateTime.Now()

                Try

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                End Try

            Else

                Try
                    kk = 0

                    Do Until kk = smllcoilsize

                        Key2612OFF()
                        System.Threading.Thread.Sleep(500)
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(500)

                        zz = 0
                        Blocalsm = 0
                        Kcoil = 1781.3

                        Do Until zz = 3
                            Blocalsm = B2_Reading() + Blocalsm
                            System.Threading.Thread.Sleep(3000)
                            zz = zz + 1
                        Loop

                        Blocalsm = -(Blocalsm / 3)

                        xx = 0
                        Do Until xx = smllcoilsize
                            designedIsmcoil(xx) = (designedBsmfield(xx) + Blocalsm) / Ksmcoil
                            xx = xx + 1
                        Loop

                        System.Threading.Thread.Sleep(1000)

                        KEY2612Curr(designedIsmcoil(kk))

                        System.Threading.Thread.Sleep(1000)

                        Key2612ON()

                        fileNum = 0
                        y = 0

                        inittime = DateTime.Now()


                        Do Until y = 100
                            x = 0
                            Blocal = 0
                            z = 0

                            KeiIniVM()

                            'AbortAGI_CH2()
                            AbortKEI_SM()
                            System.Threading.Thread.Sleep(2000)
                            Do Until z = 3
                                Blocal = B2_Reading() + Blocal
                                System.Threading.Thread.Sleep(3000)
                                z = z + 1
                            Loop

                            Blocal = -(Blocal / 3)


                            Do Until x = size
                                designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                                x = x + 1
                            Loop

                            'ONAGI_CH2()
                            ONKEI_SM()
                            System.Threading.Thread.Sleep(1000)

                            'Z_AGICH2(((0 + Blocal) / Kcoil))
                            Z_KEI(((0 + Blocal) / Kcoil))

                            System.Threading.Thread.Sleep(2000)
                            ''''''''check if it is real zero with gradient field on'''''''
                            Bcheck = B2_Reading()

                            Do Until Math.Abs(Bcheck) < 2.2
                                Z_KEI(-0.5)
                                System.Threading.Thread.Sleep(500)
                                B1 = B2_Reading()
                                System.Threading.Thread.Sleep(500)
                                Z_KEI(-0.2)
                                System.Threading.Thread.Sleep(500)
                                B2 = B2_Reading()
                                System.Threading.Thread.Sleep(500)
                                Kcoil = (B2 - B1) / ((-0.2) - (-0.5))
                                System.Threading.Thread.Sleep(500)

                                x = 0
                                Blocal = 0
                                z = 0

                                KeiIniVM()

                                'AbortAGI_CH2()
                                AbortKEI_SM()
                                System.Threading.Thread.Sleep(2000)
                                Do Until z = 3
                                    Blocal = B2_Reading() + Blocal
                                    System.Threading.Thread.Sleep(3000)
                                    z = z + 1
                                Loop

                                Blocal = -(Blocal / 3)


                                Do Until x = size
                                    designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                                    x = x + 1
                                Loop

                                'ONAGI_CH2()
                                ONKEI_SM()
                                System.Threading.Thread.Sleep(1000)

                                'Z_AGICH2(((0 + Blocal) / Kcoil))
                                Z_KEI(((0 + Blocal) / Kcoil))
                                System.Threading.Thread.Sleep(8000)
                                Bcheck = B2_Reading()
                            Loop




                            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                            System.Threading.Thread.Sleep(2000)


                            DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                            System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                            'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                            Z_KEI(designedIcoil(0))

                            System.Threading.Thread.Sleep(2000)

                            x = 0
                            Do Until x = size
                                Diff = 50
                                'Z_AGICH2(designedIcoil(x))
                                Z_KEI(designedIcoil(x))
                                System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                                Diffnum = 0
                                'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                                Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                    Bnow = B2_Reading()
                                    Diff = Math.Abs(Bnow - designedBfield(x))
                                    System.Threading.Thread.Sleep(30)
                                    Diffnum = Diffnum + 1
                                    If Diffnum > 100 Then
                                        If (Bnow - designedBfield(x)) > 0 Then
                                            'Z_AGICH2(designedIcoil(x) - 0.00025)
                                            Z_KEI(designedIcoil(x) - 0.00025)
                                            System.Threading.Thread.Sleep(1000)
                                        ElseIf (Bnow - designedBfield(x)) < 0 Then
                                            'Z_AGICH2(designedIcoil(x) + 0.00025)
                                            Z_KEI(designedIcoil(x) + 0.00025)
                                            System.Threading.Thread.Sleep(1000)
                                        End If
                                    End If

                                Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                                newRealBfield(x) = Bnow
                                newDeviceVoltage(x) = KeiVoltReading()
                                currenttime = DateTime.Now()
                                MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                                newCheckBield(x) = B2_Reading()
                                x = x + 1
                            Loop
                            AbortAGI_CH1()

                            'AbortKEI_4200()

                            'Z_AGICH2(((0 + Blocal) / Kcoil))
                            Z_KEI(((0 + Blocal) / Kcoil))

                            FILETIME = DateTime.Now.ToString()
                            FILETIME = FILETIME.Replace("/", "_")
                            FILETIME = FILETIME.Replace(":", "_")

                            'Filename = FILETIME + "-" + "MRscan.txt"
                            Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + "smll " + designedBsmfield(kk).ToString() + ".txt"

                            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                            Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}{3,-16:E}"
                            objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}", "Bfield", "Voltage", "Interval", "Bcheck")
                            For x = 0 To size - 1
                                objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x), newCheckBield(x))
                            Next
                            objWriterTrans.Close()

                            y = y + 1
                            fileNum = fileNum + 1
                            System.Threading.Thread.Sleep(10000)
                        Loop

                        kk = kk + 1
                    Loop




                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 100
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop
                End Try
            End If





            currentlistnum = currentlistnum + 1
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortKEI_SM()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()
        System.Threading.Thread.Sleep(5000)
        Key2612OFF()




    End Sub

    Public Sub NewUltraMR32()                            ''''''''''''''''''''''check device voltage twice'''''''''' 
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer
        Dim smllcoilsize As Integer
        Dim currentlistnum As Integer
        Dim kk As Integer, zz As Integer, xx As Integer
        Dim Blocalsm As Integer

        Dim newDeviceVoltage() As Single
        Dim newDeviceVoltage2() As Single
        Dim designedBfield() As Single
        Dim designedBsmfield() As Single
        Dim designedIcoil() As Single
        Dim designedIsmcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bcheck As Single
        Dim B1 As Single, B2 As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim Ksmcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single
        Dim devicecurrentlist() As Single
        Dim devicecurrentlistsize As Integer
        Dim Brev As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        currentlistnum = 0
        Brev = -1
        'Kcoil = 1806.67

        'Kcoil = 1800.163 '''''COIL Z
        'Kcoil = 1644.96 ''''''coil z / device current up
        Kcoil = 1776  '''''COIL Z with Keithley source meter
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        Ksmcoil = 298.26 ''''''small coil coefficient
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -500, 0, -400, 0}
        'designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}

        ''''''''''ultra small field
        'designedBfield = New Single() {0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0}

        ''''small field
        'designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}

        ' designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}

        'designedBfield = New Single() {0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}

        designedBfield = New Single() {0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -495, 0, 500, 0, -490, 0, 500, 0, -485, 0, 500, 0, -480, 0, 500, 0, -475, 0, 500, 0, -470, 0, 500, 0, -465, 0, 500, 0, -460, 0, 500, 0, -455, 0, 500, 0, -450, 0, 500, 0, -445, 0, 500, 0, -440, 0, 500, 0, -435, 0, 500, 0, -430, 0, 500, 0, -425, 0, 500, 0, -420, 0, 500, 0, -415, 0, 500, 0, -410, 0, 500, 0, -405, 0, 500, 0, -400, 0, 500, 0, -395, 0, 500, 0, -390, 0, 500, 0, -385, 0, 500, 0, -380, 0, 500, 0, -375, 0, 500, 0, -370, 0, 500, 0, -365, 0, 500, 0, -360, 0, 500, 0, -355, 0, 500, 0, -350, 0, 500, 0, -345, 0, 500, 0, -340, 0, 500, 0, -335, 0, 500, 0, -330, 0, 500, 0, -325, 0, 500, 0, -320, 0, 500, 0, -315, 0, 500, 0, -310, 0, 500, 0, -305, 0, 500, 0, -300, 0, 500, 0, -297.5, 0, 500, 0, -295, 0, 500, 0, -292.5, 0, 500, 0, -290, 0, 500, 0, -287.5, 0, 500, 0, -285, 0, 500, 0, -282.5, 0, 500, 0, -280, 0, 500, 0, -277.5, 0, 500, 0, -275, 0, 500, 0, -272.5, 0, 500, 0, -270, 0, 500, 0, -267.5, 0, 500, 0, -265, 0, 500, 0, -262.5, 0, 500, 0, -260, 0, 500, 0, -257.5, 0, 500, 0, -255, 0, 500, 0, -252.5, 0, 500, 0, -250, 0, 500, 0, -247.5, 0, 500, 0, -245, 0, 500, 0, -242.5, 0, 500, 0, -240, 0, 500, 0, -237.5, 0, 500, 0, -235, 0, 500, 0, -232.5, 0, 500, 0, -230, 0, 500, 0, -227.5, 0, 500, 0, -225, 0, 500, 0, -222.5, 0, 500, 0, -220, 0, 500, 0, -217.5, 0, 500, 0, -215, 0, 500, 0, -212.5, 0, 500, 0, -210, 0, 500, 0, -207.5, 0, 500, 0, -205, 0, 500, 0, -202.5, 0, 500, 0, -200, 0, 500, 0, -197.5, 0, 500, 0, -195, 0, 500, 0, -192.5, 0, 500, 0, -190, 0, 500, 0, -187.5, 0, 500, 0, -185, 0, 500, 0, -182.5, 0, 500, 0, -180, 0, 500, 0, -177.5, 0, 500, 0, -175, 0, 500, 0, -172.5, 0, 500, 0, -170, 0, 500, 0, -167.5, 0, 500, 0, -165, 0, 500, 0, -162.5, 0, 500, 0, -160, 0, 500, 0, -157.5, 0, 500, 0, -155, 0, 500, 0, -152.5, 0, 500, 0, -150, 0, 500, 0, -147.5, 0, 500, 0, -145, 0, 500, 0, -142.5, 0, 500, 0, -140, 0, 500, 0, -137.5, 0, 500, 0, -135, 0, 500, 0, -132.5, 0, 500, 0, -130, 0, 500, 0, -127.5, 0, 500, 0, -125, 0, 500, 0, -122.5, 0, 500, 0, -120, 0, 500, 0, -117.5, 0, 500, 0, -115, 0, 500, 0, -112.5, 0, 500, 0, -110, 0, 500, 0, -109, 0, 500, 0, -108, 0, 500, 0, -107, 0, 500, 0, -106, 0, 500, 0, -105, 0, 500, 0, -104, 0, 500, 0, -103, 0, 500, 0, -102, 0, 500, 0, -101, 0, 500, 0, -100, 0, 500, 0, -99, 0, 500, 0, -98, 0, 500, 0, -97, 0, 500, 0, -96, 0, 500, 0, -95, 0, 500, 0, -94, 0, 500, 0, -93, 0, 500, 0, -92, 0, 500, 0, -91, 0, 500, 0, -90, 0, 500, 0, -89, 0, 500, 0, -88, 0, 500, 0, -87, 0, 500, 0, -86, 0, 500, 0, -85, 0, 500, 0, -84, 0, 500, 0, -83, 0, 500, 0, -82, 0, 500, 0, -81, 0, 500, 0, -80, 0, 500, 0, -79, 0, 500, 0, -78, 0, 500, 0, -77, 0, 500, 0, -76, 0, 500, 0, -75, 0, 500, 0, -74, 0, 500, 0, -73, 0, 500, 0, -72, 0, 500, 0, -71, 0, 500, 0, -70, 0, 500, 0, -69, 0, 500, 0, -68, 0, 500, 0, -67, 0, 500, 0, -66, 0, 500, 0, -65, 0, 500, 0, -64, 0, 500, 0, -63, 0, 500, 0, -62, 0, 500, 0, -61, 0, 500, 0, -60, 0, 500, 0, -59, 0, 500, 0, -58, 0, 500, 0, -57, 0, 500, 0, -56, 0, 500, 0, -55, 0, 500, 0, -54, 0, 500, 0, -53, 0, 500, 0, -52, 0, 500, 0, -51, 0, 500, 0, -50, 0, 500, 0, -49, 0, 500, 0, -48, 0, 500, 0, -47, 0, 500, 0, -46, 0, 500, 0, -45, 0, 500, 0, -44, 0, 500, 0, -43, 0, 500, 0, -42, 0, 500, 0, -41, 0, 500, 0, -40, 0, 500, 0, -39, 0, 500, 0, -38, 0, 500, 0, -37, 0, 500, 0, -36, 0, 500, 0, -35, 0, 500, 0, -34, 0, 500, 0, -33, 0, 500, 0, -32, 0, 500, 0, -31, 0, 500, 0, -30, 0, 500, 0, -29, 0, 500, 0, -28, 0, 500, 0, -27, 0, 500, 0, -26, 0, 500, 0, -25, 0, 500, 0, -24, 0, 500, 0, -23, 0, 500, 0, -22, 0, 500, 0, -21, 0, 500, 0, -20, 0, 500, 0, -19, 0, 500, 0, -18, 0, 500, 0, -17, 0, 500, 0, -16, 0, 500, 0, -15, 0, 500, 0, -14, 0, 500, 0, -13, 0, 500, 0, -12, 0, 500, 0, -11, 0, 500, 0, -10, 0, 500, 0, -9, 0, 500, 0, -8, 0, 500, 0, -7, 0, 500, 0, -6, 0, 500, 0, -5, 0, 500, 0, -4, 0, 500, 0, -3, 0, 500, 0, -2, 0, 500, 0, -1, 0, 500, 0, 0, 0, 500, 0, 1, 0, 500, 0, 2, 0, 500, 0, 3, 0, 500, 0, 4, 0, 500, 0, 5, 0, 500, 0, 6, 0, 500, 0, 7, 0, 500, 0, 8, 0, 500, 0, 9, 0, 500, 0, 10, 0, 500, 0, 11, 0, 500, 0, 12, 0, 500, 0, 13, 0, 500, 0, 14, 0, 500, 0, 15, 0, 500, 0, 16, 0, 500, 0, 17, 0, 500, 0, 18, 0, 500, 0, 19, 0, 500, 0, 20, 0, 500, 0, 21, 0, 500, 0, 22, 0, 500, 0, 23, 0, 500, 0, 24, 0, 500, 0, 25, 0, 500, 0, 26, 0, 500, 0, 27, 0, 500, 0, 28, 0, 500, 0, 29, 0, 500, 0, 30, 0, 500, 0, 31, 0, 500, 0, 32, 0, 500, 0, 33, 0, 500, 0, 34, 0, 500, 0, 35, 0, 500, 0, 36, 0, 500, 0, 37, 0, 500, 0, 38, 0, 500, 0, 39, 0, 500, 0, 40, 0, 500, 0, 41, 0, 500, 0, 42, 0, 500, 0, 43, 0, 500, 0, 44, 0, 500, 0, 45, 0, 500, 0, 46, 0, 500, 0, 47, 0, 500, 0, 48, 0, 500, 0, 49, 0, 500, 0, 50, 0, 500, 0, 51, 0, 500, 0, 52, 0, 500, 0, 53, 0, 500, 0, 54, 0, 500, 0, 55, 0, 500, 0, 56, 0, 500, 0, 57, 0, 500, 0, 58, 0, 500, 0, 59, 0, 500, 0, 60, 0, 500, 0, 61, 0, 500, 0, 62, 0, 500, 0, 63, 0, 500, 0, 64, 0, 500, 0, 65, 0, 500, 0, 66, 0, 500, 0, 67, 0, 500, 0, 68, 0, 500, 0, 69, 0, 500, 0, 70, 0, 500, 0, 71, 0, 500, 0, 72, 0, 500, 0, 73, 0, 500, 0, 74, 0, 500, 0, 75, 0, 500, 0, 76, 0, 500, 0, 77, 0, 500, 0, 78, 0, 500, 0, 79, 0, 500, 0, 80, 0, 500, 0, 81, 0, 500, 0, 82, 0, 500, 0, 83, 0, 500, 0, 84, 0, 500, 0, 85, 0, 500, 0, 86, 0, 500, 0, 87, 0, 500, 0, 88, 0, 500, 0, 89, 0, 500, 0, 90, 0, 500, 0, 91, 0, 500, 0, 92, 0, 500, 0, 93, 0, 500, 0, 94, 0, 500, 0, 95, 0, 500, 0, 96, 0, 500, 0, 97, 0, 500, 0, 98, 0, 500, 0, 99, 0, 500, 0, 100, 0, 500, 0, 101, 0, 500, 0, 102, 0, 500, 0, 103, 0, 500, 0, 104, 0, 500, 0, 105, 0, 500, 0, 106, 0, 500, 0, 107, 0, 500, 0, 108, 0, 500, 0, 109, 0, 500, 0, 110, 0, 500, 0, 112.5, 0, 500, 0, 115, 0, 500, 0, 117.5, 0, 500, 0, 120, 0, 500, 0, 122.5, 0, 500, 0, 125, 0, 500, 0, 127.5, 0, 500, 0, 130, 0, 500, 0, 132.5, 0, 500, 0, 135, 0, 500, 0, 137.5, 0, 500, 0, 140, 0, 500, 0, 142.5, 0, 500, 0, 145, 0, 500, 0, 147.5, 0, 500, 0, 150, 0, 500, 0, 152.5, 0, 500, 0, 155, 0, 500, 0, 157.5, 0, 500, 0, 160, 0, 500, 0, 162.5, 0, 500, 0, 165, 0, 500, 0, 167.5, 0, 500, 0, 170, 0, 500, 0, 172.5, 0, 500, 0, 175, 0, 500, 0, 177.5, 0, 500, 0, 180, 0, 500, 0, 182.5, 0, 500, 0, 185, 0, 500, 0, 187.5, 0, 500, 0, 190, 0, 500, 0, 192.5, 0, 500, 0, 195, 0, 500, 0, 197.5, 0, 500, 0, 200, 0, 500, 0, 202.5, 0, 500, 0, 205, 0, 500, 0, 207.5, 0, 500, 0, 210, 0, 500, 0, 212.5, 0, 500, 0, 215, 0, 500, 0, 217.5, 0, 500, 0, 220, 0, 500, 0, 222.5, 0, 500, 0, 225, 0, 500, 0, 227.5, 0, 500, 0, 230, 0, 500, 0, 232.5, 0, 500, 0, 235, 0, 500, 0, 237.5, 0, 500, 0, 240, 0, 500, 0, 242.5, 0, 500, 0, 245, 0, 500, 0, 247.5, 0, 500, 0, 250, 0, 500, 0, 252.5, 0, 500, 0, 255, 0, 500, 0, 257.5, 0, 500, 0, 260, 0, 500, 0, 262.5, 0, 500, 0, 265, 0, 500, 0, 267.5, 0, 500, 0, 270, 0, 500, 0, 272.5, 0, 500, 0, 275, 0, 500, 0, 277.5, 0, 500, 0, 280, 0, 500, 0, 282.5, 0, 500, 0, 285, 0, 500, 0, 287.5, 0, 500, 0, 290, 0, 500, 0, 292.5, 0, 500, 0, 295, 0, 500, 0, 297.5, 0, 500, 0, 300, 0, 500, 0, 305, 0, 500, 0, 310, 0, 500, 0, 315, 0, 500, 0, 320, 0, 500, 0, 325, 0, 500, 0, 330, 0, 500, 0, 335, 0, 500, 0, 340, 0, 500, 0, 345, 0, 500, 0, 350, 0, 500, 0, 355, 0, 500, 0, 360, 0, 500, 0, 365, 0, 500, 0, 370, 0, 500, 0, 375, 0, 500, 0, 380, 0, 500, 0, 385, 0, 500, 0, 390, 0, 500, 0, 395, 0, 500, 0, 400, 0, 500, 0, 405, 0, 500, 0, 410, 0, 500, 0, 415, 0, 500, 0, 420, 0, 500, 0, 425, 0, 500, 0, 430, 0, 500, 0, 435, 0, 500, 0, 440, 0, 500, 0, 445, 0, 500, 0, 450, 0, 500, 0, 455, 0, 500, 0, 460, 0, 500, 0, 465, 0, 500, 0, 470, 0, 500, 0, 475, 0, 500, 0, 480, 0, 500, 0, 485, 0, 500, 0, 490, 0, 500, 0, 495, 0, 500, 0, 500, 0, 500, 0}

        'designedBfield = New Single() {0, -500, 0, -450, 0}
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, 500, 0, 500, 0, 500, 0, 500, 0, -500}
        designedBsmfield = New Single() {-150}

        '''''''''designedBfield = New Single() {0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}
        ''''''hysteresis 
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}

        'designedBfield = New Single() {0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0}

        '''''ultra small field
        'designedBfield = New Single() {0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0}

        ''''''large field 
        'designedBfield = New Single() {0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -400, 0, -300, 0, -200, 0, -100, 0, 0, 0, 100, 0, 200, 0, 300, 0, 400, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}

        '''''''large field + small field
        'designedBfield = New Single() {0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -480, 0, -460, 0, -440, 0, -420, 0, -400, 0, -380, 0, -360, 0, -340, 0, -320, 0, -300, 0, -280, 0, -260, 0, -240, 0, -220, 0, -200, 0, -180, 0, -160, 0, -140, 0, -120, 0, -100, 0, -80, 0, -60, 0, -40, 0, -20, 0, 0, 0, 20, 0, 40, 0, 60, 0, 80, 0, 100, 0, 120, 0, 140, 0, 160, 0, 180, 0, 200, 0, 220, 0, 240, 0, 260, 0, 280, 0, 300, 0, 320, 0, 340, 0, 360, 0, 380, 0, 400, 0, 420, 0, 440, 0, 460, 0, 480, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}


        'designedBfield = New Single() {0, -600, 0, -580, 0, -560, 0, -540, 0, -520, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 520, 0, 540, 0, 560, 0, 580, 0, 600, 0}

        devicecurrentlist = New Single() {0.000002}



        size = designedBfield.Length()
        devicecurrentlistsize = devicecurrentlist.Length()
        smllcoilsize = designedBsmfield.Length()


        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newDeviceVoltage2 = New Single(size) {}
        designedIsmcoil = New Single(smllcoilsize) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        'KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        Do Until currentlistnum = devicecurrentlistsize

            If devicecurrentlist(currentlistnum) < 0.000001 Then
                y = 0
                fileNum = 0

                inittime = DateTime.Now()

                Try

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                End Try

            Else

                Try
                    kk = 0

                    Do Until kk = smllcoilsize

                        Key2612OFF()
                        System.Threading.Thread.Sleep(500)
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(500)

                        zz = 0
                        Blocalsm = 0
                        Kcoil = 1776

                        Do Until zz = 3
                            Blocalsm = B2_Reading() + Blocalsm
                            System.Threading.Thread.Sleep(3000)
                            zz = zz + 1
                        Loop

                        Blocalsm = -(Blocalsm / 3)

                        xx = 0
                        Do Until xx = smllcoilsize
                            designedIsmcoil(xx) = (designedBsmfield(xx) + Blocalsm) / Ksmcoil
                            xx = xx + 1
                        Loop

                        System.Threading.Thread.Sleep(1000)

                        KEY2612Curr(designedIsmcoil(kk))

                        System.Threading.Thread.Sleep(1000)

                        Key2612ON()

                        fileNum = 0
                        y = 0

                        inittime = DateTime.Now()


                        Do Until y = 100
                            x = 0
                            Blocal = 0
                            z = 0

                            KeiIniVM()

                            'AbortAGI_CH2()
                            AbortKEI_SM()
                            System.Threading.Thread.Sleep(2000)
                            Do Until z = 3
                                Blocal = B2_Reading() + Blocal
                                System.Threading.Thread.Sleep(3000)
                                z = z + 1
                            Loop

                            Blocal = -(Blocal / 3)


                            Do Until x = size
                                designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                                x = x + 1
                            Loop

                            'ONAGI_CH2()
                            ONKEI_SM()
                            System.Threading.Thread.Sleep(1000)

                            'Z_AGICH2(((0 + Blocal) / Kcoil))
                            Z_KEI(((0 + Blocal) / Kcoil))

                            System.Threading.Thread.Sleep(2000)
                            ''''''''check if it is real zero with gradient field on'''''''
                            Bcheck = B2_Reading()

                            Do Until Math.Abs(Bcheck) < 2.2
                                Z_KEI(-0.5)
                                System.Threading.Thread.Sleep(500)
                                B1 = B2_Reading()
                                System.Threading.Thread.Sleep(500)
                                Z_KEI(-0.2)
                                System.Threading.Thread.Sleep(500)
                                B2 = B2_Reading()
                                System.Threading.Thread.Sleep(500)
                                Kcoil = (B2 - B1) / ((-0.2) - (-0.5))
                                System.Threading.Thread.Sleep(500)

                                x = 0
                                Blocal = 0
                                z = 0

                                KeiIniVM()

                                'AbortAGI_CH2()
                                AbortKEI_SM()
                                System.Threading.Thread.Sleep(2000)
                                Do Until z = 3
                                    Blocal = B2_Reading() + Blocal
                                    System.Threading.Thread.Sleep(3000)
                                    z = z + 1
                                Loop

                                Blocal = -(Blocal / 3)


                                Do Until x = size
                                    designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                                    x = x + 1
                                Loop

                                'ONAGI_CH2()
                                ONKEI_SM()
                                System.Threading.Thread.Sleep(1000)

                                'Z_AGICH2(((0 + Blocal) / Kcoil))
                                Z_KEI(((0 + Blocal) / Kcoil))
                                System.Threading.Thread.Sleep(8000)
                                Bcheck = B2_Reading()
                            Loop




                            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                            System.Threading.Thread.Sleep(2000)


                            DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                            System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                            'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                            Z_KEI(designedIcoil(0))

                            System.Threading.Thread.Sleep(2000)

                            x = 0
                            Do Until x = size
                                Diff = 50
                                'Z_AGICH2(designedIcoil(x))
                                Z_KEI(designedIcoil(x))
                                System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                                Diffnum = 0
                                'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                                Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                    Bnow = B2_Reading()
                                    Diff = Math.Abs(Bnow - designedBfield(x))
                                    System.Threading.Thread.Sleep(30)
                                    Diffnum = Diffnum + 1
                                    If Diffnum > 100 Then
                                        If (Bnow - designedBfield(x)) > 0 Then
                                            'Z_AGICH2(designedIcoil(x) - 0.00025)
                                            Z_KEI(designedIcoil(x) - 0.00025)
                                            System.Threading.Thread.Sleep(1000)
                                        ElseIf (Bnow - designedBfield(x)) < 0 Then
                                            'Z_AGICH2(designedIcoil(x) + 0.00025)
                                            Z_KEI(designedIcoil(x) + 0.00025)
                                            System.Threading.Thread.Sleep(1000)
                                        End If
                                    End If

                                Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                                newRealBfield(x) = Bnow
                                newDeviceVoltage(x) = KeiVoltReading()
                                currenttime = DateTime.Now()
                                MeasureInterval(x) = TTimeSpan(currenttime, inittime)

                                System.Threading.Thread.Sleep(1500)
                                newDeviceVoltage2(x) = KeiVoltReading()
                                x = x + 1
                            Loop
                            AbortAGI_CH1()

                            'AbortKEI_4200()

                            'Z_AGICH2(((0 + Blocal) / Kcoil))
                            Z_KEI(((0 + Blocal) / Kcoil))

                            FILETIME = DateTime.Now.ToString()
                            FILETIME = FILETIME.Replace("/", "_")
                            FILETIME = FILETIME.Replace(":", "_")

                            'Filename = FILETIME + "-" + "MRscan.txt"
                            Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + "smll " + designedBsmfield(kk).ToString() + ".txt"

                            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                            Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}{3,-16:E}"
                            objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}", "Bfield", "Voltage", "Voltage2", "Interval")
                            For x = 0 To size - 1
                                objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), newDeviceVoltage2(x), MeasureInterval(x))
                            Next
                            objWriterTrans.Close()

                            y = y + 1
                            fileNum = fileNum + 1
                            System.Threading.Thread.Sleep(10000)
                        Loop

                        kk = kk + 1
                    Loop




                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 100
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop
                End Try
            End If





            currentlistnum = currentlistnum + 1
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortKEI_SM()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()
        System.Threading.Thread.Sleep(5000)
        Key2612OFF()




    End Sub


    Public Sub NewUltraMR33()                            ''''''''''''''''''new recipe of adding a large constant polarising B field, for relaxation time measurement'''''' 
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer, k As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer
        Dim sizeT As Integer
        Dim smllcoilsize As Integer
        Dim currentlistnum As Integer
        Dim kk As Integer, zz As Integer, xx As Integer
        Dim Blocalsm As Integer

        Dim newDeviceVoltage() As Single
        Dim newDeviceVoltage1(,) As Single
        Dim designedBfield() As Single
        Dim designedTime() As Single
        Dim designedBsmfield() As Single
        Dim designedIcoil() As Single
        Dim designedIsmcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bcheck As Single
        Dim B1 As Single, B2 As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim Ksmcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single
        Dim devicecurrentlist() As Single
        Dim devicecurrentlistsize As Integer
        Dim Brev As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        currentlistnum = 0
        Brev = -1
        'Kcoil = 1806.67

        'Kcoil = 1800.163 '''''COIL Z
        'Kcoil = 1644.96 ''''''coil z / device current up
        Kcoil = 1777.6  '''''COIL Z with Keithley source meter
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        Ksmcoil = 367.08 ''''''small coil coefficient
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -500, 0, -400, 0}
        'designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}

        ''''''''''ultra small field
        'designedBfield = New Single() {0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0}

        ''''small field
        'designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}

        ' designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}

        'designedBfield = New Single() {0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}

        ''designedBfield = New Single() {0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -495, 0, 500, 0, -490, 0, 500, 0, -485, 0, 500, 0, -480, 0, 500, 0, -475, 0, 500, 0, -470, 0, 500, 0, -465, 0, 500, 0, -460, 0, 500, 0, -455, 0, 500, 0, -450, 0, 500, 0, -445, 0, 500, 0, -440, 0, 500, 0, -435, 0, 500, 0, -430, 0, 500, 0, -425, 0, 500, 0, -420, 0, 500, 0, -415, 0, 500, 0, -410, 0, 500, 0, -405, 0, 500, 0, -400, 0, 500, 0, -395, 0, 500, 0, -390, 0, 500, 0, -385, 0, 500, 0, -380, 0, 500, 0, -375, 0, 500, 0, -370, 0, 500, 0, -365, 0, 500, 0, -360, 0, 500, 0, -355, 0, 500, 0, -350, 0, 500, 0, -345, 0, 500, 0, -340, 0, 500, 0, -335, 0, 500, 0, -330, 0, 500, 0, -325, 0, 500, 0, -320, 0, 500, 0, -315, 0, 500, 0, -310, 0, 500, 0, -305, 0, 500, 0, -300, 0, 500, 0, -297.5, 0, 500, 0, -295, 0, 500, 0, -292.5, 0, 500, 0, -290, 0, 500, 0, -287.5, 0, 500, 0, -285, 0, 500, 0, -282.5, 0, 500, 0, -280, 0, 500, 0, -277.5, 0, 500, 0, -275, 0, 500, 0, -272.5, 0, 500, 0, -270, 0, 500, 0, -267.5, 0, 500, 0, -265, 0, 500, 0, -262.5, 0, 500, 0, -260, 0, 500, 0, -257.5, 0, 500, 0, -255, 0, 500, 0, -252.5, 0, 500, 0, -250, 0, 500, 0, -247.5, 0, 500, 0, -245, 0, 500, 0, -242.5, 0, 500, 0, -240, 0, 500, 0, -237.5, 0, 500, 0, -235, 0, 500, 0, -232.5, 0, 500, 0, -230, 0, 500, 0, -227.5, 0, 500, 0, -225, 0, 500, 0, -222.5, 0, 500, 0, -220, 0, 500, 0, -217.5, 0, 500, 0, -215, 0, 500, 0, -212.5, 0, 500, 0, -210, 0, 500, 0, -207.5, 0, 500, 0, -205, 0, 500, 0, -202.5, 0, 500, 0, -200, 0, 500, 0, -197.5, 0, 500, 0, -195, 0, 500, 0, -192.5, 0, 500, 0, -190, 0, 500, 0, -187.5, 0, 500, 0, -185, 0, 500, 0, -182.5, 0, 500, 0, -180, 0, 500, 0, -177.5, 0, 500, 0, -175, 0, 500, 0, -172.5, 0, 500, 0, -170, 0, 500, 0, -167.5, 0, 500, 0, -165, 0, 500, 0, -162.5, 0, 500, 0, -160, 0, 500, 0, -157.5, 0, 500, 0, -155, 0, 500, 0, -152.5, 0, 500, 0, -150, 0, 500, 0, -147.5, 0, 500, 0, -145, 0, 500, 0, -142.5, 0, 500, 0, -140, 0, 500, 0, -137.5, 0, 500, 0, -135, 0, 500, 0, -132.5, 0, 500, 0, -130, 0, 500, 0, -127.5, 0, 500, 0, -125, 0, 500, 0, -122.5, 0, 500, 0, -120, 0, 500, 0, -117.5, 0, 500, 0, -115, 0, 500, 0, -112.5, 0, 500, 0, -110, 0, 500, 0, -109, 0, 500, 0, -108, 0, 500, 0, -107, 0, 500, 0, -106, 0, 500, 0, -105, 0, 500, 0, -104, 0, 500, 0, -103, 0, 500, 0, -102, 0, 500, 0, -101, 0, 500, 0, -100, 0, 500, 0, -99, 0, 500, 0, -98, 0, 500, 0, -97, 0, 500, 0, -96, 0, 500, 0, -95, 0, 500, 0, -94, 0, 500, 0, -93, 0, 500, 0, -92, 0, 500, 0, -91, 0, 500, 0, -90, 0, 500, 0, -89, 0, 500, 0, -88, 0, 500, 0, -87, 0, 500, 0, -86, 0, 500, 0, -85, 0, 500, 0, -84, 0, 500, 0, -83, 0, 500, 0, -82, 0, 500, 0, -81, 0, 500, 0, -80, 0, 500, 0, -79, 0, 500, 0, -78, 0, 500, 0, -77, 0, 500, 0, -76, 0, 500, 0, -75, 0, 500, 0, -74, 0, 500, 0, -73, 0, 500, 0, -72, 0, 500, 0, -71, 0, 500, 0, -70, 0, 500, 0, -69, 0, 500, 0, -68, 0, 500, 0, -67, 0, 500, 0, -66, 0, 500, 0, -65, 0, 500, 0, -64, 0, 500, 0, -63, 0, 500, 0, -62, 0, 500, 0, -61, 0, 500, 0, -60, 0, 500, 0, -59, 0, 500, 0, -58, 0, 500, 0, -57, 0, 500, 0, -56, 0, 500, 0, -55, 0, 500, 0, -54, 0, 500, 0, -53, 0, 500, 0, -52, 0, 500, 0, -51, 0, 500, 0, -50, 0, 500, 0, -49, 0, 500, 0, -48, 0, 500, 0, -47, 0, 500, 0, -46, 0, 500, 0, -45, 0, 500, 0, -44, 0, 500, 0, -43, 0, 500, 0, -42, 0, 500, 0, -41, 0, 500, 0, -40, 0, 500, 0, -39, 0, 500, 0, -38, 0, 500, 0, -37, 0, 500, 0, -36, 0, 500, 0, -35, 0, 500, 0, -34, 0, 500, 0, -33, 0, 500, 0, -32, 0, 500, 0, -31, 0, 500, 0, -30, 0, 500, 0, -29, 0, 500, 0, -28, 0, 500, 0, -27, 0, 500, 0, -26, 0, 500, 0, -25, 0, 500, 0, -24, 0, 500, 0, -23, 0, 500, 0, -22, 0, 500, 0, -21, 0, 500, 0, -20, 0, 500, 0, -19, 0, 500, 0, -18, 0, 500, 0, -17, 0, 500, 0, -16, 0, 500, 0, -15, 0, 500, 0, -14, 0, 500, 0, -13, 0, 500, 0, -12, 0, 500, 0, -11, 0, 500, 0, -10, 0, 500, 0, -9, 0, 500, 0, -8, 0, 500, 0, -7, 0, 500, 0, -6, 0, 500, 0, -5, 0, 500, 0, -4, 0, 500, 0, -3, 0, 500, 0, -2, 0, 500, 0, -1, 0, 500, 0, 0, 0, 500, 0, 1, 0, 500, 0, 2, 0, 500, 0, 3, 0, 500, 0, 4, 0, 500, 0, 5, 0, 500, 0, 6, 0, 500, 0, 7, 0, 500, 0, 8, 0, 500, 0, 9, 0, 500, 0, 10, 0, 500, 0, 11, 0, 500, 0, 12, 0, 500, 0, 13, 0, 500, 0, 14, 0, 500, 0, 15, 0, 500, 0, 16, 0, 500, 0, 17, 0, 500, 0, 18, 0, 500, 0, 19, 0, 500, 0, 20, 0, 500, 0, 21, 0, 500, 0, 22, 0, 500, 0, 23, 0, 500, 0, 24, 0, 500, 0, 25, 0, 500, 0, 26, 0, 500, 0, 27, 0, 500, 0, 28, 0, 500, 0, 29, 0, 500, 0, 30, 0, 500, 0, 31, 0, 500, 0, 32, 0, 500, 0, 33, 0, 500, 0, 34, 0, 500, 0, 35, 0, 500, 0, 36, 0, 500, 0, 37, 0, 500, 0, 38, 0, 500, 0, 39, 0, 500, 0, 40, 0, 500, 0, 41, 0, 500, 0, 42, 0, 500, 0, 43, 0, 500, 0, 44, 0, 500, 0, 45, 0, 500, 0, 46, 0, 500, 0, 47, 0, 500, 0, 48, 0, 500, 0, 49, 0, 500, 0, 50, 0, 500, 0, 51, 0, 500, 0, 52, 0, 500, 0, 53, 0, 500, 0, 54, 0, 500, 0, 55, 0, 500, 0, 56, 0, 500, 0, 57, 0, 500, 0, 58, 0, 500, 0, 59, 0, 500, 0, 60, 0, 500, 0, 61, 0, 500, 0, 62, 0, 500, 0, 63, 0, 500, 0, 64, 0, 500, 0, 65, 0, 500, 0, 66, 0, 500, 0, 67, 0, 500, 0, 68, 0, 500, 0, 69, 0, 500, 0, 70, 0, 500, 0, 71, 0, 500, 0, 72, 0, 500, 0, 73, 0, 500, 0, 74, 0, 500, 0, 75, 0, 500, 0, 76, 0, 500, 0, 77, 0, 500, 0, 78, 0, 500, 0, 79, 0, 500, 0, 80, 0, 500, 0, 81, 0, 500, 0, 82, 0, 500, 0, 83, 0, 500, 0, 84, 0, 500, 0, 85, 0, 500, 0, 86, 0, 500, 0, 87, 0, 500, 0, 88, 0, 500, 0, 89, 0, 500, 0, 90, 0, 500, 0, 91, 0, 500, 0, 92, 0, 500, 0, 93, 0, 500, 0, 94, 0, 500, 0, 95, 0, 500, 0, 96, 0, 500, 0, 97, 0, 500, 0, 98, 0, 500, 0, 99, 0, 500, 0, 100, 0, 500, 0, 101, 0, 500, 0, 102, 0, 500, 0, 103, 0, 500, 0, 104, 0, 500, 0, 105, 0, 500, 0, 106, 0, 500, 0, 107, 0, 500, 0, 108, 0, 500, 0, 109, 0, 500, 0, 110, 0, 500, 0, 112.5, 0, 500, 0, 115, 0, 500, 0, 117.5, 0, 500, 0, 120, 0, 500, 0, 122.5, 0, 500, 0, 125, 0, 500, 0, 127.5, 0, 500, 0, 130, 0, 500, 0, 132.5, 0, 500, 0, 135, 0, 500, 0, 137.5, 0, 500, 0, 140, 0, 500, 0, 142.5, 0, 500, 0, 145, 0, 500, 0, 147.5, 0, 500, 0, 150, 0, 500, 0, 152.5, 0, 500, 0, 155, 0, 500, 0, 157.5, 0, 500, 0, 160, 0, 500, 0, 162.5, 0, 500, 0, 165, 0, 500, 0, 167.5, 0, 500, 0, 170, 0, 500, 0, 172.5, 0, 500, 0, 175, 0, 500, 0, 177.5, 0, 500, 0, 180, 0, 500, 0, 182.5, 0, 500, 0, 185, 0, 500, 0, 187.5, 0, 500, 0, 190, 0, 500, 0, 192.5, 0, 500, 0, 195, 0, 500, 0, 197.5, 0, 500, 0, 200, 0, 500, 0, 202.5, 0, 500, 0, 205, 0, 500, 0, 207.5, 0, 500, 0, 210, 0, 500, 0, 212.5, 0, 500, 0, 215, 0, 500, 0, 217.5, 0, 500, 0, 220, 0, 500, 0, 222.5, 0, 500, 0, 225, 0, 500, 0, 227.5, 0, 500, 0, 230, 0, 500, 0, 232.5, 0, 500, 0, 235, 0, 500, 0, 237.5, 0, 500, 0, 240, 0, 500, 0, 242.5, 0, 500, 0, 245, 0, 500, 0, 247.5, 0, 500, 0, 250, 0, 500, 0, 252.5, 0, 500, 0, 255, 0, 500, 0, 257.5, 0, 500, 0, 260, 0, 500, 0, 262.5, 0, 500, 0, 265, 0, 500, 0, 267.5, 0, 500, 0, 270, 0, 500, 0, 272.5, 0, 500, 0, 275, 0, 500, 0, 277.5, 0, 500, 0, 280, 0, 500, 0, 282.5, 0, 500, 0, 285, 0, 500, 0, 287.5, 0, 500, 0, 290, 0, 500, 0, 292.5, 0, 500, 0, 295, 0, 500, 0, 297.5, 0, 500, 0, 300, 0, 500, 0, 305, 0, 500, 0, 310, 0, 500, 0, 315, 0, 500, 0, 320, 0, 500, 0, 325, 0, 500, 0, 330, 0, 500, 0, 335, 0, 500, 0, 340, 0, 500, 0, 345, 0, 500, 0, 350, 0, 500, 0, 355, 0, 500, 0, 360, 0, 500, 0, 365, 0, 500, 0, 370, 0, 500, 0, 375, 0, 500, 0, 380, 0, 500, 0, 385, 0, 500, 0, 390, 0, 500, 0, 395, 0, 500, 0, 400, 0, 500, 0, 405, 0, 500, 0, 410, 0, 500, 0, 415, 0, 500, 0, 420, 0, 500, 0, 425, 0, 500, 0, 430, 0, 500, 0, 435, 0, 500, 0, 440, 0, 500, 0, 445, 0, 500, 0, 450, 0, 500, 0, 455, 0, 500, 0, 460, 0, 500, 0, 465, 0, 500, 0, 470, 0, 500, 0, 475, 0, 500, 0, 480, 0, 500, 0, 485, 0, 500, 0, 490, 0, 500, 0, 495, 0, 500, 0, 500, 0, 500, 0}
        'designedBfield = New Single() {0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -250, 0, 500, 0, -200, 0, 500, 0, 200, 0, 500, 0, 250, 0, 500, 0}
        designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -250, 0, -500, 0, -200, 0, -500, 0, 200, 0, -500, 0, 250, 0, -500, 0}
        designedTime = New Single() {1500, 4500, 13500, 40500, 121500}

        ''designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -500, 0, -490, 0, -500, 0, -485, 0, -500, 0, -480, 0, -500, 0, -475, 0, -500, 0, -470, 0, -500, 0, -465, 0, -500, 0, -460, 0, -500, 0, -455, 0, -500, 0, -450, 0, -500, 0, -445, 0, -500, 0, -440, 0, -500, 0, -435, 0, -500, 0, -430, 0, -500, 0, -425, 0, -500, 0, -420, 0, -500, 0, -415, 0, -500, 0, -410, 0, -500, 0, -405, 0, -500, 0, -400, 0, -500, 0, -395, 0, -500, 0, -390, 0, -500, 0, -385, 0, -500, 0, -380, 0, -500, 0, -375, 0, -500, 0, -370, 0, -500, 0, -365, 0, -500, 0, -360, 0, -500, 0, -355, 0, -500, 0, -350, 0, -500, 0, -345, 0, -500, 0, -340, 0, -500, 0, -335, 0, -500, 0, -330, 0, -500, 0, -325, 0, -500, 0, -320, 0, -500, 0, -315, 0, -500, 0, -310, 0, -500, 0, -305, 0, -500, 0, -300, 0, -500, 0, -297.5, 0, -500, 0, -295, 0, -500, 0, -292.5, 0, -500, 0, -290, 0, -500, 0, -287.5, 0, -500, 0, -285, 0, -500, 0, -282.5, 0, -500, 0, -280, 0, -500, 0, -277.5, 0, -500, 0, -275, 0, -500, 0, -272.5, 0, -500, 0, -270, 0, -500, 0, -267.5, 0, -500, 0, -265, 0, -500, 0, -262.5, 0, -500, 0, -260, 0, -500, 0, -257.5, 0, -500, 0, -255, 0, -500, 0, -252.5, 0, -500, 0, -250, 0, -500, 0, -247.5, 0, -500, 0, -245, 0, -500, 0, -242.5, 0, -500, 0, -240, 0, -500, 0, -237.5, 0, -500, 0, -235, 0, -500, 0, -232.5, 0, -500, 0, -230, 0, -500, 0, -227.5, 0, -500, 0, -225, 0, -500, 0, -222.5, 0, -500, 0, -220, 0, -500, 0, -217.5, 0, -500, 0, -215, 0, -500, 0, -212.5, 0, -500, 0, -210, 0, -500, 0, -207.5, 0, -500, 0, -205, 0, -500, 0, -202.5, 0, -500, 0, -200, 0, -500, 0, -197.5, 0, -500, 0, -195, 0, -500, 0, -192.5, 0, -500, 0, -190, 0, -500, 0, -187.5, 0, -500, 0, -185, 0, -500, 0, -182.5, 0, -500, 0, -180, 0, -500, 0, -177.5, 0, -500, 0, -175, 0, -500, 0, -172.5, 0, -500, 0, -170, 0, -500, 0, -167.5, 0, -500, 0, -165, 0, -500, 0, -162.5, 0, -500, 0, -160, 0, -500, 0, -157.5, 0, -500, 0, -155, 0, -500, 0, -152.5, 0, -500, 0, -150, 0, -500, 0, -147.5, 0, -500, 0, -145, 0, -500, 0, -142.5, 0, -500, 0, -140, 0, -500, 0, -137.5, 0, -500, 0, -135, 0, -500, 0, -132.5, 0, -500, 0, -130, 0, -500, 0, -127.5, 0, -500, 0, -125, 0, -500, 0, -122.5, 0, -500, 0, -120, 0, -500, 0, -117.5, 0, -500, 0, -115, 0, -500, 0, -112.5, 0, -500, 0, -110, 0, -500, 0, -109, 0, -500, 0, -108, 0, -500, 0, -107, 0, -500, 0, -106, 0, -500, 0, -105, 0, -500, 0, -104, 0, -500, 0, -103, 0, -500, 0, -102, 0, -500, 0, -101, 0, -500, 0, -100, 0, -500, 0, -99, 0, -500, 0, -98, 0, -500, 0, -97, 0, -500, 0, -96, 0, -500, 0, -95, 0, -500, 0, -94, 0, -500, 0, -93, 0, -500, 0, -92, 0, -500, 0, -91, 0, -500, 0, -90, 0, -500, 0, -89, 0, -500, 0, -88, 0, -500, 0, -87, 0, -500, 0, -86, 0, -500, 0, -85, 0, -500, 0, -84, 0, -500, 0, -83, 0, -500, 0, -82, 0, -500, 0, -81, 0, -500, 0, -80, 0, -500, 0, -79, 0, -500, 0, -78, 0, -500, 0, -77, 0, -500, 0, -76, 0, -500, 0, -75, 0, -500, 0, -74, 0, -500, 0, -73, 0, -500, 0, -72, 0, -500, 0, -71, 0, -500, 0, -70, 0, -500, 0, -69, 0, -500, 0, -68, 0, -500, 0, -67, 0, -500, 0, -66, 0, -500, 0, -65, 0, -500, 0, -64, 0, -500, 0, -63, 0, -500, 0, -62, 0, -500, 0, -61, 0, -500, 0, -60, 0, -500, 0, -59, 0, -500, 0, -58, 0, -500, 0, -57, 0, -500, 0, -56, 0, -500, 0, -55, 0, -500, 0, -54, 0, -500, 0, -53, 0, -500, 0, -52, 0, -500, 0, -51, 0, -500, 0, -50, 0, -500, 0, -49, 0, -500, 0, -48, 0, -500, 0, -47, 0, -500, 0, -46, 0, -500, 0, -45, 0, -500, 0, -44, 0, -500, 0, -43, 0, -500, 0, -42, 0, -500, 0, -41, 0, -500, 0, -40, 0, -500, 0, -39, 0, -500, 0, -38, 0, -500, 0, -37, 0, -500, 0, -36, 0, -500, 0, -35, 0, -500, 0, -34, 0, -500, 0, -33, 0, -500, 0, -32, 0, -500, 0, -31, 0, -500, 0, -30, 0, -500, 0, -29, 0, -500, 0, -28, 0, -500, 0, -27, 0, -500, 0, -26, 0, -500, 0, -25, 0, -500, 0, -24, 0, -500, 0, -23, 0, -500, 0, -22, 0, -500, 0, -21, 0, -500, 0, -20, 0, -500, 0, -19, 0, -500, 0, -18, 0, -500, 0, -17, 0, -500, 0, -16, 0, -500, 0, -15, 0, -500, 0, -14, 0, -500, 0, -13, 0, -500, 0, -12, 0, -500, 0, -11, 0, -500, 0, -10, 0, -500, 0, -9, 0, -500, 0, -8, 0, -500, 0, -7, 0, -500, 0, -6, 0, -500, 0, -5, 0, -500, 0, -4, 0, -500, 0, -3, 0, -500, 0, -2, 0, -500, 0, -1, 0, -500, 0, 0, 0, -500, 0, 1, 0, -500, 0, 2, 0, -500, 0, 3, 0, -500, 0, 4, 0, -500, 0, 5, 0, -500, 0, 6, 0, -500, 0, 7, 0, -500, 0, 8, 0, -500, 0, 9, 0, -500, 0, 10, 0, -500, 0, 11, 0, -500, 0, 12, 0, -500, 0, 13, 0, -500, 0, 14, 0, -500, 0, 15, 0, -500, 0, 16, 0, -500, 0, 17, 0, -500, 0, 18, 0, -500, 0, 19, 0, -500, 0, 20, 0, -500, 0, 21, 0, -500, 0, 22, 0, -500, 0, 23, 0, -500, 0, 24, 0, -500, 0, 25, 0, -500, 0, 26, 0, -500, 0, 27, 0, -500, 0, 28, 0, -500, 0, 29, 0, -500, 0, 30, 0, -500, 0, 31, 0, -500, 0, 32, 0, -500, 0, 33, 0, -500, 0, 34, 0, -500, 0, 35, 0, -500, 0, 36, 0, -500, 0, 37, 0, -500, 0, 38, 0, -500, 0, 39, 0, -500, 0, 40, 0, -500, 0, 41, 0, -500, 0, 42, 0, -500, 0, 43, 0, -500, 0, 44, 0, -500, 0, 45, 0, -500, 0, 46, 0, -500, 0, 47, 0, -500, 0, 48, 0, -500, 0, 49, 0, -500, 0, 50, 0, -500, 0, 51, 0, -500, 0, 52, 0, -500, 0, 53, 0, -500, 0, 54, 0, -500, 0, 55, 0, -500, 0, 56, 0, -500, 0, 57, 0, -500, 0, 58, 0, -500, 0, 59, 0, -500, 0, 60, 0, -500, 0, 61, 0, -500, 0, 62, 0, -500, 0, 63, 0, -500, 0, 64, 0, -500, 0, 65, 0, -500, 0, 66, 0, -500, 0, 67, 0, -500, 0, 68, 0, -500, 0, 69, 0, -500, 0, 70, 0, -500, 0, 71, 0, -500, 0, 72, 0, -500, 0, 73, 0, -500, 0, 74, 0, -500, 0, 75, 0, -500, 0, 76, 0, -500, 0, 77, 0, -500, 0, 78, 0, -500, 0, 79, 0, -500, 0, 80, 0, -500, 0, 81, 0, -500, 0, 82, 0, -500, 0, 83, 0, -500, 0, 84, 0, -500, 0, 85, 0, -500, 0, 86, 0, -500, 0, 87, 0, -500, 0, 88, 0, -500, 0, 89, 0, -500, 0, 90, 0, -500, 0, 91, 0, -500, 0, 92, 0, -500, 0, 93, 0, -500, 0, 94, 0, -500, 0, 95, 0, -500, 0, 96, 0, -500, 0, 97, 0, -500, 0, 98, 0, -500, 0, 99, 0, -500, 0, 100, 0, -500, 0, 101, 0, -500, 0, 102, 0, -500, 0, 103, 0, -500, 0, 104, 0, -500, 0, 105, 0, -500, 0, 106, 0, -500, 0, 107, 0, -500, 0, 108, 0, -500, 0, 109, 0, -500, 0, 110, 0, -500, 0, 112.5, 0, -500, 0, 115, 0, -500, 0, 117.5, 0, -500, 0, 120, 0, -500, 0, 122.5, 0, -500, 0, 125, 0, -500, 0, 127.5, 0, -500, 0, 130, 0, -500, 0, 132.5, 0, -500, 0, 135, 0, -500, 0, 137.5, 0, -500, 0, 140, 0, -500, 0, 142.5, 0, -500, 0, 145, 0, -500, 0, 147.5, 0, -500, 0, 150, 0, -500, 0, 152.5, 0, -500, 0, 155, 0, -500, 0, 157.5, 0, -500, 0, 160, 0, -500, 0, 162.5, 0, -500, 0, 165, 0, -500, 0, 167.5, 0, -500, 0, 170, 0, -500, 0, 172.5, 0, -500, 0, 175, 0, -500, 0, 177.5, 0, -500, 0, 180, 0, -500, 0, 182.5, 0, -500, 0, 185, 0, -500, 0, 187.5, 0, -500, 0, 190, 0, -500, 0, 192.5, 0, -500, 0, 195, 0, -500, 0, 197.5, 0, -500, 0, 200, 0, -500, 0, 202.5, 0, -500, 0, 205, 0, -500, 0, 207.5, 0, -500, 0, 210, 0, -500, 0, 212.5, 0, -500, 0, 215, 0, -500, 0, 217.5, 0, -500, 0, 220, 0, -500, 0, 222.5, 0, -500, 0, 225, 0, -500, 0, 227.5, 0, -500, 0, 230, 0, -500, 0, 232.5, 0, -500, 0, 235, 0, -500, 0, 237.5, 0, -500, 0, 240, 0, -500, 0, 242.5, 0, -500, 0, 245, 0, -500, 0, 247.5, 0, -500, 0, 250, 0, -500, 0, 252.5, 0, -500, 0, 255, 0, -500, 0, 257.5, 0, -500, 0, 260, 0, -500, 0, 262.5, 0, -500, 0, 265, 0, -500, 0, 267.5, 0, -500, 0, 270, 0, -500, 0, 272.5, 0, -500, 0, 275, 0, -500, 0, 277.5, 0, -500, 0, 280, 0, -500, 0, 282.5, 0, -500, 0, 285, 0, -500, 0, 287.5, 0, -500, 0, 290, 0, -500, 0, 292.5, 0, -500, 0, 295, 0, -500, 0, 297.5, 0, -500, 0, 300, 0, -500, 0, 305, 0, -500, 0, 310, 0, -500, 0, 315, 0, -500, 0, 320, 0, -500, 0, 325, 0, -500, 0, 330, 0, -500, 0, 335, 0, -500, 0, 340, 0, -500, 0, 345, 0, -500, 0, 350, 0, -500, 0, 355, 0, -500, 0, 360, 0, -500, 0, 365, 0, -500, 0, 370, 0, -500, 0, 375, 0, -500, 0, 380, 0, -500, 0, 385, 0, -500, 0, 390, 0, -500, 0, 395, 0, -500, 0, 400, 0, -500, 0, 405, 0, -500, 0, 410, 0, -500, 0, 415, 0, -500, 0, 420, 0, -500, 0, 425, 0, -500, 0, 430, 0, -500, 0, 435, 0, -500, 0, 440, 0, -500, 0, 445, 0, -500, 0, 450, 0, -500, 0, 455, 0, -500, 0, 460, 0, -500, 0, 465, 0, -500, 0, 470, 0, -500, 0, 475, 0, -500, 0, 480, 0, -500, 0, 485, 0, -500, 0, 490, 0, -500, 0, 495, 0, -500, 0, 500, 0, -500, 0}

        'designedBfield = New Single() {0, -500, 0, -450, 0}
        'designedTime = New Single() {1000, 1500, 2000, 2500, 3000}
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, 500, 0, 500, 0, 500, 0, 500, 0, -500}
        designedBsmfield = New Single() {-150}

        '''''''''designedBfield = New Single() {0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}
        ''''''hysteresis 
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}

        'designedBfield = New Single() {0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0}

        '''''ultra small field
        'designedBfield = New Single() {0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0}

        ''''''large field 
        'designedBfield = New Single() {0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -400, 0, -300, 0, -200, 0, -100, 0, 0, 0, 100, 0, 200, 0, 300, 0, 400, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}

        '''''''large field + small field
        'designedBfield = New Single() {0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -480, 0, -460, 0, -440, 0, -420, 0, -400, 0, -380, 0, -360, 0, -340, 0, -320, 0, -300, 0, -280, 0, -260, 0, -240, 0, -220, 0, -200, 0, -180, 0, -160, 0, -140, 0, -120, 0, -100, 0, -80, 0, -60, 0, -40, 0, -20, 0, 0, 0, 20, 0, 40, 0, 60, 0, 80, 0, 100, 0, 120, 0, 140, 0, 160, 0, 180, 0, 200, 0, 220, 0, 240, 0, 260, 0, 280, 0, 300, 0, 320, 0, 340, 0, 360, 0, 380, 0, 400, 0, 420, 0, 440, 0, 460, 0, 480, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}


        'designedBfield = New Single() {0, -600, 0, -580, 0, -560, 0, -540, 0, -520, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 520, 0, 540, 0, 560, 0, 580, 0, 600, 0}

        devicecurrentlist = New Single() {0.000002}



        size = designedBfield.Length()
        sizeT = designedTime.Length()
        devicecurrentlistsize = devicecurrentlist.Length()
        smllcoilsize = designedBsmfield.Length()


        newDeviceVoltage = New Single(size) {}
        newDeviceVoltage1 = New Single(size, sizeT) {}
        designedIcoil = New Single(size) {}
        designedIsmcoil = New Single(smllcoilsize) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        'KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        Do Until currentlistnum = devicecurrentlistsize

            If devicecurrentlist(currentlistnum) < 0.000001 Then
                y = 0
                fileNum = 0

                inittime = DateTime.Now()

                Try

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                End Try

            Else

                Try
                    kk = 0

                    Do Until kk = smllcoilsize

                        Key2612OFF()
                        System.Threading.Thread.Sleep(500)
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(500)

                        zz = 0
                        Blocalsm = 0
                        Kcoil = 1777.6

                        Do Until zz = 3
                            Blocalsm = B2_Reading() + Blocalsm
                            System.Threading.Thread.Sleep(3000)
                            zz = zz + 1
                        Loop

                        Blocalsm = -(Blocalsm / 3)

                        xx = 0
                        Do Until xx = smllcoilsize
                            designedIsmcoil(xx) = (designedBsmfield(xx) + Blocalsm) / Ksmcoil
                            xx = xx + 1
                        Loop

                        System.Threading.Thread.Sleep(1000)

                        KEY2612Curr(designedIsmcoil(kk))

                        System.Threading.Thread.Sleep(1000)

                        Key2612ON()

                        fileNum = 0
                        y = 0

                        inittime = DateTime.Now()


                        Do Until y = 100
                            x = 0
                            Blocal = 0
                            z = 0

                            KeiIniVM()

                            'AbortAGI_CH2()
                            AbortKEI_SM()
                            System.Threading.Thread.Sleep(2000)
                            Do Until z = 3
                                Blocal = B2_Reading() + Blocal
                                System.Threading.Thread.Sleep(3000)
                                z = z + 1
                            Loop

                            Blocal = -(Blocal / 3)


                            Do Until x = size
                                designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                                x = x + 1
                            Loop

                            'ONAGI_CH2()
                            ONKEI_SM()
                            System.Threading.Thread.Sleep(1000)

                            'Z_AGICH2(((0 + Blocal) / Kcoil))
                            Z_KEI(((0 + Blocal) / Kcoil))

                            System.Threading.Thread.Sleep(2000)
                            ''''''''check if it is real zero with gradient field on'''''''
                            Bcheck = B2_Reading()

                            Do Until Math.Abs(Bcheck) < 2.2
                                Z_KEI(-0.5)
                                System.Threading.Thread.Sleep(500)
                                B1 = B2_Reading()
                                System.Threading.Thread.Sleep(500)
                                Z_KEI(-0.2)
                                System.Threading.Thread.Sleep(500)
                                B2 = B2_Reading()
                                System.Threading.Thread.Sleep(500)
                                Kcoil = (B2 - B1) / ((-0.2) - (-0.5))
                                System.Threading.Thread.Sleep(500)

                                x = 0
                                Blocal = 0
                                z = 0

                                KeiIniVM()

                                'AbortAGI_CH2()
                                AbortKEI_SM()
                                System.Threading.Thread.Sleep(2000)
                                Do Until z = 3
                                    Blocal = B2_Reading() + Blocal
                                    System.Threading.Thread.Sleep(3000)
                                    z = z + 1
                                Loop

                                Blocal = -(Blocal / 3)


                                Do Until x = size
                                    designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                                    x = x + 1
                                Loop

                                'ONAGI_CH2()
                                ONKEI_SM()
                                System.Threading.Thread.Sleep(1000)

                                'Z_AGICH2(((0 + Blocal) / Kcoil))
                                Z_KEI(((0 + Blocal) / Kcoil))
                                System.Threading.Thread.Sleep(8000)
                                Bcheck = B2_Reading()
                            Loop




                            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                            System.Threading.Thread.Sleep(2000)


                            DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                            System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                            'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                            Z_KEI(designedIcoil(0))

                            System.Threading.Thread.Sleep(2000)

                            k = 0

                            Do Until k = sizeT
                                x = 0
                                Do Until x = size
                                    Diff = 50
                                    'Z_AGICH2(designedIcoil(x))
                                    Z_KEI(designedIcoil(x))
                                    System.Threading.Thread.Sleep(designedTime(k))     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                                    Diffnum = 0
                                    'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                                    Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                        Bnow = B2_Reading()
                                        Diff = Math.Abs(Bnow - designedBfield(x))
                                        System.Threading.Thread.Sleep(30)
                                        Diffnum = Diffnum + 1
                                        If Diffnum > 100 Then
                                            If (Bnow - designedBfield(x)) > 0 Then
                                                'Z_AGICH2(designedIcoil(x) - 0.00025)
                                                Z_KEI(designedIcoil(x) - 0.00025)
                                                System.Threading.Thread.Sleep(1000)
                                            ElseIf (Bnow - designedBfield(x)) < 0 Then
                                                'Z_AGICH2(designedIcoil(x) + 0.00025)
                                                Z_KEI(designedIcoil(x) + 0.00025)
                                                System.Threading.Thread.Sleep(1000)
                                            End If
                                        End If

                                    Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                                    newRealBfield(x) = Bnow
                                    newDeviceVoltage1(x, k) = KeiVoltReading()
                                    currenttime = DateTime.Now()
                                    MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                                    x = x + 1
                                Loop
                                k = k + 1
                            Loop


                            AbortAGI_CH1()

                            'AbortKEI_4200()

                            'Z_AGICH2(((0 + Blocal) / Kcoil))
                            Z_KEI(((0 + Blocal) / Kcoil))

                            FILETIME = DateTime.Now.ToString()
                            FILETIME = FILETIME.Replace("/", "_")
                            FILETIME = FILETIME.Replace(":", "_")

                            'Filename = FILETIME + "-" + "MRscan.txt"
                            Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + "smll " + designedBsmfield(kk).ToString() + ".txt"

                            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                            Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}{3,-16:E}{4,-16:E}{5,-16:E}"
                            objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}{4,-16}{5,-16}", "Bfield", "Voltage1.5s", "Voltage4.5s", "Voltage13.5s", "Voltage40.5s", "Voltage121.5s")
                            For x = 0 To size - 1
                                objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage1(x, 0), newDeviceVoltage1(x, 1), newDeviceVoltage1(x, 2), newDeviceVoltage1(x, 3), newDeviceVoltage1(x, 4))
                            Next
                            objWriterTrans.Close()

                            y = y + 1
                            fileNum = fileNum + 1
                            System.Threading.Thread.Sleep(10000)
                        Loop

                        kk = kk + 1
                    Loop




                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 100
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop
                End Try
            End If





            currentlistnum = currentlistnum + 1
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortKEI_SM()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()
        System.Threading.Thread.Sleep(5000)
        Key2612OFF()




    End Sub

    Public Sub NewUltraMR34()                            ''''''''''''''''''new recipe of adding a large constant polarising B field, for relaxation time measurement  2'''''' 
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer, k As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer
        Dim smllcoilsize As Integer
        Dim currentlistnum As Integer
        Dim kk As Integer, zz As Integer, xx As Integer
        Dim Blocalsm As Integer

        Dim newDeviceVoltage() As Single
        Dim newDeviceVoltage1(,) As Single
        Dim designedBfield() As Single
        Dim designedBsmfield() As Single
        Dim designedIcoil() As Single
        Dim designedIsmcoil() As Single
        Dim newRealBfield() As Single
        Dim newRealBfield1(,) As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bcheck As Single
        Dim B1 As Single, B2 As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim Ksmcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single
        Dim devicecurrentlist() As Single
        Dim devicecurrentlistsize As Integer
        Dim Brev As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        currentlistnum = 0
        Brev = -1
        'Kcoil = 1806.67

        'Kcoil = 1800.163 '''''COIL Z
        'Kcoil = 1644.96 ''''''coil z / device current up
        Kcoil = 1778.3  '''''COIL Z with Keithley source meter
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        Ksmcoil = 163.61 ''''''small coil coefficient
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -500, 0, -400, 0}
        'designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}

        ''''''''''ultra small field
        'designedBfield = New Single() {0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0}

        ''''small field
        'designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}

        ' designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}

        'designedBfield = New Single() {0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}

        'designedBfield = New Single() {0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -500, 0, 500, 0, -495, 0, 500, 0, -490, 0, 500, 0, -485, 0, 500, 0, -480, 0, 500, 0, -475, 0, 500, 0, -470, 0, 500, 0, -465, 0, 500, 0, -460, 0, 500, 0, -455, 0, 500, 0, -450, 0, 500, 0, -445, 0, 500, 0, -440, 0, 500, 0, -435, 0, 500, 0, -430, 0, 500, 0, -425, 0, 500, 0, -420, 0, 500, 0, -415, 0, 500, 0, -410, 0, 500, 0, -405, 0, 500, 0, -400, 0, 500, 0, -395, 0, 500, 0, -390, 0, 500, 0, -385, 0, 500, 0, -380, 0, 500, 0, -375, 0, 500, 0, -370, 0, 500, 0, -365, 0, 500, 0, -360, 0, 500, 0, -355, 0, 500, 0, -350, 0, 500, 0, -345, 0, 500, 0, -340, 0, 500, 0, -335, 0, 500, 0, -330, 0, 500, 0, -325, 0, 500, 0, -320, 0, 500, 0, -315, 0, 500, 0, -310, 0, 500, 0, -305, 0, 500, 0, -300, 0, 500, 0, -297.5, 0, 500, 0, -295, 0, 500, 0, -292.5, 0, 500, 0, -290, 0, 500, 0, -287.5, 0, 500, 0, -285, 0, 500, 0, -282.5, 0, 500, 0, -280, 0, 500, 0, -277.5, 0, 500, 0, -275, 0, 500, 0, -272.5, 0, 500, 0, -270, 0, 500, 0, -267.5, 0, 500, 0, -265, 0, 500, 0, -262.5, 0, 500, 0, -260, 0, 500, 0, -257.5, 0, 500, 0, -255, 0, 500, 0, -252.5, 0, 500, 0, -250, 0, 500, 0, -247.5, 0, 500, 0, -245, 0, 500, 0, -242.5, 0, 500, 0, -240, 0, 500, 0, -237.5, 0, 500, 0, -235, 0, 500, 0, -232.5, 0, 500, 0, -230, 0, 500, 0, -227.5, 0, 500, 0, -225, 0, 500, 0, -222.5, 0, 500, 0, -220, 0, 500, 0, -217.5, 0, 500, 0, -215, 0, 500, 0, -212.5, 0, 500, 0, -210, 0, 500, 0, -207.5, 0, 500, 0, -205, 0, 500, 0, -202.5, 0, 500, 0, -200, 0, 500, 0, -197.5, 0, 500, 0, -195, 0, 500, 0, -192.5, 0, 500, 0, -190, 0, 500, 0, -187.5, 0, 500, 0, -185, 0, 500, 0, -182.5, 0, 500, 0, -180, 0, 500, 0, -177.5, 0, 500, 0, -175, 0, 500, 0, -172.5, 0, 500, 0, -170, 0, 500, 0, -167.5, 0, 500, 0, -165, 0, 500, 0, -162.5, 0, 500, 0, -160, 0, 500, 0, -157.5, 0, 500, 0, -155, 0, 500, 0, -152.5, 0, 500, 0, -150, 0, 500, 0, -147.5, 0, 500, 0, -145, 0, 500, 0, -142.5, 0, 500, 0, -140, 0, 500, 0, -137.5, 0, 500, 0, -135, 0, 500, 0, -132.5, 0, 500, 0, -130, 0, 500, 0, -127.5, 0, 500, 0, -125, 0, 500, 0, -122.5, 0, 500, 0, -120, 0, 500, 0, -117.5, 0, 500, 0, -115, 0, 500, 0, -112.5, 0, 500, 0, -110, 0, 500, 0, -109, 0, 500, 0, -108, 0, 500, 0, -107, 0, 500, 0, -106, 0, 500, 0, -105, 0, 500, 0, -104, 0, 500, 0, -103, 0, 500, 0, -102, 0, 500, 0, -101, 0, 500, 0, -100, 0, 500, 0, -99, 0, 500, 0, -98, 0, 500, 0, -97, 0, 500, 0, -96, 0, 500, 0, -95, 0, 500, 0, -94, 0, 500, 0, -93, 0, 500, 0, -92, 0, 500, 0, -91, 0, 500, 0, -90, 0, 500, 0, -89, 0, 500, 0, -88, 0, 500, 0, -87, 0, 500, 0, -86, 0, 500, 0, -85, 0, 500, 0, -84, 0, 500, 0, -83, 0, 500, 0, -82, 0, 500, 0, -81, 0, 500, 0, -80, 0, 500, 0, -79, 0, 500, 0, -78, 0, 500, 0, -77, 0, 500, 0, -76, 0, 500, 0, -75, 0, 500, 0, -74, 0, 500, 0, -73, 0, 500, 0, -72, 0, 500, 0, -71, 0, 500, 0, -70, 0, 500, 0, -69, 0, 500, 0, -68, 0, 500, 0, -67, 0, 500, 0, -66, 0, 500, 0, -65, 0, 500, 0, -64, 0, 500, 0, -63, 0, 500, 0, -62, 0, 500, 0, -61, 0, 500, 0, -60, 0, 500, 0, -59, 0, 500, 0, -58, 0, 500, 0, -57, 0, 500, 0, -56, 0, 500, 0, -55, 0, 500, 0, -54, 0, 500, 0, -53, 0, 500, 0, -52, 0, 500, 0, -51, 0, 500, 0, -50, 0, 500, 0, -49, 0, 500, 0, -48, 0, 500, 0, -47, 0, 500, 0, -46, 0, 500, 0, -45, 0, 500, 0, -44, 0, 500, 0, -43, 0, 500, 0, -42, 0, 500, 0, -41, 0, 500, 0, -40, 0, 500, 0, -39, 0, 500, 0, -38, 0, 500, 0, -37, 0, 500, 0, -36, 0, 500, 0, -35, 0, 500, 0, -34, 0, 500, 0, -33, 0, 500, 0, -32, 0, 500, 0, -31, 0, 500, 0, -30, 0, 500, 0, -29, 0, 500, 0, -28, 0, 500, 0, -27, 0, 500, 0, -26, 0, 500, 0, -25, 0, 500, 0, -24, 0, 500, 0, -23, 0, 500, 0, -22, 0, 500, 0, -21, 0, 500, 0, -20, 0, 500, 0, -19, 0, 500, 0, -18, 0, 500, 0, -17, 0, 500, 0, -16, 0, 500, 0, -15, 0, 500, 0, -14, 0, 500, 0, -13, 0, 500, 0, -12, 0, 500, 0, -11, 0, 500, 0, -10, 0, 500, 0, -9, 0, 500, 0, -8, 0, 500, 0, -7, 0, 500, 0, -6, 0, 500, 0, -5, 0, 500, 0, -4, 0, 500, 0, -3, 0, 500, 0, -2, 0, 500, 0, -1, 0, 500, 0, 0, 0, 500, 0, 1, 0, 500, 0, 2, 0, 500, 0, 3, 0, 500, 0, 4, 0, 500, 0, 5, 0, 500, 0, 6, 0, 500, 0, 7, 0, 500, 0, 8, 0, 500, 0, 9, 0, 500, 0, 10, 0, 500, 0, 11, 0, 500, 0, 12, 0, 500, 0, 13, 0, 500, 0, 14, 0, 500, 0, 15, 0, 500, 0, 16, 0, 500, 0, 17, 0, 500, 0, 18, 0, 500, 0, 19, 0, 500, 0, 20, 0, 500, 0, 21, 0, 500, 0, 22, 0, 500, 0, 23, 0, 500, 0, 24, 0, 500, 0, 25, 0, 500, 0, 26, 0, 500, 0, 27, 0, 500, 0, 28, 0, 500, 0, 29, 0, 500, 0, 30, 0, 500, 0, 31, 0, 500, 0, 32, 0, 500, 0, 33, 0, 500, 0, 34, 0, 500, 0, 35, 0, 500, 0, 36, 0, 500, 0, 37, 0, 500, 0, 38, 0, 500, 0, 39, 0, 500, 0, 40, 0, 500, 0, 41, 0, 500, 0, 42, 0, 500, 0, 43, 0, 500, 0, 44, 0, 500, 0, 45, 0, 500, 0, 46, 0, 500, 0, 47, 0, 500, 0, 48, 0, 500, 0, 49, 0, 500, 0, 50, 0, 500, 0, 51, 0, 500, 0, 52, 0, 500, 0, 53, 0, 500, 0, 54, 0, 500, 0, 55, 0, 500, 0, 56, 0, 500, 0, 57, 0, 500, 0, 58, 0, 500, 0, 59, 0, 500, 0, 60, 0, 500, 0, 61, 0, 500, 0, 62, 0, 500, 0, 63, 0, 500, 0, 64, 0, 500, 0, 65, 0, 500, 0, 66, 0, 500, 0, 67, 0, 500, 0, 68, 0, 500, 0, 69, 0, 500, 0, 70, 0, 500, 0, 71, 0, 500, 0, 72, 0, 500, 0, 73, 0, 500, 0, 74, 0, 500, 0, 75, 0, 500, 0, 76, 0, 500, 0, 77, 0, 500, 0, 78, 0, 500, 0, 79, 0, 500, 0, 80, 0, 500, 0, 81, 0, 500, 0, 82, 0, 500, 0, 83, 0, 500, 0, 84, 0, 500, 0, 85, 0, 500, 0, 86, 0, 500, 0, 87, 0, 500, 0, 88, 0, 500, 0, 89, 0, 500, 0, 90, 0, 500, 0, 91, 0, 500, 0, 92, 0, 500, 0, 93, 0, 500, 0, 94, 0, 500, 0, 95, 0, 500, 0, 96, 0, 500, 0, 97, 0, 500, 0, 98, 0, 500, 0, 99, 0, 500, 0, 100, 0, 500, 0, 101, 0, 500, 0, 102, 0, 500, 0, 103, 0, 500, 0, 104, 0, 500, 0, 105, 0, 500, 0, 106, 0, 500, 0, 107, 0, 500, 0, 108, 0, 500, 0, 109, 0, 500, 0, 110, 0, 500, 0, 112.5, 0, 500, 0, 115, 0, 500, 0, 117.5, 0, 500, 0, 120, 0, 500, 0, 122.5, 0, 500, 0, 125, 0, 500, 0, 127.5, 0, 500, 0, 130, 0, 500, 0, 132.5, 0, 500, 0, 135, 0, 500, 0, 137.5, 0, 500, 0, 140, 0, 500, 0, 142.5, 0, 500, 0, 145, 0, 500, 0, 147.5, 0, 500, 0, 150, 0, 500, 0, 152.5, 0, 500, 0, 155, 0, 500, 0, 157.5, 0, 500, 0, 160, 0, 500, 0, 162.5, 0, 500, 0, 165, 0, 500, 0, 167.5, 0, 500, 0, 170, 0, 500, 0, 172.5, 0, 500, 0, 175, 0, 500, 0, 177.5, 0, 500, 0, 180, 0, 500, 0, 182.5, 0, 500, 0, 185, 0, 500, 0, 187.5, 0, 500, 0, 190, 0, 500, 0, 192.5, 0, 500, 0, 195, 0, 500, 0, 197.5, 0, 500, 0, 200, 0, 500, 0, 202.5, 0, 500, 0, 205, 0, 500, 0, 207.5, 0, 500, 0, 210, 0, 500, 0, 212.5, 0, 500, 0, 215, 0, 500, 0, 217.5, 0, 500, 0, 220, 0, 500, 0, 222.5, 0, 500, 0, 225, 0, 500, 0, 227.5, 0, 500, 0, 230, 0, 500, 0, 232.5, 0, 500, 0, 235, 0, 500, 0, 237.5, 0, 500, 0, 240, 0, 500, 0, 242.5, 0, 500, 0, 245, 0, 500, 0, 247.5, 0, 500, 0, 250, 0, 500, 0, 252.5, 0, 500, 0, 255, 0, 500, 0, 257.5, 0, 500, 0, 260, 0, 500, 0, 262.5, 0, 500, 0, 265, 0, 500, 0, 267.5, 0, 500, 0, 270, 0, 500, 0, 272.5, 0, 500, 0, 275, 0, 500, 0, 277.5, 0, 500, 0, 280, 0, 500, 0, 282.5, 0, 500, 0, 285, 0, 500, 0, 287.5, 0, 500, 0, 290, 0, 500, 0, 292.5, 0, 500, 0, 295, 0, 500, 0, 297.5, 0, 500, 0, 300, 0, 500, 0, 305, 0, 500, 0, 310, 0, 500, 0, 315, 0, 500, 0, 320, 0, 500, 0, 325, 0, 500, 0, 330, 0, 500, 0, 335, 0, 500, 0, 340, 0, 500, 0, 345, 0, 500, 0, 350, 0, 500, 0, 355, 0, 500, 0, 360, 0, 500, 0, 365, 0, 500, 0, 370, 0, 500, 0, 375, 0, 500, 0, 380, 0, 500, 0, 385, 0, 500, 0, 390, 0, 500, 0, 395, 0, 500, 0, 400, 0, 500, 0, 405, 0, 500, 0, 410, 0, 500, 0, 415, 0, 500, 0, 420, 0, 500, 0, 425, 0, 500, 0, 430, 0, 500, 0, 435, 0, 500, 0, 440, 0, 500, 0, 445, 0, 500, 0, 450, 0, 500, 0, 455, 0, 500, 0, 460, 0, 500, 0, 465, 0, 500, 0, 470, 0, 500, 0, 475, 0, 500, 0, 480, 0, 500, 0, 485, 0, 500, 0, 490, 0, 500, 0, 495, 0, 500, 0, 500, 0, 500, 0}
        designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -250, 0, -500, 0, -200, 0, -500, 0, 200, 0, -500, 0, 250, 0, -500, 0}

        ''designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -500, 0, -490, 0, -500, 0, -485, 0, -500, 0, -480, 0, -500, 0, -475, 0, -500, 0, -470, 0, -500, 0, -465, 0, -500, 0, -460, 0, -500, 0, -455, 0, -500, 0, -450, 0, -500, 0, -445, 0, -500, 0, -440, 0, -500, 0, -435, 0, -500, 0, -430, 0, -500, 0, -425, 0, -500, 0, -420, 0, -500, 0, -415, 0, -500, 0, -410, 0, -500, 0, -405, 0, -500, 0, -400, 0, -500, 0, -395, 0, -500, 0, -390, 0, -500, 0, -385, 0, -500, 0, -380, 0, -500, 0, -375, 0, -500, 0, -370, 0, -500, 0, -365, 0, -500, 0, -360, 0, -500, 0, -355, 0, -500, 0, -350, 0, -500, 0, -345, 0, -500, 0, -340, 0, -500, 0, -335, 0, -500, 0, -330, 0, -500, 0, -325, 0, -500, 0, -320, 0, -500, 0, -315, 0, -500, 0, -310, 0, -500, 0, -305, 0, -500, 0, -300, 0, -500, 0, -297.5, 0, -500, 0, -295, 0, -500, 0, -292.5, 0, -500, 0, -290, 0, -500, 0, -287.5, 0, -500, 0, -285, 0, -500, 0, -282.5, 0, -500, 0, -280, 0, -500, 0, -277.5, 0, -500, 0, -275, 0, -500, 0, -272.5, 0, -500, 0, -270, 0, -500, 0, -267.5, 0, -500, 0, -265, 0, -500, 0, -262.5, 0, -500, 0, -260, 0, -500, 0, -257.5, 0, -500, 0, -255, 0, -500, 0, -252.5, 0, -500, 0, -250, 0, -500, 0, -247.5, 0, -500, 0, -245, 0, -500, 0, -242.5, 0, -500, 0, -240, 0, -500, 0, -237.5, 0, -500, 0, -235, 0, -500, 0, -232.5, 0, -500, 0, -230, 0, -500, 0, -227.5, 0, -500, 0, -225, 0, -500, 0, -222.5, 0, -500, 0, -220, 0, -500, 0, -217.5, 0, -500, 0, -215, 0, -500, 0, -212.5, 0, -500, 0, -210, 0, -500, 0, -207.5, 0, -500, 0, -205, 0, -500, 0, -202.5, 0, -500, 0, -200, 0, -500, 0, -197.5, 0, -500, 0, -195, 0, -500, 0, -192.5, 0, -500, 0, -190, 0, -500, 0, -187.5, 0, -500, 0, -185, 0, -500, 0, -182.5, 0, -500, 0, -180, 0, -500, 0, -177.5, 0, -500, 0, -175, 0, -500, 0, -172.5, 0, -500, 0, -170, 0, -500, 0, -167.5, 0, -500, 0, -165, 0, -500, 0, -162.5, 0, -500, 0, -160, 0, -500, 0, -157.5, 0, -500, 0, -155, 0, -500, 0, -152.5, 0, -500, 0, -150, 0, -500, 0, -147.5, 0, -500, 0, -145, 0, -500, 0, -142.5, 0, -500, 0, -140, 0, -500, 0, -137.5, 0, -500, 0, -135, 0, -500, 0, -132.5, 0, -500, 0, -130, 0, -500, 0, -127.5, 0, -500, 0, -125, 0, -500, 0, -122.5, 0, -500, 0, -120, 0, -500, 0, -117.5, 0, -500, 0, -115, 0, -500, 0, -112.5, 0, -500, 0, -110, 0, -500, 0, -109, 0, -500, 0, -108, 0, -500, 0, -107, 0, -500, 0, -106, 0, -500, 0, -105, 0, -500, 0, -104, 0, -500, 0, -103, 0, -500, 0, -102, 0, -500, 0, -101, 0, -500, 0, -100, 0, -500, 0, -99, 0, -500, 0, -98, 0, -500, 0, -97, 0, -500, 0, -96, 0, -500, 0, -95, 0, -500, 0, -94, 0, -500, 0, -93, 0, -500, 0, -92, 0, -500, 0, -91, 0, -500, 0, -90, 0, -500, 0, -89, 0, -500, 0, -88, 0, -500, 0, -87, 0, -500, 0, -86, 0, -500, 0, -85, 0, -500, 0, -84, 0, -500, 0, -83, 0, -500, 0, -82, 0, -500, 0, -81, 0, -500, 0, -80, 0, -500, 0, -79, 0, -500, 0, -78, 0, -500, 0, -77, 0, -500, 0, -76, 0, -500, 0, -75, 0, -500, 0, -74, 0, -500, 0, -73, 0, -500, 0, -72, 0, -500, 0, -71, 0, -500, 0, -70, 0, -500, 0, -69, 0, -500, 0, -68, 0, -500, 0, -67, 0, -500, 0, -66, 0, -500, 0, -65, 0, -500, 0, -64, 0, -500, 0, -63, 0, -500, 0, -62, 0, -500, 0, -61, 0, -500, 0, -60, 0, -500, 0, -59, 0, -500, 0, -58, 0, -500, 0, -57, 0, -500, 0, -56, 0, -500, 0, -55, 0, -500, 0, -54, 0, -500, 0, -53, 0, -500, 0, -52, 0, -500, 0, -51, 0, -500, 0, -50, 0, -500, 0, -49, 0, -500, 0, -48, 0, -500, 0, -47, 0, -500, 0, -46, 0, -500, 0, -45, 0, -500, 0, -44, 0, -500, 0, -43, 0, -500, 0, -42, 0, -500, 0, -41, 0, -500, 0, -40, 0, -500, 0, -39, 0, -500, 0, -38, 0, -500, 0, -37, 0, -500, 0, -36, 0, -500, 0, -35, 0, -500, 0, -34, 0, -500, 0, -33, 0, -500, 0, -32, 0, -500, 0, -31, 0, -500, 0, -30, 0, -500, 0, -29, 0, -500, 0, -28, 0, -500, 0, -27, 0, -500, 0, -26, 0, -500, 0, -25, 0, -500, 0, -24, 0, -500, 0, -23, 0, -500, 0, -22, 0, -500, 0, -21, 0, -500, 0, -20, 0, -500, 0, -19, 0, -500, 0, -18, 0, -500, 0, -17, 0, -500, 0, -16, 0, -500, 0, -15, 0, -500, 0, -14, 0, -500, 0, -13, 0, -500, 0, -12, 0, -500, 0, -11, 0, -500, 0, -10, 0, -500, 0, -9, 0, -500, 0, -8, 0, -500, 0, -7, 0, -500, 0, -6, 0, -500, 0, -5, 0, -500, 0, -4, 0, -500, 0, -3, 0, -500, 0, -2, 0, -500, 0, -1, 0, -500, 0, 0, 0, -500, 0, 1, 0, -500, 0, 2, 0, -500, 0, 3, 0, -500, 0, 4, 0, -500, 0, 5, 0, -500, 0, 6, 0, -500, 0, 7, 0, -500, 0, 8, 0, -500, 0, 9, 0, -500, 0, 10, 0, -500, 0, 11, 0, -500, 0, 12, 0, -500, 0, 13, 0, -500, 0, 14, 0, -500, 0, 15, 0, -500, 0, 16, 0, -500, 0, 17, 0, -500, 0, 18, 0, -500, 0, 19, 0, -500, 0, 20, 0, -500, 0, 21, 0, -500, 0, 22, 0, -500, 0, 23, 0, -500, 0, 24, 0, -500, 0, 25, 0, -500, 0, 26, 0, -500, 0, 27, 0, -500, 0, 28, 0, -500, 0, 29, 0, -500, 0, 30, 0, -500, 0, 31, 0, -500, 0, 32, 0, -500, 0, 33, 0, -500, 0, 34, 0, -500, 0, 35, 0, -500, 0, 36, 0, -500, 0, 37, 0, -500, 0, 38, 0, -500, 0, 39, 0, -500, 0, 40, 0, -500, 0, 41, 0, -500, 0, 42, 0, -500, 0, 43, 0, -500, 0, 44, 0, -500, 0, 45, 0, -500, 0, 46, 0, -500, 0, 47, 0, -500, 0, 48, 0, -500, 0, 49, 0, -500, 0, 50, 0, -500, 0, 51, 0, -500, 0, 52, 0, -500, 0, 53, 0, -500, 0, 54, 0, -500, 0, 55, 0, -500, 0, 56, 0, -500, 0, 57, 0, -500, 0, 58, 0, -500, 0, 59, 0, -500, 0, 60, 0, -500, 0, 61, 0, -500, 0, 62, 0, -500, 0, 63, 0, -500, 0, 64, 0, -500, 0, 65, 0, -500, 0, 66, 0, -500, 0, 67, 0, -500, 0, 68, 0, -500, 0, 69, 0, -500, 0, 70, 0, -500, 0, 71, 0, -500, 0, 72, 0, -500, 0, 73, 0, -500, 0, 74, 0, -500, 0, 75, 0, -500, 0, 76, 0, -500, 0, 77, 0, -500, 0, 78, 0, -500, 0, 79, 0, -500, 0, 80, 0, -500, 0, 81, 0, -500, 0, 82, 0, -500, 0, 83, 0, -500, 0, 84, 0, -500, 0, 85, 0, -500, 0, 86, 0, -500, 0, 87, 0, -500, 0, 88, 0, -500, 0, 89, 0, -500, 0, 90, 0, -500, 0, 91, 0, -500, 0, 92, 0, -500, 0, 93, 0, -500, 0, 94, 0, -500, 0, 95, 0, -500, 0, 96, 0, -500, 0, 97, 0, -500, 0, 98, 0, -500, 0, 99, 0, -500, 0, 100, 0, -500, 0, 101, 0, -500, 0, 102, 0, -500, 0, 103, 0, -500, 0, 104, 0, -500, 0, 105, 0, -500, 0, 106, 0, -500, 0, 107, 0, -500, 0, 108, 0, -500, 0, 109, 0, -500, 0, 110, 0, -500, 0, 112.5, 0, -500, 0, 115, 0, -500, 0, 117.5, 0, -500, 0, 120, 0, -500, 0, 122.5, 0, -500, 0, 125, 0, -500, 0, 127.5, 0, -500, 0, 130, 0, -500, 0, 132.5, 0, -500, 0, 135, 0, -500, 0, 137.5, 0, -500, 0, 140, 0, -500, 0, 142.5, 0, -500, 0, 145, 0, -500, 0, 147.5, 0, -500, 0, 150, 0, -500, 0, 152.5, 0, -500, 0, 155, 0, -500, 0, 157.5, 0, -500, 0, 160, 0, -500, 0, 162.5, 0, -500, 0, 165, 0, -500, 0, 167.5, 0, -500, 0, 170, 0, -500, 0, 172.5, 0, -500, 0, 175, 0, -500, 0, 177.5, 0, -500, 0, 180, 0, -500, 0, 182.5, 0, -500, 0, 185, 0, -500, 0, 187.5, 0, -500, 0, 190, 0, -500, 0, 192.5, 0, -500, 0, 195, 0, -500, 0, 197.5, 0, -500, 0, 200, 0, -500, 0, 202.5, 0, -500, 0, 205, 0, -500, 0, 207.5, 0, -500, 0, 210, 0, -500, 0, 212.5, 0, -500, 0, 215, 0, -500, 0, 217.5, 0, -500, 0, 220, 0, -500, 0, 222.5, 0, -500, 0, 225, 0, -500, 0, 227.5, 0, -500, 0, 230, 0, -500, 0, 232.5, 0, -500, 0, 235, 0, -500, 0, 237.5, 0, -500, 0, 240, 0, -500, 0, 242.5, 0, -500, 0, 245, 0, -500, 0, 247.5, 0, -500, 0, 250, 0, -500, 0, 252.5, 0, -500, 0, 255, 0, -500, 0, 257.5, 0, -500, 0, 260, 0, -500, 0, 262.5, 0, -500, 0, 265, 0, -500, 0, 267.5, 0, -500, 0, 270, 0, -500, 0, 272.5, 0, -500, 0, 275, 0, -500, 0, 277.5, 0, -500, 0, 280, 0, -500, 0, 282.5, 0, -500, 0, 285, 0, -500, 0, 287.5, 0, -500, 0, 290, 0, -500, 0, 292.5, 0, -500, 0, 295, 0, -500, 0, 297.5, 0, -500, 0, 300, 0, -500, 0, 305, 0, -500, 0, 310, 0, -500, 0, 315, 0, -500, 0, 320, 0, -500, 0, 325, 0, -500, 0, 330, 0, -500, 0, 335, 0, -500, 0, 340, 0, -500, 0, 345, 0, -500, 0, 350, 0, -500, 0, 355, 0, -500, 0, 360, 0, -500, 0, 365, 0, -500, 0, 370, 0, -500, 0, 375, 0, -500, 0, 380, 0, -500, 0, 385, 0, -500, 0, 390, 0, -500, 0, 395, 0, -500, 0, 400, 0, -500, 0, 405, 0, -500, 0, 410, 0, -500, 0, 415, 0, -500, 0, 420, 0, -500, 0, 425, 0, -500, 0, 430, 0, -500, 0, 435, 0, -500, 0, 440, 0, -500, 0, 445, 0, -500, 0, 450, 0, -500, 0, 455, 0, -500, 0, 460, 0, -500, 0, 465, 0, -500, 0, 470, 0, -500, 0, 475, 0, -500, 0, 480, 0, -500, 0, 485, 0, -500, 0, 490, 0, -500, 0, 495, 0, -500, 0, 500, 0, -500, 0}

        'designedBfield = New Single() {0, -500, 0, -450, 0}
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, 500, 0, 500, 0, 500, 0, 500, 0, -500}
        designedBsmfield = New Single() {-150}

        '''''''''designedBfield = New Single() {0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}
        ''''''hysteresis 
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}

        'designedBfield = New Single() {0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0}

        '''''ultra small field
        'designedBfield = New Single() {0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0}

        ''''''large field 
        'designedBfield = New Single() {0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -400, 0, -300, 0, -200, 0, -100, 0, 0, 0, 100, 0, 200, 0, 300, 0, 400, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}

        '''''''large field + small field
        'designedBfield = New Single() {0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -480, 0, -460, 0, -440, 0, -420, 0, -400, 0, -380, 0, -360, 0, -340, 0, -320, 0, -300, 0, -280, 0, -260, 0, -240, 0, -220, 0, -200, 0, -180, 0, -160, 0, -140, 0, -120, 0, -100, 0, -80, 0, -60, 0, -40, 0, -20, 0, 0, 0, 20, 0, 40, 0, 60, 0, 80, 0, 100, 0, 120, 0, 140, 0, 160, 0, 180, 0, 200, 0, 220, 0, 240, 0, 260, 0, 280, 0, 300, 0, 320, 0, 340, 0, 360, 0, 380, 0, 400, 0, 420, 0, 440, 0, 460, 0, 480, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}


        'designedBfield = New Single() {0, -600, 0, -580, 0, -560, 0, -540, 0, -520, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 520, 0, 540, 0, 560, 0, 580, 0, 600, 0}

        devicecurrentlist = New Single() {0.000002}



        size = designedBfield.Length()
        devicecurrentlistsize = devicecurrentlist.Length()
        smllcoilsize = designedBsmfield.Length()


        newDeviceVoltage = New Single(size) {}
        newDeviceVoltage1 = New Single(50, size) {}
        newRealBfield1 = New Single(50, size) {}
        designedIcoil = New Single(size) {}
        designedIsmcoil = New Single(smllcoilsize) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        'KeiIniVM()    ''''''Initialize Keithley as Voltmeter



        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        Do Until currentlistnum = devicecurrentlistsize

            If devicecurrentlist(currentlistnum) < 0.000001 Then
                y = 0
                fileNum = 0

                inittime = DateTime.Now()

                Try

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                End Try

            Else

                Try
                    kk = 0

                    Do Until kk = smllcoilsize

                        Key2612OFF()
                        System.Threading.Thread.Sleep(500)
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(500)

                        zz = 0
                        Blocalsm = 0
                        Kcoil = 1778.3

                        Do Until zz = 3
                            Blocalsm = B2_Reading() + Blocalsm
                            System.Threading.Thread.Sleep(3000)
                            zz = zz + 1
                        Loop

                        Blocalsm = -(Blocalsm / 3)

                        xx = 0
                        Do Until xx = smllcoilsize
                            designedIsmcoil(xx) = (designedBsmfield(xx) + Blocalsm) / Ksmcoil
                            xx = xx + 1
                        Loop

                        System.Threading.Thread.Sleep(1000)

                        KEY2612Curr(designedIsmcoil(kk))

                        System.Threading.Thread.Sleep(1000)

                        Key2612ON()

                        fileNum = 0
                        y = 0

                        inittime = DateTime.Now()


                        Do Until y = 100
                            x = 0
                            Blocal = 0
                            z = 0

                            KeiIniVM()

                            'AbortAGI_CH2()
                            AbortKEI_SM()
                            System.Threading.Thread.Sleep(2000)
                            Do Until z = 3
                                Blocal = B2_Reading() + Blocal
                                System.Threading.Thread.Sleep(3000)
                                z = z + 1
                            Loop

                            Blocal = -(Blocal / 3)


                            Do Until x = size
                                designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                                x = x + 1
                            Loop

                            'ONAGI_CH2()
                            ONKEI_SM()
                            System.Threading.Thread.Sleep(1000)

                            'Z_AGICH2(((0 + Blocal) / Kcoil))
                            Z_KEI(((0 + Blocal) / Kcoil))

                            System.Threading.Thread.Sleep(2000)
                            ''''''''check if it is real zero with gradient field on'''''''
                            Bcheck = B2_Reading()

                            Do Until Math.Abs(Bcheck) < 2.2
                                Z_KEI(-0.5)
                                System.Threading.Thread.Sleep(500)
                                B1 = B2_Reading()
                                System.Threading.Thread.Sleep(500)
                                Z_KEI(-0.2)
                                System.Threading.Thread.Sleep(500)
                                B2 = B2_Reading()
                                System.Threading.Thread.Sleep(500)
                                Kcoil = (B2 - B1) / ((-0.2) - (-0.5))
                                System.Threading.Thread.Sleep(500)

                                x = 0
                                Blocal = 0
                                z = 0

                                KeiIniVM()

                                'AbortAGI_CH2()
                                AbortKEI_SM()
                                System.Threading.Thread.Sleep(2000)
                                Do Until z = 3
                                    Blocal = B2_Reading() + Blocal
                                    System.Threading.Thread.Sleep(3000)
                                    z = z + 1
                                Loop

                                Blocal = -(Blocal / 3)


                                Do Until x = size
                                    designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                                    x = x + 1
                                Loop

                                'ONAGI_CH2()
                                ONKEI_SM()
                                System.Threading.Thread.Sleep(1000)

                                'Z_AGICH2(((0 + Blocal) / Kcoil))
                                Z_KEI(((0 + Blocal) / Kcoil))
                                System.Threading.Thread.Sleep(8000)
                                Bcheck = B2_Reading()
                            Loop




                            ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                            System.Threading.Thread.Sleep(2000)


                            DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                            System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                            'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                            Z_KEI(designedIcoil(0))

                            System.Threading.Thread.Sleep(2000)

                            x = 0
                            Do Until x = size
                                Diff = 50
                                'Z_AGICH2(designedIcoil(x))
                                Z_KEI(designedIcoil(x))

                                k = 0
                                Do Until k = 50
                                    System.Threading.Thread.Sleep(100)     ''''''''''waiting time for the B field to get stable, wait at least for 100ms. 
                                    Diffnum = 0
                                    'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                                    Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                        Bnow = B2_Reading()
                                        Diff = Math.Abs(Bnow - designedBfield(x))
                                        System.Threading.Thread.Sleep(30)
                                        Diffnum = Diffnum + 1
                                        If Diffnum > 100 Then
                                            If (Bnow - designedBfield(x)) > 0 Then
                                                'Z_AGICH2(designedIcoil(x) - 0.00025)
                                                Z_KEI(designedIcoil(x) - 0.00025)
                                                System.Threading.Thread.Sleep(1000)
                                            ElseIf (Bnow - designedBfield(x)) < 0 Then
                                                'Z_AGICH2(designedIcoil(x) + 0.00025)
                                                Z_KEI(designedIcoil(x) + 0.00025)
                                                System.Threading.Thread.Sleep(1000)
                                            End If
                                        End If

                                    Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                                    newRealBfield1(k, x) = Bnow
                                    newDeviceVoltage1(k, x) = KeiVoltReading()
                                    currenttime = DateTime.Now()
                                    MeasureInterval(x) = TTimeSpan(currenttime, inittime)

                                    k = k + 1
                                Loop

                                x = x + 1
                            Loop
                            AbortAGI_CH1()

                            'AbortKEI_4200()

                            'Z_AGICH2(((0 + Blocal) / Kcoil))
                            Z_KEI(((0 + Blocal) / Kcoil))

                            FILETIME = DateTime.Now.ToString()
                            FILETIME = FILETIME.Replace("/", "_")
                            FILETIME = FILETIME.Replace(":", "_")

                            'Filename = FILETIME + "-" + "MRscan.txt"
                            Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + "smll v " + designedBsmfield(kk).ToString() + ".txt"

                            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                            Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}{3,-16:E}{4,-16:E}{5,-16:E}{6,-16:E}{7,-16:E}{8,-16:E}{9,-16:E}{10,-16:E}{11,-16:E}{12,-16:E}{13,-16:E}{14,-16:E}{15,-16:E}{16,-16:E}{17,-16:E}{18,-16:E}{19,-16:E}{20,-16:E}{21,-16:E}{22,-16:E}{23,-16:E}{24,-16:E}{25,-16:E}{26,-16:E}{27,-16:E}{28,-16:E}{29,-16:E}{30,-16:E}{31,-16:E}{32,-16:E}{33,-16:E}{34,-16:E}{35,-16:E}{36,-16:E}{37,-16:E}{38,-16:E}{39,-16:E}{40,-16:E}"
                            objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}{4,-16}{5,-16}{6,-16}{7,-16}{8,-16}{9,-16}{10,-16}{11,-16}{12,-16}{13,-16}{14,-16}{15,-16}{16,-16}{17,-16}{18,-16}{19,-16}{20,-16}{21,-16}{22,-16}{23,-16}{24,-16}{25,-16}{26,-16}{27,-16}{28,-16}{29,-16}{30,-16}{31,-16}{32,-16}{33,-16}{34,-16}{35,-16}{36,-16}{37,-16}{38,-16}{39,-16}{40,-16}", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-250", "0", "-500", "0", "-200", "0", "-500", "0", "200", "0", "-500", "0", "250", "0", "-500", "0")
                            For k = 0 To 49
                                objWriterTrans.WriteLine(LineFormatTrans, newDeviceVoltage1(k, 0), newDeviceVoltage1(k, 1), newDeviceVoltage1(k, 2), newDeviceVoltage1(k, 3), newDeviceVoltage1(k, 4), newDeviceVoltage1(k, 5), newDeviceVoltage1(k, 6), newDeviceVoltage1(k, 7), newDeviceVoltage1(k, 8), newDeviceVoltage1(k, 9), newDeviceVoltage1(k, 10), newDeviceVoltage1(k, 11), newDeviceVoltage1(k, 12), newDeviceVoltage1(k, 13), newDeviceVoltage1(k, 14), newDeviceVoltage1(k, 15), newDeviceVoltage1(k, 16), newDeviceVoltage1(k, 17), newDeviceVoltage1(k, 18), newDeviceVoltage1(k, 19), newDeviceVoltage1(k, 20), newDeviceVoltage1(k, 21), newDeviceVoltage1(k, 22), newDeviceVoltage1(k, 23), newDeviceVoltage1(k, 24), newDeviceVoltage1(k, 25), newDeviceVoltage1(k, 26), newDeviceVoltage1(k, 27), newDeviceVoltage1(k, 28), newDeviceVoltage1(k, 29), newDeviceVoltage1(k, 30), newDeviceVoltage1(k, 31), newDeviceVoltage1(k, 32), newDeviceVoltage1(k, 33), newDeviceVoltage1(k, 34), newDeviceVoltage1(k, 35), newDeviceVoltage1(k, 36), newDeviceVoltage1(k, 37), newDeviceVoltage1(k, 38), newDeviceVoltage1(k, 39), newDeviceVoltage1(k, 40))
                            Next
                            objWriterTrans.Close()

                            Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + "smll b " + designedBsmfield(kk).ToString() + ".txt"

                            Dim objWriterTrans1 As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                            Dim LineFormatTrans1 As String = "{0,-10}{1,-16:E}{2,-16:E}{3,-16:E}{4,-16:E}{5,-16:E}{6,-16:E}{7,-16:E}{8,-16:E}{9,-16:E}{10,-16:E}{11,-16:E}{12,-16:E}{13,-16:E}{14,-16:E}{15,-16:E}{16,-16:E}{17,-16:E}{18,-16:E}{19,-16:E}{20,-16:E}{21,-16:E}{22,-16:E}{23,-16:E}{24,-16:E}{25,-16:E}{26,-16:E}{27,-16:E}{28,-16:E}{29,-16:E}{30,-16:E}{31,-16:E}{32,-16:E}{33,-16:E}{34,-16:E}{35,-16:E}{36,-16:E}{37,-16:E}{38,-16:E}{39,-16:E}{40,-16:E}"
                            objWriterTrans1.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}{4,-16}{5,-16}{6,-16}{7,-16}{8,-16}{9,-16}{10,-16}{11,-16}{12,-16}{13,-16}{14,-16}{15,-16}{16,-16}{17,-16}{18,-16}{19,-16}{20,-16}{21,-16}{22,-16}{23,-16}{24,-16}{25,-16}{26,-16}{27,-16}{28,-16}{29,-16}{30,-16}{31,-16}{32,-16}{33,-16}{34,-16}{35,-16}{36,-16}{37,-16}{38,-16}{39,-16}{40,-16}", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-500", "0", "-250", "0", "-500", "0", "-200", "0", "-500", "0", "200", "0", "-500", "0", "250", "0", "-500", "0")
                            For k = 0 To 49
                                objWriterTrans1.WriteLine(LineFormatTrans, newRealBfield1(k, 0), newRealBfield1(k, 1), newRealBfield1(k, 2), newRealBfield1(k, 3), newRealBfield1(k, 4), newRealBfield1(k, 5), newRealBfield1(k, 6), newRealBfield1(k, 7), newRealBfield1(k, 8), newRealBfield1(k, 9), newRealBfield1(k, 10), newRealBfield1(k, 11), newRealBfield1(k, 12), newRealBfield1(k, 13), newRealBfield1(k, 14), newRealBfield1(k, 15), newRealBfield1(k, 16), newRealBfield1(k, 17), newRealBfield1(k, 18), newRealBfield1(k, 19), newRealBfield1(k, 20), newRealBfield1(k, 21), newRealBfield1(k, 22), newRealBfield1(k, 23), newRealBfield1(k, 24), newRealBfield1(k, 25), newRealBfield1(k, 26), newRealBfield1(k, 27), newRealBfield1(k, 28), newRealBfield1(k, 29), newRealBfield1(k, 30), newRealBfield1(k, 31), newRealBfield1(k, 32), newRealBfield1(k, 33), newRealBfield1(k, 34), newRealBfield1(k, 35), newRealBfield1(k, 36), newRealBfield1(k, 37), newRealBfield1(k, 38), newRealBfield1(k, 39), newRealBfield1(k, 40))
                            Next
                            objWriterTrans1.Close()





                            y = y + 1
                            fileNum = fileNum + 1
                            System.Threading.Thread.Sleep(10000)
                        Loop

                        kk = kk + 1
                    Loop




                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 100
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop
                End Try
            End If





            currentlistnum = currentlistnum + 1
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortKEI_SM()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()
        System.Threading.Thread.Sleep(5000)
        Key2612OFF()




    End Sub

    Sub InitNewport()
        Dim MessageIn As String
FindNewportAgain:
        NewportPresent = False
        Try
            Dim GpibDevice = New Device(0, CInt(GPIBNewport))
            'Do
            'Loop Until GpibDevice.SerialPoll And 128
            'GpibDevice.Write("*IDN?")
            GPIBOut("*IDN?", GpibDevice)
            'Do
            'Loop Until GpibDevice.SerialPoll And 16
            MessageIn = GPIBIn(GpibDevice) 'GpibDevice.ReadString()
            '
            If Left$(MessageIn, 7) = "NewportCorp,1835-C" Then
                NewportPresent = 1
                ' Clear input buffer
                GpibDevice.Clear()
                Do
                Loop Until GpibDevice.SerialPoll And 128
                '   Set the autoranging ON
                GpibDevice.Write("AUTO 1")
                MessageIn = GpibDevice.ReadString()
                '   set the FILTER to NO FILTER
                GpibDevice.Write("FILTER 1")
                '   set the ZERO to OFF
                GpibDevice.Write("ZERO 0")
                '   set the ZERO to OFF
                GpibDevice.Write("ATTN 0")
                '   Find the current calibration wavelength

                '
            ElseIf Left$(MessageIn, 18) = "Newport Corp.,1830" Then
                NewportPresent = 2
                ' Clear input buffer
                GpibDevice.Clear()
                'Do
                'Loop Until GpibDevice.SerialPoll And 128
                '   Set the autoranging ON
                'GpibDevice.Write("R0")
                GPIBOut("R0", GpibDevice)
                'Do
                'Loop Until GpibDevice.SerialPoll And 128
                '   set the FILTER to NO FILTER
                'GpibDevice.Write("F2")
                GPIBOut("F3", GpibDevice)
                'Do
                'Loop Until GpibDevice.SerialPoll And 128
                '   set the ZERO to OFF
                'GpibDevice.Write("Z0")
                GPIBOut("Z0", GpibDevice)
                '   set the ZERO to OFF
                'Do
                'Loop Until GpibDevice.SerialPoll And 128
                'GpibDevice.Write("A0")
                GPIBOut("A0", GpibDevice)
                '   set the Units to Watts
                'Do
                'Loop Until GpibDevice.SerialPoll And 128
                'GpibDevice.Write("U1")
                GPIBOut("U1", GpibDevice)
                '   Find the current calibration wavelength
                'Do
                'Loop Until GpibDevice.SerialPoll And 128
                'GpibDevice.Write("W?")
                'GPIBOut("W?", GpibDevice)
                'Do
                'Loop Until GpibDevice.SerialPoll And 16
                'MessageIn = GPIBIn(GpibDevice) 'GpibDevice.ReadString()
                'IVLData.Wavelength = Val(Left(MessageIn, 4))
                '
            Else
                GpibDevice.Dispose()
                Throw New System.Exception("An exception has occurred.")
            End If
            GpibDevice.Dispose()
        Catch
            Dim message As String = "Newport not found. Do you want to try again?"
            Dim caption As String = ""
            Dim buttons As MessageBoxButtons = MessageBoxButtons.YesNo
            ' Show message box
            Dim result As MsgBoxResult = MessageBox.Show(message, caption, buttons)
            If result = vbYes Then
                GoTo FindNewportAgain
            End If
        End Try
    End Sub

    Public Sub DeviceCond(ByVal Current As Single)
        Dim x As Integer
        Dim t As Single

        x = 0
        KeiIniVM()
        Do Until x = 10 '86
            DUT_AGICH1CURR(Current)
            System.Threading.Thread.Sleep(10000)
            t = KeiVoltReading()
            AbortAGI_CH1()
            System.Threading.Thread.Sleep(3000)
            x = x + 1
        Loop
        AbortAGI_CH1()
    End Sub

    Public Sub DeviceCondV(ByVal Voltage As Single)
        Dim x As Integer
        Dim t As Single

        x = 0
        KeiIniAM()
        Do Until x = 10

            DUT_AGICH1VOLT(Voltage)
            System.Threading.Thread.Sleep(10000)

            t = KeiCurrReading()
            AbortAGI_CH1()
            System.Threading.Thread.Sleep(3000)
            x = x + 1
        Loop
        AbortAGI_CH1()
    End Sub


    Public Sub IVLmeas()
        Dim Voltlist() As Single
        Dim size As Integer
        Dim CurrentRd() As Single
        Dim ElRd() As Single
        Dim EffRd() As Single
        Dim i, k As Integer

        Voltlist = New Single() {-3, -2.9, -2.8, -2.7, -2.6, -2.5, -2.4, -2.3, -2.2, -2.1, -2, -1.9, -1.8, -1.7, -1.6, -1.5, -1.4, -1.3, -1.2, -1.1, -1, -0.9, -0.8, -0.7, -0.6, -0.5, -0.4, -0.3, -0.2, -0.1, 0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3, 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 4, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9, 5, 5.1, 5.2, 5.3, 5.4, 5.5}

        'Voltlist = New Single() {-3, -2.9, -2.8, -2.7, -2.6, -2.5, -2.4, -2.3, -2.2, -2.1, -2, -1.9, -1.8, -1.7, -1.6, -1.5, -1.4, -1.3, -1.2, -1.1, -1, -0.9, -0.8, -0.7, -0.6, -0.5, -0.4, -0.3, -0.2, -0.1, 0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3, 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 4, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9, 5, 5.1, 5.2, 5.3, 5.4, 5.5, 5.6, 5.7, 5.8, 5.9, 6, 6.1, 6.2, 6.3, 6.4, 6.5, 6.6, 6.7, 6.8, 6.9, 7, 7.1, 7.2, 7.3, 7.4, 7.5, 7.6, 7.7, 7.8, 7.9, 8, 8.1, 8.2, 8.3, 8.4, 8.5}


        size = Voltlist.Length()

        CurrentRd = New Single(size) {}
        ElRd = New Single(size) {}
        EffRd = New Single(size) {}

        KeiIniAM()
        System.Threading.Thread.Sleep(1000)
        InitNewport()
        System.Threading.Thread.Sleep(1000)
        k = 0
        Do Until k = 3
            i = 0
            Do Until i = size
                DUT_AGICH1VOLT(Voltlist(i))
                System.Threading.Thread.Sleep(100)
                CurrentRd(i) = KeiCurrReading()
                ElRd(i) = ReadIntensity()
                i = i + 1
            Loop

            AbortAGI_CH1()

            i = 0
            Do Until i = size
                EffRd(i) = ElRd(i) / (CurrentRd(i) * Voltlist(i))
                i = i + 1
            Loop

            '' note: Eff here is just fraction not percentage 

            Filename = k.ToString() + "-IVL.txt"

            Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
            Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}{3,-16:E}"
            objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}", "Voltage", "Current", "El", "Efficiency")
            For x = 0 To size - 1
                objWriterTrans.WriteLine(LineFormatTrans, Voltlist(x), CurrentRd(x), ElRd(x), EffRd(x))
            Next
            objWriterTrans.Close()

            k = k + 1
            System.Threading.Thread.Sleep(1000)

        Loop
        
        AbortAGI_CH1()

    End Sub

    Public Sub testImeas()
        KeiIniAM()
        KeiCurrReading()
    End Sub





    Public Sub NewUltraMR35()                            '''''''''''''''''''''''''''''try catch solution / using keitley source meter /  constant device current / different device driving current ''''''STANDARD USMFE MEASUREMENT WITH MEL measurement
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer
        Dim currentlistnum As Integer

        Dim newDeviceVoltage() As Single
        Dim newDeviceEl() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single
        Dim devicecurrentlist() As Single
        Dim devicecurrentlistsize As Integer
        Dim Brev As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        currentlistnum = 0
        Brev = -1
        'Kcoil = 1806.67

        'Kcoil = 1800.163 '''''COIL Z
        'Kcoil = 1644.96 ''''''coil z / device current up
        'Kcoil = 1813.13  '''''COIL Z with Keithley source meter
        Kcoil = 1597.5  '''''Coil Z while measuring MEL, new probe position
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        'Kcoil = 1584.6  '''''COIL Y measuring MEL, new probe position
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -500, 0, -400, 0}
        'designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}

        ''''''''''ultra small field
        'designedBfield = New Single() {0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0}

        ''''small field
        'designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}

        ''''H-alq
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}
        'designedBfield = New Single() {0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -990, 0, -980, 0, -970, 0, -960, 0, -950, 0, -940, 0, -930, 0, -920, 0, -910, 0, -900, 0, -895, 0, -890, 0, -885, 0, -880, 0, -875, 0, -870, 0, -865, 0, -860, 0, -855, 0, -850, 0, -845, 0, -840, 0, -835, 0, -830, 0, -825, 0, -820, 0, -815, 0, -810, 0, -805, 0, -800, 0, -795, 0, -790, 0, -785, 0, -780, 0, -775, 0, -770, 0, -765, 0, -760, 0, -755, 0, -750, 0, -745, 0, -740, 0, -735, 0, -730, 0, -725, 0, -720, 0, -715, 0, -710, 0, -705, 0, -700, 0, -695, 0, -690, 0, -685, 0, -680, 0, -675, 0, -670, 0, -665, 0, -660, 0, -655, 0, -650, 0, -645, 0, -640, 0, -635, 0, -630, 0, -625, 0, -620, 0, -615, 0, -610, 0, -605, 0, -600, 0, -595, 0, -590, 0, -585, 0, -580, 0, -575, 0, -570, 0, -565, 0, -560, 0, -555, 0, -550, 0, -545, 0, -540, 0, -535, 0, -530, 0, -525, 0, -520, 0, -515, 0, -510, 0, -505, 0, -500, 0, -490, 0, -480, 0, -470, 0, -460, 0, -450, 0, -440, 0, -430, 0, -420, 0, -410, 0, -400, 0, -390, 0, -380, 0, -370, 0, -360, 0, -350, 0, -340, 0, -330, 0, -320, 0, -310, 0, -300, 0, -290, 0, -280, 0, -270, 0, -260, 0, -250, 0, -240, 0, -230, 0, -220, 0, -210, 0, -200, 0, -190, 0, -180, 0, -170, 0, -160, 0, -150, 0, -140, 0, -130, 0, -120, 0, -110, 0, -100, 0, -90, 0, -80, 0, -70, 0, -60, 0, -50, 0, -40, 0, -30, 0, -20, 0, -10, 0, 0, 0, 10, 0, 20, 0, 30, 0, 40, 0, 50, 0, 60, 0, 70, 0, 80, 0, 90, 0, 100, 0, 110, 0, 120, 0, 130, 0, 140, 0, 150, 0, 160, 0, 170, 0, 180, 0, 190, 0, 200, 0, 210, 0, 220, 0, 230, 0, 240, 0, 250, 0, 260, 0, 270, 0, 280, 0, 290, 0, 300, 0, 310, 0, 320, 0, 330, 0, 340, 0, 350, 0, 360, 0, 370, 0, 380, 0, 390, 0, 400, 0, 410, 0, 420, 0, 430, 0, 440, 0, 450, 0, 460, 0, 470, 0, 480, 0, 490, 0, 500, 0, 505, 0, 510, 0, 515, 0, 520, 0, 525, 0, 530, 0, 535, 0, 540, 0, 545, 0, 550, 0, 555, 0, 560, 0, 565, 0, 570, 0, 575, 0, 580, 0, 585, 0, 590, 0, 595, 0, 600, 0, 605, 0, 610, 0, 615, 0, 620, 0, 625, 0, 630, 0, 635, 0, 640, 0, 645, 0, 650, 0, 655, 0, 660, 0, 665, 0, 670, 0, 675, 0, 680, 0, 685, 0, 690, 0, 695, 0, 700, 0, 705, 0, 710, 0, 715, 0, 720, 0, 725, 0, 730, 0, 735, 0, 740, 0, 745, 0, 750, 0, 755, 0, 760, 0, 765, 0, 770, 0, 775, 0, 780, 0, 785, 0, 790, 0, 795, 0, 800, 0, 805, 0, 810, 0, 815, 0, 820, 0, 825, 0, 830, 0, 835, 0, 840, 0, 845, 0, 850, 0, 855, 0, 860, 0, 865, 0, 870, 0, 875, 0, 880, 0, 885, 0, 890, 0, 895, 0, 900, 0, 910, 0, 920, 0, 930, 0, 940, 0, 950, 0, 960, 0, 970, 0, 980, 0, 990, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0}
        designedBfield = New Single() {0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1490, 0, -1480, 0, -1470, 0, -1460, 0, -1450, 0, -1440, 0, -1430, 0, -1420, 0, -1410, 0, -1400, 0, -1390, 0, -1380, 0, -1370, 0, -1360, 0, -1350, 0, -1340, 0, -1330, 0, -1320, 0, -1310, 0, -1300, 0, -1290, 0, -1280, 0, -1270, 0, -1260, 0, -1250, 0, -1240, 0, -1230, 0, -1220, 0, -1210, 0, -1200, 0, -1190, 0, -1180, 0, -1170, 0, -1160, 0, -1150, 0, -1140, 0, -1130, 0, -1120, 0, -1110, 0, -1100, 0, -1090, 0, -1080, 0, -1070, 0, -1060, 0, -1050, 0, -1040, 0, -1030, 0, -1020, 0, -1010, 0, -1000, 0, -995, 0, -990, 0, -985, 0, -980, 0, -975, 0, -970, 0, -965, 0, -960, 0, -955, 0, -950, 0, -947.5, 0, -945, 0, -942.5, 0, -940, 0, -937.5, 0, -935, 0, -932.5, 0, -930, 0, -927.5, 0, -925, 0, -922.5, 0, -920, 0, -917.5, 0, -915, 0, -912.5, 0, -910, 0, -907.5, 0, -905, 0, -902.5, 0, -900, 0, -897.5, 0, -895, 0, -892.5, 0, -890, 0, -887.5, 0, -885, 0, -882.5, 0, -880, 0, -877.5, 0, -875, 0, -872.5, 0, -870, 0, -867.5, 0, -865, 0, -862.5, 0, -860, 0, -857.5, 0, -855, 0, -852.5, 0, -850, 0, -847.5, 0, -845, 0, -842.5, 0, -840, 0, -837.5, 0, -835, 0, -832.5, 0, -830, 0, -827.5, 0, -825, 0, -822.5, 0, -820, 0, -817.5, 0, -815, 0, -812.5, 0, -810, 0, -807.5, 0, -805, 0, -802.5, 0, -800, 0, -797.5, 0, -795, 0, -792.5, 0, -790, 0, -787.5, 0, -785, 0, -782.5, 0, -780, 0, -777.5, 0, -775, 0, -772.5, 0, -770, 0, -767.5, 0, -765, 0, -762.5, 0, -760, 0, -757.5, 0, -755, 0, -752.5, 0, -750, 0, -747.5, 0, -745, 0, -742.5, 0, -740, 0, -737.5, 0, -735, 0, -732.5, 0, -730, 0, -727.5, 0, -725, 0, -722.5, 0, -720, 0, -717.5, 0, -715, 0, -712.5, 0, -710, 0, -707.5, 0, -705, 0, -702.5, 0, -700, 0, -697.5, 0, -695, 0, -692.5, 0, -690, 0, -687.5, 0, -685, 0, -682.5, 0, -680, 0, -677.5, 0, -675, 0, -672.5, 0, -670, 0, -667.5, 0, -665, 0, -662.5, 0, -660, 0, -657.5, 0, -655, 0, -652.5, 0, -650, 0, -647.5, 0, -645, 0, -642.5, 0, -640, 0, -637.5, 0, -635, 0, -632.5, 0, -630, 0, -627.5, 0, -625, 0, -622.5, 0, -620, 0, -617.5, 0, -615, 0, -612.5, 0, -610, 0, -607.5, 0, -605, 0, -602.5, 0, -600, 0, -597.5, 0, -595, 0, -592.5, 0, -590, 0, -587.5, 0, -585, 0, -582.5, 0, -580, 0, -577.5, 0, -575, 0, -572.5, 0, -570, 0, -567.5, 0, -565, 0, -562.5, 0, -560, 0, -557.5, 0, -555, 0, -552.5, 0, -550, 0, -547.5, 0, -545, 0, -542.5, 0, -540, 0, -537.5, 0, -535, 0, -532.5, 0, -530, 0, -527.5, 0, -525, 0, -522.5, 0, -520, 0, -517.5, 0, -515, 0, -512.5, 0, -510, 0, -507.5, 0, -505, 0, -502.5, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -295, 0, -290, 0, -285, 0, -280, 0, -275, 0, -270, 0, -265, 0, -260, 0, -255, 0, -250, 0, -245, 0, -240, 0, -235, 0, -230, 0, -225, 0, -220, 0, -215, 0, -210, 0, -205, 0, -200, 0, -195, 0, -190, 0, -185, 0, -180, 0, -175, 0, -170, 0, -165, 0, -160, 0, -155, 0, -150, 0, -145, 0, -140, 0, -135, 0, -130, 0, -125, 0, -120, 0, -115, 0, -110, 0, -108, 0, -106, 0, -104, 0, -102, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -58, 0, -56, 0, -54, 0, -52, 0, -50, 0, -48, 0, -46, 0, -44, 0, -42, 0, -40, 0, -38, 0, -36, 0, -34, 0, -32, 0, -30, 0, -28, 0, -26, 0, -24, 0, -22, 0, -20, 0, -18, 0, -16, 0, -14, 0, -12, 0, -10, 0, -8, 0, -6, 0, -4, 0, -2, 0, 0, 0, 2, 0, 4, 0, 6, 0, 8, 0, 10, 0, 12, 0, 14, 0, 16, 0, 18, 0, 20, 0, 22, 0, 24, 0, 26, 0, 28, 0, 30, 0, 32, 0, 34, 0, 36, 0, 38, 0, 40, 0, 42, 0, 44, 0, 46, 0, 48, 0, 50, 0, 52, 0, 54, 0, 56, 0, 58, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102, 0, 104, 0, 106, 0, 108, 0, 110, 0, 115, 0, 120, 0, 125, 0, 130, 0, 135, 0, 140, 0, 145, 0, 150, 0, 155, 0, 160, 0, 165, 0, 170, 0, 175, 0, 180, 0, 185, 0, 190, 0, 195, 0, 200, 0, 205, 0, 210, 0, 215, 0, 220, 0, 225, 0, 230, 0, 235, 0, 240, 0, 245, 0, 250, 0, 255, 0, 260, 0, 265, 0, 270, 0, 275, 0, 280, 0, 285, 0, 290, 0, 295, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 502.5, 0, 505, 0, 507.5, 0, 510, 0, 512.5, 0, 515, 0, 517.5, 0, 520, 0, 522.5, 0, 525, 0, 527.5, 0, 530, 0, 532.5, 0, 535, 0, 537.5, 0, 540, 0, 542.5, 0, 545, 0, 547.5, 0, 550, 0, 552.5, 0, 555, 0, 557.5, 0, 560, 0, 562.5, 0, 565, 0, 567.5, 0, 570, 0, 572.5, 0, 575, 0, 577.5, 0, 580, 0, 582.5, 0, 585, 0, 587.5, 0, 590, 0, 592.5, 0, 595, 0, 597.5, 0, 600, 0, 602.5, 0, 605, 0, 607.5, 0, 610, 0, 612.5, 0, 615, 0, 617.5, 0, 620, 0, 622.5, 0, 625, 0, 627.5, 0, 630, 0, 632.5, 0, 635, 0, 637.5, 0, 640, 0, 642.5, 0, 645, 0, 647.5, 0, 650, 0, 652.5, 0, 655, 0, 657.5, 0, 660, 0, 662.5, 0, 665, 0, 667.5, 0, 670, 0, 672.5, 0, 675, 0, 677.5, 0, 680, 0, 682.5, 0, 685, 0, 687.5, 0, 690, 0, 692.5, 0, 695, 0, 697.5, 0, 700, 0, 702.5, 0, 705, 0, 707.5, 0, 710, 0, 712.5, 0, 715, 0, 717.5, 0, 720, 0, 722.5, 0, 725, 0, 727.5, 0, 730, 0, 732.5, 0, 735, 0, 737.5, 0, 740, 0, 742.5, 0, 745, 0, 747.5, 0, 750, 0, 752.5, 0, 755, 0, 757.5, 0, 760, 0, 762.5, 0, 765, 0, 767.5, 0, 770, 0, 772.5, 0, 775, 0, 777.5, 0, 780, 0, 782.5, 0, 785, 0, 787.5, 0, 790, 0, 792.5, 0, 795, 0, 797.5, 0, 800, 0, 802.5, 0, 805, 0, 807.5, 0, 810, 0, 812.5, 0, 815, 0, 817.5, 0, 820, 0, 822.5, 0, 825, 0, 827.5, 0, 830, 0, 832.5, 0, 835, 0, 837.5, 0, 840, 0, 842.5, 0, 845, 0, 847.5, 0, 850, 0, 852.5, 0, 855, 0, 857.5, 0, 860, 0, 862.5, 0, 865, 0, 867.5, 0, 870, 0, 872.5, 0, 875, 0, 877.5, 0, 880, 0, 882.5, 0, 885, 0, 887.5, 0, 890, 0, 892.5, 0, 895, 0, 897.5, 0, 900, 0, 902.5, 0, 905, 0, 907.5, 0, 910, 0, 912.5, 0, 915, 0, 917.5, 0, 920, 0, 922.5, 0, 925, 0, 927.5, 0, 930, 0, 932.5, 0, 935, 0, 937.5, 0, 940, 0, 942.5, 0, 945, 0, 947.5, 0, 950, 0, 955, 0, 960, 0, 965, 0, 970, 0, 975, 0, 980, 0, 985, 0, 990, 0, 995, 0, 1000, 0, 1010, 0, 1020, 0, 1030, 0, 1040, 0, 1050, 0, 1060, 0, 1070, 0, 1080, 0, 1090, 0, 1100, 0, 1110, 0, 1120, 0, 1130, 0, 1140, 0, 1150, 0, 1160, 0, 1170, 0, 1180, 0, 1190, 0, 1200, 0, 1210, 0, 1220, 0, 1230, 0, 1240, 0, 1250, 0, 1260, 0, 1270, 0, 1280, 0, 1290, 0, 1300, 0, 1310, 0, 1320, 0, 1330, 0, 1340, 0, 1350, 0, 1360, 0, 1370, 0, 1380, 0, 1390, 0, 1400, 0, 1410, 0, 1420, 0, 1430, 0, 1440, 0, 1450, 0, 1460, 0, 1470, 0, 1480, 0, 1490, 0, 1500, 0}
        'designedBfield = New Single() {0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0}


        ''''new recipe''''''designedBfield = New Single() {0, -800, 0, -800, 0, -800, 0, -800, 0, -800, 0, -800, 0, -800, 0, -800, 0, -800, 0, -800, 0, -800, 0, -800, 0, -760, 0, -720, 0, -680, 0, -640, 0, -600, 0, -560, 0, -520, 0, -515, 0, -510, 0, -505, 0, -500, 0, -497.5, 0, -495, 0, -492.5, 0, -490, 0, -487.5, 0, -485, 0, -482.5, 0, -480, 0, -477.5, 0, -475, 0, -472.5, 0, -470, 0, -467.5, 0, -465, 0, -462.5, 0, -460, 0, -457.5, 0, -455, 0, -452.5, 0, -450, 0, -447.5, 0, -445, 0, -442.5, 0, -440, 0, -437.5, 0, -435, 0, -432.5, 0, -430, 0, -427.5, 0, -425, 0, -422.5, 0, -420, 0, -417.5, 0, -415, 0, -412.5, 0, -410, 0, -407.5, 0, -405, 0, -402.5, 0, -400, 0, -397.5, 0, -395, 0, -392.5, 0, -390, 0, -387.5, 0, -385, 0, -382.5, 0, -380, 0, -377.5, 0, -375, 0, -372.5, 0, -370, 0, -367.5, 0, -365, 0, -362.5, 0, -360, 0, -357.5, 0, -355, 0, -352.5, 0, -350, 0, -347.5, 0, -345, 0, -342.5, 0, -340, 0, -337.5, 0, -335, 0, -332.5, 0, -330, 0, -327.5, 0, -325, 0, -322.5, 0, -320, 0, -317.5, 0, -315, 0, -312.5, 0, -310, 0, -307.5, 0, -305, 0, -302.5, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -195, 0, -190, 0, -185, 0, -180, 0, -175, 0, -170, 0, -165, 0, -160, 0, -155, 0, -150, 0, -145, 0, -140, 0, -135, 0, -130, 0, -125, 0, -120, 0, -115, 0, -110, 0, -105, 0, -100, 0, -95, 0, -90, 0, -85, 0, -80, 0, -75, 0, -70, 0, -65, 0, -60, 0, -55, 0, -50, 0, -45, 0, -40, 0, -35, 0, -30, 0, -25, 0, -20, 0, -15, 0, -10, 0, -5, 0, 0, 0, 5, 0, 10, 0, 15, 0, 20, 0, 25, 0, 30, 0, 35, 0, 40, 0, 45, 0, 50, 0, 55, 0, 60, 0, 65, 0, 70, 0, 75, 0, 80, 0, 85, 0, 90, 0, 95, 0, 100, 0, 105, 0, 110, 0, 115, 0, 120, 0, 125, 0, 130, 0, 135, 0, 140, 0, 145, 0, 150, 0, 155, 0, 160, 0, 165, 0, 170, 0, 175, 0, 180, 0, 185, 0, 190, 0, 195, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 302.5, 0, 305, 0, 307.5, 0, 310, 0, 312.5, 0, 315, 0, 317.5, 0, 320, 0, 322.5, 0, 325, 0, 327.5, 0, 330, 0, 332.5, 0, 335, 0, 337.5, 0, 340, 0, 342.5, 0, 345, 0, 347.5, 0, 350, 0, 352.5, 0, 355, 0, 357.5, 0, 360, 0, 362.5, 0, 365, 0, 367.5, 0, 370, 0, 372.5, 0, 375, 0, 377.5, 0, 380, 0, 382.5, 0, 385, 0, 387.5, 0, 390, 0, 392.5, 0, 395, 0, 397.5, 0, 400, 0, 402.5, 0, 405, 0, 407.5, 0, 410, 0, 412.5, 0, 415, 0, 417.5, 0, 420, 0, 422.5, 0, 425, 0, 427.5, 0, 430, 0, 432.5, 0, 435, 0, 437.5, 0, 440, 0, 442.5, 0, 445, 0, 447.5, 0, 450, 0, 452.5, 0, 455, 0, 457.5, 0, 460, 0, 462.5, 0, 465, 0, 467.5, 0, 470, 0, 472.5, 0, 475, 0, 477.5, 0, 480, 0, 482.5, 0, 485, 0, 487.5, 0, 490, 0, 492.5, 0, 495, 0, 497.5, 0, 500, 0, 505, 0, 510, 0, 515, 0, 520, 0, 560, 0, 600, 0, 640, 0, 680, 0, 720, 0, 760, 0, 800, 0}




        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, 500, 0, 500, 0, 500, 0, 500, 0, -500}


        '''''''''designedBfield = New Single() {0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}
        ''''''hysteresis 
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}

        'designedBfield = New Single() {0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0}

        '''''ultra small field
        'designedBfield = New Single() {0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0}

        ''''''large field 
        'designedBfield = New Single() {0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -400, 0, -300, 0, -200, 0, -100, 0, 0, 0, 100, 0, 200, 0, 300, 0, 400, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}

        '''''''large field + small field
        'designedBfield = New Single() {0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -480, 0, -460, 0, -440, 0, -420, 0, -400, 0, -380, 0, -360, 0, -340, 0, -320, 0, -300, 0, -280, 0, -260, 0, -240, 0, -220, 0, -200, 0, -180, 0, -160, 0, -140, 0, -120, 0, -100, 0, -80, 0, -60, 0, -40, 0, -20, 0, 0, 0, 20, 0, 40, 0, 60, 0, 80, 0, 100, 0, 120, 0, 140, 0, 160, 0, 180, 0, 200, 0, 220, 0, 240, 0, 260, 0, 280, 0, 300, 0, 320, 0, 340, 0, 360, 0, 380, 0, 400, 0, 420, 0, 440, 0, 460, 0, 480, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}
        'designedBfield = New Single() {0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1680, 0, -1660, 0, -1640, 0, -1620, 0, -1600, 0, -1580, 0, -1560, 0, -1540, 0, -1520, 0, -1500, 0, -1480, 0, -1460, 0, -1440, 0, -1420, 0, -1400, 0, -1380, 0, -1360, 0, -1340, 0, -1320, 0, -1300, 0, -1280, 0, -1260, 0, -1240, 0, -1220, 0, -1200, 0, -1180, 0, -1160, 0, -1140, 0, -1120, 0, -1100, 0, -1080, 0, -1060, 0, -1040, 0, -1020, 0, -1000, 0, -980, 0, -960, 0, -940, 0, -920, 0, -900, 0, -880, 0, -860, 0, -840, 0, -820, 0, -800, 0, -780, 0, -760, 0, -740, 0, -720, 0, -700, 0, -680, 0, -660, 0, -640, 0, -620, 0, -600, 0, -580, 0, -560, 0, -540, 0, -520, 0, -500, 0, -450, 0, -400, 0, -350, 0, -300, 0, -250, 0, -200, 0, -150, 0, -100, 0, -50, 0, 0, 0, 50, 0, 100, 0, 150, 0, 200, 0, 250, 0, 300, 0, 350, 0, 400, 0, 450, 0, 500, 0, 520, 0, 540, 0, 560, 0, 580, 0, 600, 0, 620, 0, 640, 0, 660, 0, 680, 0, 700, 0, 720, 0, 740, 0, 760, 0, 780, 0, 800, 0, 820, 0, 840, 0, 860, 0, 880, 0, 900, 0, 920, 0, 940, 0, 960, 0, 980, 0, 1000, 0, 1020, 0, 1040, 0, 1060, 0, 1080, 0, 1100, 0, 1120, 0, 1140, 0, 1160, 0, 1180, 0, 1200, 0, 1220, 0, 1240, 0, 1260, 0, 1280, 0, 1300, 0, 1320, 0, 1340, 0, 1360, 0, 1380, 0, 1400, 0, 1420, 0, 1440, 0, 1460, 0, 1480, 0, 1500, 0, 1520, 0, 1540, 0, 1560, 0, 1580, 0, 1600, 0, 1620, 0, 1640, 0, 1660, 0, 1680, 0, 1700, 0}

        'designedBfield = New Single() {0, -600, 0, -580, 0, -560, 0, -540, 0, -520, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 520, 0, 540, 0, 560, 0, 580, 0, 600, 0}

        devicecurrentlist = New Single() {0.000002}



        size = designedBfield.Length()
        devicecurrentlistsize = devicecurrentlist.Length()


        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}
        newDeviceEl = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        'KeiIniVM()    ''''''Initialize Keithley as Voltmeter

        InitNewport()
        System.Threading.Thread.Sleep(1000)

        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        Do Until currentlistnum = devicecurrentlistsize

            If devicecurrentlist(currentlistnum) < 0.00000005 Then

                DeviceCond(devicecurrentlist(currentlistnum))  'device pre-conditioning before 100 runs at certain drive condition

                fileNum = 59
                y = 0

                inittime = DateTime.Now()

                Try

                    Do Until y = 41



                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()
                        System.Threading.Thread.Sleep(1000)


                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)


                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(300)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            newDeviceEl(x) = ReadIntensity()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}{3,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}", "Bfield", "Voltage", "El", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), newDeviceEl(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                End Try

            Else

                DeviceCond(0.0002) 'device pre-conditioning before 100 runs at certain drive conditon

                fileNum = 0
                y = 0

                inittime = DateTime.Now()

                Try

                    Do Until y = 100
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()
                        System.Threading.Thread.Sleep(1000)


                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)


                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(300)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            newDeviceEl(x) = ReadIntensity()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}{3,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}", "Bfield", "Voltage", "El", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), newDeviceEl(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 100
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop
                End Try
            End If





            currentlistnum = currentlistnum + 1
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortKEI_SM()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()





    End Sub

    Public Sub NewUltraMR36()                            ''''''constant V measurement'''''
        XXX = 0

        'DeviceBField0 = New Single(1000) {}
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer
        Dim currentlistnum As Integer
        Dim voltagelistnum As Integer

        Dim newDeviceVoltage() As Single
        Dim newDeviceCurrent() As Single
        Dim newDeviceEl() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single
        Dim devicecurrentlist() As Single
        Dim devicevoltagelist() As Single
        Dim devicecurrentlistsize As Integer
        Dim devicevoltagelistsize As Integer
        Dim Brev As Single


        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        currentlistnum = 0
        Brev = -1
        'Kcoil = 1806.67

        'Kcoil = 1800.163 '''''COIL Z
        'Kcoil = 1644.96 ''''''coil z / device current up
        'Kcoil = 1813.13  '''''COIL Z with Keithley source meter
        Kcoil = 1574   '''''Coil Z while measuring MEL, new probe position
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        'Kcoil = 1584.6  '''''COIL Y measuring MEL, new probe position
        fileNum = 0

        'designedBfield = New Single() {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -395, -390, -385, -380, -375, -370, -365, -360, -355, -350, -345, -340, -335, -330, -325, -320, -315, -310, -305, -300, -297.5, -295, -292.5, -290, -287.5, -285, -282.5, -280, -277.5, -275, -272.5, -270, -267.5, -265, -262.5, -260, -257.5, -255, -252.5, -250, -247.5, -245, -242.5, -240, -237.5, -235, -232.5, -230, -229, -228, -227, -226, -225, -224, -223, -222, -221, -220, -219, -218, -217, -216, -215, -214, -213, -212, -211, -210, -207.5, -205, -202.5, -200, -197.5, -195, -192.5, -190, -187.5, -185, -182.5, -180, -177.5, -175, -172.5, -170, -167.5, -165, -162.5, -160, -157.5, -155, -152.5, -150, -147.5, -145, -142.5, -140, -137.5, -135, -132.5, -130, -127.5, -125, -122.5, -120, -117.5, -115, -112.5, -110, -107.5, -105, -102.5, -100, -98, -96, -94, -92, -90, -88, -86, -84, -82, -80, -78, -76, -74, -72, -70, -68, -66, -64, -62, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102.5, 105, 107.5, 110, 112.5, 115, 117.5, 120, 122.5, 125, 127.5, 130, 132.5, 135, 137.5, 140, 142.5, 145, 147.5, 150, 152.5, 155, 157.5, 160, 162.5, 165, 167.5, 170, 172.5, 175, 177.5, 180, 182.5, 185, 187.5, 190, 192.5, 195, 197.5, 200, 202.5, 205, 207.5, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 232.5, 235, 237.5, 240, 242.5, 245, 247.5, 250, 252.5, 255, 257.5, 260, 262.5, 265, 267.5, 270, 272.5, 275, 277.5, 280, 282.5, 285, 287.5, 290, 292.5, 295, 297.5, 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355, 360, 365, 370, 375, 380, 385, 390, 395, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 395, 390, 385, 380, 375, 370, 365, 360, 355, 350, 345, 340, 335, 330, 325, 320, 315, 310, 305, 300, 297.5, 295, 292.5, 290, 287.5, 285, 282.5, 280, 277.5, 275, 272.5, 270, 267.5, 265, 262.5, 260, 257.5, 255, 252.5, 250, 247.5, 245, 242.5, 240, 237.5, 235, 232.5, 230, 229, 228, 227, 226, 225, 224, 223, 222, 221, 220, 219, 218, 217, 216, 215, 214, 213, 212, 211, 210, 207.5, 205, 202.5, 200, 197.5, 195, 192.5, 190, 187.5, 185, 182.5, 180, 177.5, 175, 172.5, 170, 167.5, 165, 162.5, 160, 157.5, 155, 152.5, 150, 147.5, 145, 142.5, 140, 137.5, 135, 132.5, 130, 127.5, 125, 122.5, 120, 117.5, 115, 112.5, 110, 107.5, 105, 102.5, 100, 98, 96, 94, 92, 90, 88, 86, 84, 82, 80, 78, 76, 74, 72, 70, 68, 66, 64, 62, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4, -5, -6, -7, -8, -9, -10, -11, -12, -13, -14, -15, -16, -17, -18, -19, -20, -21, -22, -23, -24, -25, -26, -27, -28, -29, -30, -31, -32, -33, -34, -35, -36, -37, -38, -39, -40, -41, -42, -43, -44, -45, -46, -47, -48, -49, -50, -51, -52, -53, -54, -55, -56, -57, -58, -59, -60, -62, -64, -66, -68, -70, -72, -74, -76, -78, -80, -82, -84, -86, -88, -90, -92, -94, -96, -98, -100, -102.5, -105, -107.5, -110, -112.5, -115, -117.5, -120, -122.5, -125, -127.5, -130, -132.5, -135, -137.5, -140, -142.5, -145, -147.5, -150, -152.5, -155, -157.5, -160, -162.5, -165, -167.5, -170, -172.5, -175, -177.5, -180, -182.5, -185, -187.5, -190, -192.5, -195, -197.5, -200, -202.5, -205, -207.5, -210, -211, -212, -213, -214, -215, -216, -217, -218, -219, -220, -221, -222, -223, -224, -225, -226, -227, -228, -229, -230, -232.5, -235, -237.5, -240, -242.5, -245, -247.5, -250, -252.5, -255, -257.5, -260, -262.5, -265, -267.5, -270, -272.5, -275, -277.5, -280, -282.5, -285, -287.5, -290, -292.5, -295, -297.5, -300, -305, -310, -315, -320, -325, -330, -335, -340, -345, -350, -355, -360, -365, -370, -375, -380, -385, -390, -395, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, -400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}
        'designedBfield = New Single() {0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -229, 0, -228, 0, -227, 0, -226, 0, -225, 0, -224, 0, -223, 0, -222, 0, -221, 0, -220, 0, -219, 0, -218, 0, -217, 0, -216, 0, -215, 0, -214, 0, -213, 0, -212, 0, -211, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 211, 0, 212, 0, 213, 0, 214, 0, 215, 0, 216, 0, 217, 0, 218, 0, 219, 0, 220, 0, 221, 0, 222, 0, 223, 0, 224, 0, 225, 0, 226, 0, 227, 0, 228, 0, 229, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0}
        'designedBfield = New Single() {0, -500, 0, -400, 0}
        'designedBfield = New Single() {0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -199, 0, -198, 0, -197, 0, -196, 0, -195, 0, -194, 0, -193, 0, -192, 0, -191, 0, -190, 0, -189, 0, -188, 0, -187, 0, -186, 0, -185, 0, -184, 0, -183, 0, -182, 0, -181, 0, -180, 0, -179, 0, -178, 0, -177, 0, -176, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 176, 0, 177, 0, 178, 0, 179, 0, 180, 0, 181, 0, 182, 0, 183, 0, 184, 0, 185, 0, 186, 0, 187, 0, 188, 0, 189, 0, 190, 0, 191, 0, 192, 0, 193, 0, 194, 0, 195, 0, 196, 0, 197, 0, 198, 0, 199, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0}

        ''''''''''ultra small field
        'designedBfield = New Single() {0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0}

        ''''small field
        'designedBfield = New Single() {0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}

        ''''H-alq
        designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0}
        'designedBfield = New Single() {0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -990, 0, -980, 0, -970, 0, -960, 0, -950, 0, -940, 0, -930, 0, -920, 0, -910, 0, -900, 0, -895, 0, -890, 0, -885, 0, -880, 0, -875, 0, -870, 0, -865, 0, -860, 0, -855, 0, -850, 0, -845, 0, -840, 0, -835, 0, -830, 0, -825, 0, -820, 0, -815, 0, -810, 0, -805, 0, -800, 0, -795, 0, -790, 0, -785, 0, -780, 0, -775, 0, -770, 0, -765, 0, -760, 0, -755, 0, -750, 0, -745, 0, -740, 0, -735, 0, -730, 0, -725, 0, -720, 0, -715, 0, -710, 0, -705, 0, -700, 0, -695, 0, -690, 0, -685, 0, -680, 0, -675, 0, -670, 0, -665, 0, -660, 0, -655, 0, -650, 0, -645, 0, -640, 0, -635, 0, -630, 0, -625, 0, -620, 0, -615, 0, -610, 0, -605, 0, -600, 0, -595, 0, -590, 0, -585, 0, -580, 0, -575, 0, -570, 0, -565, 0, -560, 0, -555, 0, -550, 0, -545, 0, -540, 0, -535, 0, -530, 0, -525, 0, -520, 0, -515, 0, -510, 0, -505, 0, -500, 0, -490, 0, -480, 0, -470, 0, -460, 0, -450, 0, -440, 0, -430, 0, -420, 0, -410, 0, -400, 0, -390, 0, -380, 0, -370, 0, -360, 0, -350, 0, -340, 0, -330, 0, -320, 0, -310, 0, -300, 0, -290, 0, -280, 0, -270, 0, -260, 0, -250, 0, -240, 0, -230, 0, -220, 0, -210, 0, -200, 0, -190, 0, -180, 0, -170, 0, -160, 0, -150, 0, -140, 0, -130, 0, -120, 0, -110, 0, -100, 0, -90, 0, -80, 0, -70, 0, -60, 0, -50, 0, -40, 0, -30, 0, -20, 0, -10, 0, 0, 0, 10, 0, 20, 0, 30, 0, 40, 0, 50, 0, 60, 0, 70, 0, 80, 0, 90, 0, 100, 0, 110, 0, 120, 0, 130, 0, 140, 0, 150, 0, 160, 0, 170, 0, 180, 0, 190, 0, 200, 0, 210, 0, 220, 0, 230, 0, 240, 0, 250, 0, 260, 0, 270, 0, 280, 0, 290, 0, 300, 0, 310, 0, 320, 0, 330, 0, 340, 0, 350, 0, 360, 0, 370, 0, 380, 0, 390, 0, 400, 0, 410, 0, 420, 0, 430, 0, 440, 0, 450, 0, 460, 0, 470, 0, 480, 0, 490, 0, 500, 0, 505, 0, 510, 0, 515, 0, 520, 0, 525, 0, 530, 0, 535, 0, 540, 0, 545, 0, 550, 0, 555, 0, 560, 0, 565, 0, 570, 0, 575, 0, 580, 0, 585, 0, 590, 0, 595, 0, 600, 0, 605, 0, 610, 0, 615, 0, 620, 0, 625, 0, 630, 0, 635, 0, 640, 0, 645, 0, 650, 0, 655, 0, 660, 0, 665, 0, 670, 0, 675, 0, 680, 0, 685, 0, 690, 0, 695, 0, 700, 0, 705, 0, 710, 0, 715, 0, 720, 0, 725, 0, 730, 0, 735, 0, 740, 0, 745, 0, 750, 0, 755, 0, 760, 0, 765, 0, 770, 0, 775, 0, 780, 0, 785, 0, 790, 0, 795, 0, 800, 0, 805, 0, 810, 0, 815, 0, 820, 0, 825, 0, 830, 0, 835, 0, 840, 0, 845, 0, 850, 0, 855, 0, 860, 0, 865, 0, 870, 0, 875, 0, 880, 0, 885, 0, 890, 0, 895, 0, 900, 0, 910, 0, 920, 0, 930, 0, 940, 0, 950, 0, 960, 0, 970, 0, 980, 0, 990, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0}
        'designedBfield = New Single() {0, -500, 0, -400, 0}

        'designedBfield = New Single() {0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1500, 0, -1490, 0, -1480, 0, -1470, 0, -1460, 0, -1450, 0, -1440, 0, -1430, 0, -1420, 0, -1410, 0, -1400, 0, -1390, 0, -1380, 0, -1370, 0, -1360, 0, -1350, 0, -1340, 0, -1330, 0, -1320, 0, -1310, 0, -1300, 0, -1290, 0, -1280, 0, -1270, 0, -1260, 0, -1250, 0, -1240, 0, -1230, 0, -1220, 0, -1210, 0, -1200, 0, -1190, 0, -1180, 0, -1170, 0, -1160, 0, -1150, 0, -1140, 0, -1130, 0, -1120, 0, -1110, 0, -1100, 0, -1090, 0, -1080, 0, -1070, 0, -1060, 0, -1050, 0, -1040, 0, -1030, 0, -1020, 0, -1010, 0, -1000, 0, -995, 0, -990, 0, -985, 0, -980, 0, -975, 0, -970, 0, -965, 0, -960, 0, -955, 0, -950, 0, -947.5, 0, -945, 0, -942.5, 0, -940, 0, -937.5, 0, -935, 0, -932.5, 0, -930, 0, -927.5, 0, -925, 0, -922.5, 0, -920, 0, -917.5, 0, -915, 0, -912.5, 0, -910, 0, -907.5, 0, -905, 0, -902.5, 0, -900, 0, -897.5, 0, -895, 0, -892.5, 0, -890, 0, -887.5, 0, -885, 0, -882.5, 0, -880, 0, -877.5, 0, -875, 0, -872.5, 0, -870, 0, -867.5, 0, -865, 0, -862.5, 0, -860, 0, -857.5, 0, -855, 0, -852.5, 0, -850, 0, -847.5, 0, -845, 0, -842.5, 0, -840, 0, -837.5, 0, -835, 0, -832.5, 0, -830, 0, -827.5, 0, -825, 0, -822.5, 0, -820, 0, -817.5, 0, -815, 0, -812.5, 0, -810, 0, -807.5, 0, -805, 0, -802.5, 0, -800, 0, -797.5, 0, -795, 0, -792.5, 0, -790, 0, -787.5, 0, -785, 0, -782.5, 0, -780, 0, -777.5, 0, -775, 0, -772.5, 0, -770, 0, -767.5, 0, -765, 0, -762.5, 0, -760, 0, -757.5, 0, -755, 0, -752.5, 0, -750, 0, -747.5, 0, -745, 0, -742.5, 0, -740, 0, -737.5, 0, -735, 0, -732.5, 0, -730, 0, -727.5, 0, -725, 0, -722.5, 0, -720, 0, -717.5, 0, -715, 0, -712.5, 0, -710, 0, -707.5, 0, -705, 0, -702.5, 0, -700, 0, -697.5, 0, -695, 0, -692.5, 0, -690, 0, -687.5, 0, -685, 0, -682.5, 0, -680, 0, -677.5, 0, -675, 0, -672.5, 0, -670, 0, -667.5, 0, -665, 0, -662.5, 0, -660, 0, -657.5, 0, -655, 0, -652.5, 0, -650, 0, -647.5, 0, -645, 0, -642.5, 0, -640, 0, -637.5, 0, -635, 0, -632.5, 0, -630, 0, -627.5, 0, -625, 0, -622.5, 0, -620, 0, -617.5, 0, -615, 0, -612.5, 0, -610, 0, -607.5, 0, -605, 0, -602.5, 0, -600, 0, -597.5, 0, -595, 0, -592.5, 0, -590, 0, -587.5, 0, -585, 0, -582.5, 0, -580, 0, -577.5, 0, -575, 0, -572.5, 0, -570, 0, -567.5, 0, -565, 0, -562.5, 0, -560, 0, -557.5, 0, -555, 0, -552.5, 0, -550, 0, -547.5, 0, -545, 0, -542.5, 0, -540, 0, -537.5, 0, -535, 0, -532.5, 0, -530, 0, -527.5, 0, -525, 0, -522.5, 0, -520, 0, -517.5, 0, -515, 0, -512.5, 0, -510, 0, -507.5, 0, -505, 0, -502.5, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -295, 0, -290, 0, -285, 0, -280, 0, -275, 0, -270, 0, -265, 0, -260, 0, -255, 0, -250, 0, -245, 0, -240, 0, -235, 0, -230, 0, -225, 0, -220, 0, -215, 0, -210, 0, -205, 0, -200, 0, -195, 0, -190, 0, -185, 0, -180, 0, -175, 0, -170, 0, -165, 0, -160, 0, -155, 0, -150, 0, -145, 0, -140, 0, -135, 0, -130, 0, -125, 0, -120, 0, -115, 0, -110, 0, -108, 0, -106, 0, -104, 0, -102, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -58, 0, -56, 0, -54, 0, -52, 0, -50, 0, -48, 0, -46, 0, -44, 0, -42, 0, -40, 0, -38, 0, -36, 0, -34, 0, -32, 0, -30, 0, -28, 0, -26, 0, -24, 0, -22, 0, -20, 0, -18, 0, -16, 0, -14, 0, -12, 0, -10, 0, -8, 0, -6, 0, -4, 0, -2, 0, 0, 0, 2, 0, 4, 0, 6, 0, 8, 0, 10, 0, 12, 0, 14, 0, 16, 0, 18, 0, 20, 0, 22, 0, 24, 0, 26, 0, 28, 0, 30, 0, 32, 0, 34, 0, 36, 0, 38, 0, 40, 0, 42, 0, 44, 0, 46, 0, 48, 0, 50, 0, 52, 0, 54, 0, 56, 0, 58, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102, 0, 104, 0, 106, 0, 108, 0, 110, 0, 115, 0, 120, 0, 125, 0, 130, 0, 135, 0, 140, 0, 145, 0, 150, 0, 155, 0, 160, 0, 165, 0, 170, 0, 175, 0, 180, 0, 185, 0, 190, 0, 195, 0, 200, 0, 205, 0, 210, 0, 215, 0, 220, 0, 225, 0, 230, 0, 235, 0, 240, 0, 245, 0, 250, 0, 255, 0, 260, 0, 265, 0, 270, 0, 275, 0, 280, 0, 285, 0, 290, 0, 295, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 502.5, 0, 505, 0, 507.5, 0, 510, 0, 512.5, 0, 515, 0, 517.5, 0, 520, 0, 522.5, 0, 525, 0, 527.5, 0, 530, 0, 532.5, 0, 535, 0, 537.5, 0, 540, 0, 542.5, 0, 545, 0, 547.5, 0, 550, 0, 552.5, 0, 555, 0, 557.5, 0, 560, 0, 562.5, 0, 565, 0, 567.5, 0, 570, 0, 572.5, 0, 575, 0, 577.5, 0, 580, 0, 582.5, 0, 585, 0, 587.5, 0, 590, 0, 592.5, 0, 595, 0, 597.5, 0, 600, 0, 602.5, 0, 605, 0, 607.5, 0, 610, 0, 612.5, 0, 615, 0, 617.5, 0, 620, 0, 622.5, 0, 625, 0, 627.5, 0, 630, 0, 632.5, 0, 635, 0, 637.5, 0, 640, 0, 642.5, 0, 645, 0, 647.5, 0, 650, 0, 652.5, 0, 655, 0, 657.5, 0, 660, 0, 662.5, 0, 665, 0, 667.5, 0, 670, 0, 672.5, 0, 675, 0, 677.5, 0, 680, 0, 682.5, 0, 685, 0, 687.5, 0, 690, 0, 692.5, 0, 695, 0, 697.5, 0, 700, 0, 702.5, 0, 705, 0, 707.5, 0, 710, 0, 712.5, 0, 715, 0, 717.5, 0, 720, 0, 722.5, 0, 725, 0, 727.5, 0, 730, 0, 732.5, 0, 735, 0, 737.5, 0, 740, 0, 742.5, 0, 745, 0, 747.5, 0, 750, 0, 752.5, 0, 755, 0, 757.5, 0, 760, 0, 762.5, 0, 765, 0, 767.5, 0, 770, 0, 772.5, 0, 775, 0, 777.5, 0, 780, 0, 782.5, 0, 785, 0, 787.5, 0, 790, 0, 792.5, 0, 795, 0, 797.5, 0, 800, 0, 802.5, 0, 805, 0, 807.5, 0, 810, 0, 812.5, 0, 815, 0, 817.5, 0, 820, 0, 822.5, 0, 825, 0, 827.5, 0, 830, 0, 832.5, 0, 835, 0, 837.5, 0, 840, 0, 842.5, 0, 845, 0, 847.5, 0, 850, 0, 852.5, 0, 855, 0, 857.5, 0, 860, 0, 862.5, 0, 865, 0, 867.5, 0, 870, 0, 872.5, 0, 875, 0, 877.5, 0, 880, 0, 882.5, 0, 885, 0, 887.5, 0, 890, 0, 892.5, 0, 895, 0, 897.5, 0, 900, 0, 902.5, 0, 905, 0, 907.5, 0, 910, 0, 912.5, 0, 915, 0, 917.5, 0, 920, 0, 922.5, 0, 925, 0, 927.5, 0, 930, 0, 932.5, 0, 935, 0, 937.5, 0, 940, 0, 942.5, 0, 945, 0, 947.5, 0, 950, 0, 955, 0, 960, 0, 965, 0, 970, 0, 975, 0, 980, 0, 985, 0, 990, 0, 995, 0, 1000, 0, 1010, 0, 1020, 0, 1030, 0, 1040, 0, 1050, 0, 1060, 0, 1070, 0, 1080, 0, 1090, 0, 1100, 0, 1110, 0, 1120, 0, 1130, 0, 1140, 0, 1150, 0, 1160, 0, 1170, 0, 1180, 0, 1190, 0, 1200, 0, 1210, 0, 1220, 0, 1230, 0, 1240, 0, 1250, 0, 1260, 0, 1270, 0, 1280, 0, 1290, 0, 1300, 0, 1310, 0, 1320, 0, 1330, 0, 1340, 0, 1350, 0, 1360, 0, 1370, 0, 1380, 0, 1390, 0, 1400, 0, 1410, 0, 1420, 0, 1430, 0, 1440, 0, 1450, 0, 1460, 0, 1470, 0, 1480, 0, 1490, 0, 1500, 0}
        'designedBfield = New Single() {0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0}


        ''''new recipe''''''designedBfield = New Single() {0, -800, 0, -800, 0, -800, 0, -800, 0, -800, 0, -800, 0, -800, 0, -800, 0, -800, 0, -800, 0, -800, 0, -800, 0, -760, 0, -720, 0, -680, 0, -640, 0, -600, 0, -560, 0, -520, 0, -515, 0, -510, 0, -505, 0, -500, 0, -497.5, 0, -495, 0, -492.5, 0, -490, 0, -487.5, 0, -485, 0, -482.5, 0, -480, 0, -477.5, 0, -475, 0, -472.5, 0, -470, 0, -467.5, 0, -465, 0, -462.5, 0, -460, 0, -457.5, 0, -455, 0, -452.5, 0, -450, 0, -447.5, 0, -445, 0, -442.5, 0, -440, 0, -437.5, 0, -435, 0, -432.5, 0, -430, 0, -427.5, 0, -425, 0, -422.5, 0, -420, 0, -417.5, 0, -415, 0, -412.5, 0, -410, 0, -407.5, 0, -405, 0, -402.5, 0, -400, 0, -397.5, 0, -395, 0, -392.5, 0, -390, 0, -387.5, 0, -385, 0, -382.5, 0, -380, 0, -377.5, 0, -375, 0, -372.5, 0, -370, 0, -367.5, 0, -365, 0, -362.5, 0, -360, 0, -357.5, 0, -355, 0, -352.5, 0, -350, 0, -347.5, 0, -345, 0, -342.5, 0, -340, 0, -337.5, 0, -335, 0, -332.5, 0, -330, 0, -327.5, 0, -325, 0, -322.5, 0, -320, 0, -317.5, 0, -315, 0, -312.5, 0, -310, 0, -307.5, 0, -305, 0, -302.5, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -195, 0, -190, 0, -185, 0, -180, 0, -175, 0, -170, 0, -165, 0, -160, 0, -155, 0, -150, 0, -145, 0, -140, 0, -135, 0, -130, 0, -125, 0, -120, 0, -115, 0, -110, 0, -105, 0, -100, 0, -95, 0, -90, 0, -85, 0, -80, 0, -75, 0, -70, 0, -65, 0, -60, 0, -55, 0, -50, 0, -45, 0, -40, 0, -35, 0, -30, 0, -25, 0, -20, 0, -15, 0, -10, 0, -5, 0, 0, 0, 5, 0, 10, 0, 15, 0, 20, 0, 25, 0, 30, 0, 35, 0, 40, 0, 45, 0, 50, 0, 55, 0, 60, 0, 65, 0, 70, 0, 75, 0, 80, 0, 85, 0, 90, 0, 95, 0, 100, 0, 105, 0, 110, 0, 115, 0, 120, 0, 125, 0, 130, 0, 135, 0, 140, 0, 145, 0, 150, 0, 155, 0, 160, 0, 165, 0, 170, 0, 175, 0, 180, 0, 185, 0, 190, 0, 195, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 302.5, 0, 305, 0, 307.5, 0, 310, 0, 312.5, 0, 315, 0, 317.5, 0, 320, 0, 322.5, 0, 325, 0, 327.5, 0, 330, 0, 332.5, 0, 335, 0, 337.5, 0, 340, 0, 342.5, 0, 345, 0, 347.5, 0, 350, 0, 352.5, 0, 355, 0, 357.5, 0, 360, 0, 362.5, 0, 365, 0, 367.5, 0, 370, 0, 372.5, 0, 375, 0, 377.5, 0, 380, 0, 382.5, 0, 385, 0, 387.5, 0, 390, 0, 392.5, 0, 395, 0, 397.5, 0, 400, 0, 402.5, 0, 405, 0, 407.5, 0, 410, 0, 412.5, 0, 415, 0, 417.5, 0, 420, 0, 422.5, 0, 425, 0, 427.5, 0, 430, 0, 432.5, 0, 435, 0, 437.5, 0, 440, 0, 442.5, 0, 445, 0, 447.5, 0, 450, 0, 452.5, 0, 455, 0, 457.5, 0, 460, 0, 462.5, 0, 465, 0, 467.5, 0, 470, 0, 472.5, 0, 475, 0, 477.5, 0, 480, 0, 482.5, 0, 485, 0, 487.5, 0, 490, 0, 492.5, 0, 495, 0, 497.5, 0, 500, 0, 505, 0, 510, 0, 515, 0, 520, 0, 560, 0, 600, 0, 640, 0, 680, 0, 720, 0, 760, 0, 800, 0}




        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, 500, 0, 500, 0, 500, 0, 500, 0, -500}


        '''''''''designedBfield = New Single() {0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}
        ''''''hysteresis 
        'designedBfield = New Single() {0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 500, 0, 495, 0, 490, 0, 485, 0, 480, 0, 475, 0, 470, 0, 465, 0, 460, 0, 455, 0, 450, 0, 445, 0, 440, 0, 435, 0, 430, 0, 425, 0, 420, 0, 415, 0, 410, 0, 405, 0, 400, 0, 395, 0, 390, 0, 385, 0, 380, 0, 375, 0, 370, 0, 365, 0, 360, 0, 355, 0, 350, 0, 345, 0, 340, 0, 335, 0, 330, 0, 325, 0, 320, 0, 315, 0, 310, 0, 305, 0, 300, 0, 297.5, 0, 295, 0, 292.5, 0, 290, 0, 287.5, 0, 285, 0, 282.5, 0, 280, 0, 277.5, 0, 275, 0, 272.5, 0, 270, 0, 267.5, 0, 265, 0, 262.5, 0, 260, 0, 257.5, 0, 255, 0, 252.5, 0, 250, 0, 247.5, 0, 245, 0, 242.5, 0, 240, 0, 237.5, 0, 235, 0, 232.5, 0, 230, 0, 227.5, 0, 225, 0, 222.5, 0, 220, 0, 217.5, 0, 215, 0, 212.5, 0, 210, 0, 207.5, 0, 205, 0, 202.5, 0, 200, 0, 197.5, 0, 195, 0, 192.5, 0, 190, 0, 187.5, 0, 185, 0, 182.5, 0, 180, 0, 177.5, 0, 175, 0, 172.5, 0, 170, 0, 167.5, 0, 165, 0, 162.5, 0, 160, 0, 157.5, 0, 155, 0, 152.5, 0, 150, 0, 147.5, 0, 145, 0, 142.5, 0, 140, 0, 137.5, 0, 135, 0, 132.5, 0, 130, 0, 127.5, 0, 125, 0, 122.5, 0, 120, 0, 117.5, 0, 115, 0, 112.5, 0, 110, 0, 109, 0, 108, 0, 107, 0, 106, 0, 105, 0, 104, 0, 103, 0, 102, 0, 101, 0, 100, 0, 99, 0, 98, 0, 97, 0, 96, 0, 95, 0, 94, 0, 93, 0, 92, 0, 91, 0, 90, 0, 89, 0, 88, 0, 87, 0, 86, 0, 85, 0, 84, 0, 83, 0, 82, 0, 81, 0, 80, 0, 79, 0, 78, 0, 77, 0, 76, 0, 75, 0, 74, 0, 73, 0, 72, 0, 71, 0, 70, 0, 69, 0, 68, 0, 67, 0, 66, 0, 65, 0, 64, 0, 63, 0, 62, 0, 61, 0, 60, 0, 59, 0, 58, 0, 57, 0, 56, 0, 55, 0, 54, 0, 53, 0, 52, 0, 51, 0, 50, 0, 49, 0, 48, 0, 47, 0, 46, 0, 45, 0, 44, 0, 43, 0, 42, 0, 41, 0, 40, 0, 39, 0, 38, 0, 37, 0, 36, 0, 35, 0, 34, 0, 33, 0, 32, 0, 31, 0, 30, 0, 29, 0, 28, 0, 27, 0, 26, 0, 25, 0, 24, 0, 23, 0, 22, 0, 21, 0, 20, 0, 19, 0, 18, 0, 17, 0, 16, 0, 15, 0, 14, 0, 13, 0, 12, 0, 11, 0, 10, 0, 9, 0, 8, 0, 7, 0, 6, 0, 5, 0, 4, 0, 3, 0, 2, 0, 1, 0, 0, 0, -1, 0, -2, 0, -3, 0, -4, 0, -5, 0, -6, 0, -7, 0, -8, 0, -9, 0, -10, 0, -11, 0, -12, 0, -13, 0, -14, 0, -15, 0, -16, 0, -17, 0, -18, 0, -19, 0, -20, 0, -21, 0, -22, 0, -23, 0, -24, 0, -25, 0, -26, 0, -27, 0, -28, 0, -29, 0, -30, 0, -31, 0, -32, 0, -33, 0, -34, 0, -35, 0, -36, 0, -37, 0, -38, 0, -39, 0, -40, 0, -41, 0, -42, 0, -43, 0, -44, 0, -45, 0, -46, 0, -47, 0, -48, 0, -49, 0, -50, 0, -51, 0, -52, 0, -53, 0, -54, 0, -55, 0, -56, 0, -57, 0, -58, 0, -59, 0, -60, 0, -61, 0, -62, 0, -63, 0, -64, 0, -65, 0, -66, 0, -67, 0, -68, 0, -69, 0, -70, 0, -71, 0, -72, 0, -73, 0, -74, 0, -75, 0, -76, 0, -77, 0, -78, 0, -79, 0, -80, 0, -81, 0, -82, 0, -83, 0, -84, 0, -85, 0, -86, 0, -87, 0, -88, 0, -89, 0, -90, 0, -91, 0, -92, 0, -93, 0, -94, 0, -95, 0, -96, 0, -97, 0, -98, 0, -99, 0, -100, 0, -101, 0, -102, 0, -103, 0, -104, 0, -105, 0, -106, 0, -107, 0, -108, 0, -109, 0, -110, 0, -112.5, 0, -115, 0, -117.5, 0, -120, 0, -122.5, 0, -125, 0, -127.5, 0, -130, 0, -132.5, 0, -135, 0, -137.5, 0, -140, 0, -142.5, 0, -145, 0, -147.5, 0, -150, 0, -152.5, 0, -155, 0, -157.5, 0, -160, 0, -162.5, 0, -165, 0, -167.5, 0, -170, 0, -172.5, 0, -175, 0, -177.5, 0, -180, 0, -182.5, 0, -185, 0, -187.5, 0, -190, 0, -192.5, 0, -195, 0, -197.5, 0, -200, 0, -202.5, 0, -205, 0, -207.5, 0, -210, 0, -212.5, 0, -215, 0, -217.5, 0, -220, 0, -222.5, 0, -225, 0, -227.5, 0, -230, 0, -232.5, 0, -235, 0, -237.5, 0, -240, 0, -242.5, 0, -245, 0, -247.5, 0, -250, 0, -252.5, 0, -255, 0, -257.5, 0, -260, 0, -262.5, 0, -265, 0, -267.5, 0, -270, 0, -272.5, 0, -275, 0, -277.5, 0, -280, 0, -282.5, 0, -285, 0, -287.5, 0, -290, 0, -292.5, 0, -295, 0, -297.5, 0, -300, 0, -305, 0, -310, 0, -315, 0, -320, 0, -325, 0, -330, 0, -335, 0, -340, 0, -345, 0, -350, 0, -355, 0, -360, 0, -365, 0, -370, 0, -375, 0, -380, 0, -385, 0, -390, 0, -395, 0, -400, 0, -405, 0, -410, 0, -415, 0, -420, 0, -425, 0, -430, 0, -435, 0, -440, 0, -445, 0, -450, 0, -455, 0, -460, 0, -465, 0, -470, 0, -475, 0, -480, 0, -485, 0, -490, 0, -495, 0, -500, 0}

        'designedBfield = New Single() {0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0}

        '''''ultra small field
        'designedBfield = New Single() {0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -109, 0, -108, 0, -107, 0, -106, 0, -105, 0, -104, 0, -103, 0, -102, 0, -101, 0, -100, 0, -99, 0, -98, 0, -97, 0, -96, 0, -95, 0, -94, 0, -93, 0, -92, 0, -91, 0, -90, 0, -89, 0, -88, 0, -87, 0, -86, 0, -85, 0, -84, 0, -83, 0, -82, 0, -81, 0, -80, 0, -79, 0, -78, 0, -77, 0, -76, 0, -75, 0, -74, 0, -73, 0, -72, 0, -71, 0, -70, 0, -69, 0, -68, 0, -67, 0, -66, 0, -65, 0, -64, 0, -63, 0, -62, 0, -61, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 61, 0, 62, 0, 63, 0, 64, 0, 65, 0, 66, 0, 67, 0, 68, 0, 69, 0, 70, 0, 71, 0, 72, 0, 73, 0, 74, 0, 75, 0, 76, 0, 77, 0, 78, 0, 79, 0, 80, 0, 81, 0, 82, 0, 83, 0, 84, 0, 85, 0, 86, 0, 87, 0, 88, 0, 89, 0, 90, 0, 91, 0, 92, 0, 93, 0, 94, 0, 95, 0, 96, 0, 97, 0, 98, 0, 99, 0, 100, 0, 101, 0, 102, 0, 103, 0, 104, 0, 105, 0, 106, 0, 107, 0, 108, 0, 109, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0}

        ''''''large field 
        'designedBfield = New Single() {0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -400, 0, -300, 0, -200, 0, -100, 0, 0, 0, 100, 0, 200, 0, 300, 0, 400, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}

        '''''''large field + small field
        'designedBfield = New Single() {0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1800, 0, -1700, 0, -1600, 0, -1500, 0, -1400, 0, -1300, 0, -1200, 0, -1100, 0, -1000, 0, -900, 0, -800, 0, -700, 0, -600, 0, -500, 0, -480, 0, -460, 0, -440, 0, -420, 0, -400, 0, -380, 0, -360, 0, -340, 0, -320, 0, -300, 0, -280, 0, -260, 0, -240, 0, -220, 0, -200, 0, -180, 0, -160, 0, -140, 0, -120, 0, -100, 0, -80, 0, -60, 0, -40, 0, -20, 0, 0, 0, 20, 0, 40, 0, 60, 0, 80, 0, 100, 0, 120, 0, 140, 0, 160, 0, 180, 0, 200, 0, 220, 0, 240, 0, 260, 0, 280, 0, 300, 0, 320, 0, 340, 0, 360, 0, 380, 0, 400, 0, 420, 0, 440, 0, 460, 0, 480, 0, 500, 0, 600, 0, 700, 0, 800, 0, 900, 0, 1000, 0, 1100, 0, 1200, 0, 1300, 0, 1400, 0, 1500, 0, 1600, 0, 1700, 0, 1800, 0}
        'designedBfield = New Single() {0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1700, 0, -1680, 0, -1660, 0, -1640, 0, -1620, 0, -1600, 0, -1580, 0, -1560, 0, -1540, 0, -1520, 0, -1500, 0, -1480, 0, -1460, 0, -1440, 0, -1420, 0, -1400, 0, -1380, 0, -1360, 0, -1340, 0, -1320, 0, -1300, 0, -1280, 0, -1260, 0, -1240, 0, -1220, 0, -1200, 0, -1180, 0, -1160, 0, -1140, 0, -1120, 0, -1100, 0, -1080, 0, -1060, 0, -1040, 0, -1020, 0, -1000, 0, -980, 0, -960, 0, -940, 0, -920, 0, -900, 0, -880, 0, -860, 0, -840, 0, -820, 0, -800, 0, -780, 0, -760, 0, -740, 0, -720, 0, -700, 0, -680, 0, -660, 0, -640, 0, -620, 0, -600, 0, -580, 0, -560, 0, -540, 0, -520, 0, -500, 0, -450, 0, -400, 0, -350, 0, -300, 0, -250, 0, -200, 0, -150, 0, -100, 0, -50, 0, 0, 0, 50, 0, 100, 0, 150, 0, 200, 0, 250, 0, 300, 0, 350, 0, 400, 0, 450, 0, 500, 0, 520, 0, 540, 0, 560, 0, 580, 0, 600, 0, 620, 0, 640, 0, 660, 0, 680, 0, 700, 0, 720, 0, 740, 0, 760, 0, 780, 0, 800, 0, 820, 0, 840, 0, 860, 0, 880, 0, 900, 0, 920, 0, 940, 0, 960, 0, 980, 0, 1000, 0, 1020, 0, 1040, 0, 1060, 0, 1080, 0, 1100, 0, 1120, 0, 1140, 0, 1160, 0, 1180, 0, 1200, 0, 1220, 0, 1240, 0, 1260, 0, 1280, 0, 1300, 0, 1320, 0, 1340, 0, 1360, 0, 1380, 0, 1400, 0, 1420, 0, 1440, 0, 1460, 0, 1480, 0, 1500, 0, 1520, 0, 1540, 0, 1560, 0, 1580, 0, 1600, 0, 1620, 0, 1640, 0, 1660, 0, 1680, 0, 1700, 0}

        'designedBfield = New Single() {0, -600, 0, -580, 0, -560, 0, -540, 0, -520, 0, -500, 0, -495, 0, -490, 0, -485, 0, -480, 0, -475, 0, -470, 0, -465, 0, -460, 0, -455, 0, -450, 0, -445, 0, -440, 0, -435, 0, -430, 0, -425, 0, -420, 0, -415, 0, -410, 0, -405, 0, -400, 0, -395, 0, -390, 0, -385, 0, -380, 0, -375, 0, -370, 0, -365, 0, -360, 0, -355, 0, -350, 0, -345, 0, -340, 0, -335, 0, -330, 0, -325, 0, -320, 0, -315, 0, -310, 0, -305, 0, -300, 0, -297.5, 0, -295, 0, -292.5, 0, -290, 0, -287.5, 0, -285, 0, -282.5, 0, -280, 0, -277.5, 0, -275, 0, -272.5, 0, -270, 0, -267.5, 0, -265, 0, -262.5, 0, -260, 0, -257.5, 0, -255, 0, -252.5, 0, -250, 0, -247.5, 0, -245, 0, -242.5, 0, -240, 0, -237.5, 0, -235, 0, -232.5, 0, -230, 0, -227.5, 0, -225, 0, -222.5, 0, -220, 0, -217.5, 0, -215, 0, -212.5, 0, -210, 0, -207.5, 0, -205, 0, -202.5, 0, -200, 0, -197.5, 0, -195, 0, -192.5, 0, -190, 0, -187.5, 0, -185, 0, -182.5, 0, -180, 0, -177.5, 0, -175, 0, -172.5, 0, -170, 0, -167.5, 0, -165, 0, -162.5, 0, -160, 0, -157.5, 0, -155, 0, -152.5, 0, -150, 0, -147.5, 0, -145, 0, -142.5, 0, -140, 0, -137.5, 0, -135, 0, -132.5, 0, -130, 0, -127.5, 0, -125, 0, -122.5, 0, -120, 0, -117.5, 0, -115, 0, -112.5, 0, -110, 0, -107.5, 0, -105, 0, -102.5, 0, -100, 0, -98, 0, -96, 0, -94, 0, -92, 0, -90, 0, -88, 0, -86, 0, -84, 0, -82, 0, -80, 0, -78, 0, -76, 0, -74, 0, -72, 0, -70, 0, -68, 0, -66, 0, -64, 0, -62, 0, -60, 0, -59, 0, -58, 0, -57, 0, -56, 0, -55, 0, -54, 0, -53, 0, -52, 0, -51, 0, -50, 0, -49, 0, -48, 0, -47, 0, -46, 0, -45, 0, -44, 0, -43, 0, -42, 0, -41, 0, -40, 0, -39, 0, -38, 0, -37, 0, -36, 0, -35, 0, -34, 0, -33, 0, -32, 0, -31, 0, -30, 0, -29, 0, -28, 0, -27, 0, -26, 0, -25, 0, -24, 0, -23, 0, -22, 0, -21, 0, -20, 0, -19, 0, -18, 0, -17, 0, -16, 0, -15, 0, -14, 0, -13, 0, -12, 0, -11, 0, -10, 0, -9, 0, -8, 0, -7, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7, 0, 8, 0, 9, 0, 10, 0, 11, 0, 12, 0, 13, 0, 14, 0, 15, 0, 16, 0, 17, 0, 18, 0, 19, 0, 20, 0, 21, 0, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0, 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0, 37, 0, 38, 0, 39, 0, 40, 0, 41, 0, 42, 0, 43, 0, 44, 0, 45, 0, 46, 0, 47, 0, 48, 0, 49, 0, 50, 0, 51, 0, 52, 0, 53, 0, 54, 0, 55, 0, 56, 0, 57, 0, 58, 0, 59, 0, 60, 0, 62, 0, 64, 0, 66, 0, 68, 0, 70, 0, 72, 0, 74, 0, 76, 0, 78, 0, 80, 0, 82, 0, 84, 0, 86, 0, 88, 0, 90, 0, 92, 0, 94, 0, 96, 0, 98, 0, 100, 0, 102.5, 0, 105, 0, 107.5, 0, 110, 0, 112.5, 0, 115, 0, 117.5, 0, 120, 0, 122.5, 0, 125, 0, 127.5, 0, 130, 0, 132.5, 0, 135, 0, 137.5, 0, 140, 0, 142.5, 0, 145, 0, 147.5, 0, 150, 0, 152.5, 0, 155, 0, 157.5, 0, 160, 0, 162.5, 0, 165, 0, 167.5, 0, 170, 0, 172.5, 0, 175, 0, 177.5, 0, 180, 0, 182.5, 0, 185, 0, 187.5, 0, 190, 0, 192.5, 0, 195, 0, 197.5, 0, 200, 0, 202.5, 0, 205, 0, 207.5, 0, 210, 0, 212.5, 0, 215, 0, 217.5, 0, 220, 0, 222.5, 0, 225, 0, 227.5, 0, 230, 0, 232.5, 0, 235, 0, 237.5, 0, 240, 0, 242.5, 0, 245, 0, 247.5, 0, 250, 0, 252.5, 0, 255, 0, 257.5, 0, 260, 0, 262.5, 0, 265, 0, 267.5, 0, 270, 0, 272.5, 0, 275, 0, 277.5, 0, 280, 0, 282.5, 0, 285, 0, 287.5, 0, 290, 0, 292.5, 0, 295, 0, 297.5, 0, 300, 0, 305, 0, 310, 0, 315, 0, 320, 0, 325, 0, 330, 0, 335, 0, 340, 0, 345, 0, 350, 0, 355, 0, 360, 0, 365, 0, 370, 0, 375, 0, 380, 0, 385, 0, 390, 0, 395, 0, 400, 0, 405, 0, 410, 0, 415, 0, 420, 0, 425, 0, 430, 0, 435, 0, 440, 0, 445, 0, 450, 0, 455, 0, 460, 0, 465, 0, 470, 0, 475, 0, 480, 0, 485, 0, 490, 0, 495, 0, 500, 0, 520, 0, 540, 0, 560, 0, 580, 0, 600, 0}

        'devicecurrentlist = New Single() {0.000002, 0.000039}
        devicevoltagelist = New Single() {3}


        size = designedBfield.Length()
        'devicecurrentlistsize = devicecurrentlist.Length()
        devicevoltagelistsize = devicevoltagelist.Length()

        'newDeviceVoltage = New Single(size) {}
        newDeviceCurrent = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}
        newDeviceEl = New Single(size) {}

        ' Do Until x = size
        'designedIcoil(x) = (designedBfield(x) + Blocal) / 1806.67
        'x = x + 1
        'Loop

        'KeiIniVM()    ''''''Initialize Keithley as Voltmeter

        InitNewport()
        System.Threading.Thread.Sleep(1000)

        'Z_AGICH2(((0 + Blocal) / 1806.67))       '''''''zero the field for the device to condition

        'System.Threading.Thread.Sleep(2000)  '''''''wait for 2s until the B field gets stable at 0uT

        '''''wait the inilization B field to get stable

        x = 0

        Do Until voltagelistnum = devicevoltagelistsize

            If devicevoltagelist(voltagelistnum) < 0.00000005 Then

                'DeviceCond(devicecurrentlist(currentlistnum))  'device pre-conditioning before 100 runs at certain drive condition

                fileNum = 59
                y = 0

                inittime = DateTime.Now()

                Try

                    Do Until y = 41



                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()
                        System.Threading.Thread.Sleep(1000)


                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)


                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(300)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            newDeviceEl(x) = ReadIntensity()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}{3,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}", "Bfield", "Voltage", "El", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), newDeviceEl(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 40
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                End Try

            Else

                'DeviceCond(0.0002) 'device pre-conditioning before 100 runs at certain drive conditon
                DeviceCondV(6)

                fileNum = 0
                y = 0

                inittime = DateTime.Now()

                Try

                    Do Until y = 200
                        x = 0
                        Blocal = 0
                        z = 0

                        'KeiIniVM()
                        KeiIniAM()
                        System.Threading.Thread.Sleep(1000)


                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)


                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)

                        DUT_AGICH1VOLT(devicevoltagelist(voltagelistnum))          ''''''source the device with different constant voltage biases
                        'DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(300)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            'newDeviceVoltage(x) = KeiVoltReading()
                            newDeviceCurrent(x) = KeiCurrReading()
                            newDeviceEl(x) = ReadIntensity()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicevoltagelist(voltagelistnum), "##0.0000000000") + " V -" + fileNum.ToString() + ".txt"

                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}{3,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}", "Bfield", "Current", "El", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceCurrent(x), newDeviceEl(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop

                Catch ex As NationalInstruments.NI4882.GpibException
                    System.Threading.Thread.Sleep(10000)
                    AbortAGI_CH1()
                    System.Threading.Thread.Sleep(5000)
                    AbortKEI_SM()
                    System.Threading.Thread.Sleep(5000)
                    'AbortKEI_4200()
                    'System.Threading.Thread.Sleep(5000)

                    Do Until y = 100
                        x = 0
                        Blocal = 0
                        z = 0

                        KeiIniVM()

                        'AbortAGI_CH2()
                        AbortKEI_SM()
                        System.Threading.Thread.Sleep(2000)
                        Do Until z = 3
                            Blocal = B2_Reading() + Blocal
                            System.Threading.Thread.Sleep(3000)
                            z = z + 1
                        Loop

                        Blocal = -(Blocal / 3)

                        Do Until x = size
                            designedIcoil(x) = (designedBfield(x) + Blocal) / Kcoil
                            x = x + 1
                        Loop

                        'ONAGI_CH2()
                        ONKEI_SM()
                        System.Threading.Thread.Sleep(1000)

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))


                        System.Threading.Thread.Sleep(2000)


                        DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with 2uA constant current bias

                        System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                        'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list

                        Z_KEI(designedIcoil(0))

                        System.Threading.Thread.Sleep(2000)

                        x = 0
                        Do Until x = size
                            Diff = 50
                            'Z_AGICH2(designedIcoil(x))
                            Z_KEI(designedIcoil(x))
                            System.Threading.Thread.Sleep(1500)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 
                            Diffnum = 0
                            'Do Until (Diff < 3.5 Or Diff = 3.5)             '''''''''small field range
                            Do Until (Diff < 15 Or Diff = 15)           '''''''''large field range
                                Bnow = B2_Reading()
                                Diff = Math.Abs(Bnow - designedBfield(x))
                                System.Threading.Thread.Sleep(30)
                                Diffnum = Diffnum + 1
                                If Diffnum > 100 Then
                                    If (Bnow - designedBfield(x)) > 0 Then
                                        'Z_AGICH2(designedIcoil(x) - 0.00025)
                                        Z_KEI(designedIcoil(x) - 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    ElseIf (Bnow - designedBfield(x)) < 0 Then
                                        'Z_AGICH2(designedIcoil(x) + 0.00025)
                                        Z_KEI(designedIcoil(x) + 0.00025)
                                        System.Threading.Thread.Sleep(1000)
                                    End If
                                End If

                            Loop                                            ''''''''''check if the current B field is really the Bsetpoint? / to resolve the non-null field problem 

                            newRealBfield(x) = Bnow
                            newDeviceVoltage(x) = KeiVoltReading()
                            currenttime = DateTime.Now()
                            MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                            x = x + 1
                        Loop
                        AbortAGI_CH1()

                        'AbortKEI_4200()

                        'Z_AGICH2(((0 + Blocal) / Kcoil))
                        Z_KEI(((0 + Blocal) / Kcoil))

                        FILETIME = DateTime.Now.ToString()
                        FILETIME = FILETIME.Replace("/", "_")
                        FILETIME = FILETIME.Replace(":", "_")

                        'Filename = FILETIME + "-" + "MRscan.txt"
                        Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"
                        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                        objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                        For x = 0 To size - 1
                            objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                        Next
                        objWriterTrans.Close()

                        y = y + 1
                        fileNum = fileNum + 1
                        System.Threading.Thread.Sleep(10000)
                    Loop
                End Try
            End If





            currentlistnum = currentlistnum + 1
        Loop

        System.Threading.Thread.Sleep(5000)
        AbortAGI_CH1()
        System.Threading.Thread.Sleep(5000)
        AbortKEI_SM()
        System.Threading.Thread.Sleep(5000)
        Siglent_Abort()





    End Sub



    Public Function SetMagB(SetField As Single) As Single
        Dim GPIBGaussmeter1
        GPIBGaussmeter1 = 10
        Dim GpibDevice = New Device(0, CInt(GPIBGaussmeter1))
        Dim Ramp As Boolean
        SetMagB = 0

        GpibDevice.Write("CSETP " + Trim(Str(SetField / 1000)))

        Ramp = False

        Do Until Ramp = True
            Application.DoEvents()

            Ramp = CheckBRamp(SetField, GpibDevice)
        Loop
        'System.Threading.Thread.Sleep(1000)
        GpibDevice.Write("RDGFIELD?")
        SetMagB = Val(GpibDevice.ReadString()) * 1000

        GpibDevice.Dispose()

    End Function

    Public Function CheckBRamp(SetField As Single, GpibDevice As Device) As Boolean
        Dim Field As Single, Difference As Single
        Dim BFieldAccuracy As Single
        BFieldAccuracy = 0.05

        GpibDevice.Write("RDGFIELD?")
        Field = Val(GpibDevice.ReadString()) * 1000
        '
        Difference = Math.Abs(SetField - Field)
        If Difference < BFieldAccuracy Then
            CheckBRamp = True
        Else
            CheckBRamp = False
        End If
    End Function

    Public Sub FindMagnetPSU()
        Dim MessageIn As String
        Dim GPIBMagnetPSU As Integer
        GPIBMagnetPSU = 3

        MessageIn = ""

        Dim GpibDevice = New Device(0, CInt(GPIBMagnetPSU))
        GpibDevice.Write("*IDN?")
        MessageIn = GpibDevice.ReadString()
        '
        If Left$(MessageIn, 13) = "LSCI,MODEL642" Then
            'MagnetPSUPresent = 1
            'Set control to external
            GpibDevice.Write("XPGM 1")
            'Set internal water to ON
            GpibDevice.Write("INTWTR 1")
            '
        ElseIf Left$(MessageIn, 18) = "KEPCO,BOP1KW 50-20" Then
            '
            'MagnetPSUPresent = 2
            'Set control to external
            GpibDevice.Write("CURR:MODE EXT")
            '
        Else
            GpibDevice.Dispose()
            Throw New System.Exception("An exception has occurred.")
        End If
        GpibDevice.Dispose()

    End Sub

    Public Sub FindGaussmeter1()
        Dim MessageIn As String

        Dim GPIBGaussmeter1 As Integer

        GPIBGaussmeter1 = 10


        Dim GpibDevice = New Device(0, CInt(GPIBGaussmeter1))
        GpibDevice.Write("*IDN?")
        MessageIn = GpibDevice.ReadString()
        '
        If Left$(MessageIn, 13) = "LSCI,MODEL475" Then

            MessageIn = ""
            'Set display to Field
            GpibDevice.Write("DISPLAY 5")
            'Set units to Tesla
            GpibDevice.Write("UNIT 2")
            'Set Field control OFF
            GpibDevice.Write("CMODE 1")
            'Set Field Control Parameters
            GpibDevice.Write("CPARAM 5,.3,0,600")
            'Set measurement mode, DC, 4 digits, RMS wideband, Peak periodic and positive
            GpibDevice.Write("RDGMODE 1,2,1,1,1")
            'Set field control value to 0mT
            SetMagB(0)
            '
        Else
            GpibDevice.Dispose()
            Throw New System.Exception("An exception has occurred.")
        End If
        GpibDevice.Dispose()


    End Sub


    Public Sub LargeMR()
        Dim x As Integer, y As Integer, z As Integer
        Dim Blocal As Single
        Dim count As Integer
        Dim size As Integer
        Dim currentlistnum As Integer

        Dim newDeviceVoltage() As Single
        Dim designedBfield() As Single
        Dim designedIcoil() As Single
        Dim newRealBfield() As Single
        Dim MeasureInterval() As Single
        Dim inittime As DateTime
        Dim currenttime As DateTime
        Dim FILETIME As String
        Dim Diff As Single
        Dim Bnow As Single
        Dim Kcoil As Single
        Dim fileNum As Single
        Dim Diffnum As Single
        Dim devicecurrentlist() As Single
        Dim devicecurrentlistsize As Integer

        Blocal = 0               ''''''''Check B local everytime!  reverse the sign shown on the Gaussmeter

        x = 0
        y = 0
        Diff = 50
        Bnow = 0
        z = 0
        currentlistnum = 0
        'Kcoil = 1806.67

        'Kcoil = 1800.163 '''''COIL Z
        Kcoil = 1813.13  '''''COIL Z with Keithley source meter
        'Kcoil = 1613.055 ''''''COIL X
        'Kcoil = 1595.675  '''''COIL Y
        fileNum = 0

        FindMagnetPSU()
        System.Threading.Thread.Sleep(1000)
        FindGaussmeter1()


        '''''for Large MR test, B fields are in the unit of mT
        ''''designedBfield = New Single() {0, -250, 0, -220, 0, -190, 0, -170, 0, -150, 0, -130, 0, -110, 0, -90, 0, -80, 0, -70, 0, -60, 0, -50, 0, -45, 0, -40, 0, -35, 0, -30, 0, -25, 0, -20, 0, -18, 0, -16, 0, -14, 0, -12, 0, -10, 0, -8, 0, -6, 0, -4, 0, -2, 0, 0, 0, 2, 0, 4, 0, 6, 0, 8, 0, 10, 0, 12, 0, 14, 0, 16, 0, 18, 0, 20, 0, 25, 0, 30, 0, 35, 0, 40, 0, 45, 0, 50, 0, 60, 0, 70, 0, 80, 0, 90, 0, 110, 0, 130, 0, 150, 0, 170, 0, 190, 0, 220, 0, 250, 0}
        ' designedBfield = New Single() {0, -250, 0, -250, 0, -250, 0, -250, 0, -250, 0, -250, 0, -250, 0, -250, 0, -250, 0, -250, 0, -250, 0, -250, 0, -220, 0, -190, 0, -170, 0, -150, 0, -130, 0, -110, 0, -90, 0, -80, 0, -70, 0, -60, 0, -50, 0, -45, 0, -40, 0, -35, 0, -30, 0, -25, 0, -20, 0, -18, 0, -16, 0, -14, 0, -12, 0, -10, 0, -8, 0, -6, 0, -4, 0, -2, 0, 0, 0, 2, 0, 4, 0, 6, 0, 8, 0, 10, 0, 12, 0, 14, 0, 16, 0, 18, 0, 20, 0, 25, 0, 30, 0, 35, 0, 40, 0, 45, 0, 50, 0, 60, 0, 70, 0, 80, 0, 90, 0, 110, 0, 130, 0, 150, 0, 170, 0, 190, 0, 220, 0, 250, 0}
        designedBfield = New Single() {0, -6, 0, -6, 0, -6, 0, -6, 0, -6, 0, -6, 0, -6, 0, -6, 0, -6, 0, -6, 0, -6, 0, -6, 0, -5, 0, -4, 0, -3, 0, -2, 0, -1, 0, -0.9, 0, -0.8, 0, -0.7, 0, -0.6, 0, -0.5, 0, -0.4, 0, -0.3, 0, -0.2, 0, -0.1, 0, 0, 0, 0.1, 0, 0.2, 0, 0.3, 0, 0.4, 0, 0.5, 0, 0.6, 0, 0.7, 0, 0.8, 0, 0.9, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0}
        'designedBfield = New Single() {0, -250, 0, -230, 0}

        devicecurrentlist = New Single() {0.00000002, 0.0000002, 0.000002, 0.00002, 0.0002}



        size = designedBfield.Length()
        devicecurrentlistsize = devicecurrentlist.Length()


        newDeviceVoltage = New Single(size) {}
        designedIcoil = New Single(size) {}
        newRealBfield = New Single(size) {}
        MeasureInterval = New Single(size) {}

        x = 0

        SetMagB(0)
        System.Threading.Thread.Sleep(1000)

        Do Until currentlistnum = devicecurrentlistsize

            If devicecurrentlist(currentlistnum) < 0.000001 Then
                y = 0
                fileNum = 0
                inittime = DateTime.Now()

                Do Until y = 40 '''''how many times

                    x = 0

                    KeiIniVM()

                    System.Threading.Thread.Sleep(1000)

                    SetMagB(0)

                    System.Threading.Thread.Sleep(2000)

                    DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                    System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                    'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list
                    SetMagB(designedBfield(0))

                    System.Threading.Thread.Sleep(2000)

                    x = 0
                    Do Until x = size
                        newRealBfield(x) = SetMagB(designedBfield(x))
                        System.Threading.Thread.Sleep(1000)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 

                        newDeviceVoltage(x) = KeiVoltReading()
                        currenttime = DateTime.Now()
                        MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                        x = x + 1
                    Loop
                    AbortAGI_CH1()

                    'AbortKEI_4200()

                    'Z_AGICH2(((0 + Blocal) / Kcoil))
                    SetMagB(0)

                    FILETIME = DateTime.Now.ToString()
                    FILETIME = FILETIME.Replace("/", "_")
                    FILETIME = FILETIME.Replace(":", "_")

                    'Filename = FILETIME + "-" + "MRscan.txt"
                    Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"

                    Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                    Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                    objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                    For x = 0 To size - 1
                        objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                    Next
                    objWriterTrans.Close()

                    y = y + 1
                    fileNum = fileNum + 1
                    System.Threading.Thread.Sleep(10000)
                Loop

            Else

                y = 0
                fileNum = 0
                inittime = DateTime.Now()

                Do Until y = 20 '''''how many times

                    x = 0

                    KeiIniVM()

                    System.Threading.Thread.Sleep(1000)

                    SetMagB(0)

                    System.Threading.Thread.Sleep(2000)

                    DUT_AGICH1CURR(devicecurrentlist(currentlistnum))  ''''''''source the device with different constant current biases

                    System.Threading.Thread.Sleep(5000)  '''''wait till the device enters single exponential decay region

                    'Z_AGICH2(designedIcoil(0))     '''''''initialize the coil B field to be the first wanted B field in the list
                    SetMagB(designedBfield(0))

                    System.Threading.Thread.Sleep(2000)

                    x = 0
                    Do Until x = size
                        newRealBfield(x) = SetMagB(designedBfield(x))
                        System.Threading.Thread.Sleep(1000)     ''''''''''waiting time for the B field to get stable, wait at least for 1.5s. 

                        newDeviceVoltage(x) = KeiVoltReading()
                        currenttime = DateTime.Now()
                        MeasureInterval(x) = TTimeSpan(currenttime, inittime)
                        x = x + 1
                    Loop
                    AbortAGI_CH1()

                    'AbortKEI_4200()

                    'Z_AGICH2(((0 + Blocal) / Kcoil))
                    SetMagB(0)

                    FILETIME = DateTime.Now.ToString()
                    FILETIME = FILETIME.Replace("/", "_")
                    FILETIME = FILETIME.Replace(":", "_")

                    'Filename = FILETIME + "-" + "MRscan.txt"
                    Filename = Format(devicecurrentlist(currentlistnum), "##0.0000000000") + " A -" + fileNum.ToString() + ".txt"

                    Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
                    Dim LineFormatTrans As String = "{0,-10}{1,-16:E}{2,-16:E}"
                    objWriterTrans.WriteLine("{0,-10}{1,-16}{2,-16}", "Bfield", "Voltage", "Interval")
                    For x = 0 To size - 1
                        objWriterTrans.WriteLine(LineFormatTrans, newRealBfield(x), newDeviceVoltage(x), MeasureInterval(x))
                    Next
                    objWriterTrans.Close()

                    y = y + 1
                    fileNum = fileNum + 1
                    System.Threading.Thread.Sleep(10000)
                Loop
            End If

            currentlistnum = currentlistnum + 1
        Loop

        System.Threading.Thread.Sleep(2000)
        SetMagB(0)


    End Sub



    Public Sub NewUltraMR2()


        'DeviceVoltage = New Single(80) {}
        'DeviceBField = New Single(80) {}
        'VoltmeterAGI = New Single(80) {}

        Dim X As Integer

        X = 0

        Z_AGICH2(-0.024742)
        IDriveTimer()

        KeiSRC()

        BReadingTimer()

        AGIVoltmeter()
        AGIVoltmeterRead()

        Do Until XXX = 80

        Loop

        cTimer.Stop()
        cTimer.Dispose()

        aTimer.Stop()
        aTimer.Dispose()

        ' System.Threading.Thread.Sleep(5000)


        AbortKei()
        Filename = "MRscan.txt"
        Dim objWriterTrans As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
        Dim LineFormatTrans As String = "{0,-10}{1,-16:E}"
        objWriterTrans.WriteLine("{0,-10}{1,-16}", "BField", "Voltage")
        For X = 0 To 1499
            objWriterTrans.WriteLine(LineFormatTrans, DeviceBField(X), VoltmeterAGI(X))
        Next
        objWriterTrans.Close()

    End Sub


    Sub KeiIniVM()
        Dim GpibDevice = New Device(0, CInt(GPIBVoltmeter))

        GpibDevice.Write("US")
        GpibDevice.Write("DI1, 1, 0, 10")
        GpibDevice.Write("RS 7")

        System.Threading.Thread.Sleep(100)
        GpibDevice.Dispose()
    End Sub

    Sub KeiIniAM()
        Dim GpibDevice = New Device(0, CInt(GPIBVoltmeter))

        GpibDevice.Write("US")
        ''GpibDevice.Write("DI1, 1, 0, 5")
        GpibDevice.Write("DV1, 1, 0, 5E-03")
        GpibDevice.Write("DV2, 1, 0, 5E-03")
        GpibDevice.Write("RS 7")

        System.Threading.Thread.Sleep(100)
        GpibDevice.Dispose()
    End Sub


    Sub KeiDEVCurrsource(current As Single)

        Dim GpibDevice = New Device(0, CInt(GPIBVoltmeter))

        GpibDevice.Write("US")
        GpibDevice.Write("DI2, 5, " & Trim(current) & ", 5")

    End Sub

    Sub KeiDEVOFF()

        Dim GpibDevice = New Device(0, CInt(GPIBVoltmeter))

        GpibDevice.Write("US")
        GpibDevice.Write("DI2, 1, 0, 5")

    End Sub


    Sub KeiSRC()
        Dim GpibDevice = New Device(0, CInt(GPIBVoltmeter))

        GpibDevice.Write("US")
        GpibDevice.Write("DI1, 5, 2E-06, 5")
    End Sub

    Sub AbortKei()
        Dim GpibDevice = New Device(0, CInt(GPIBVoltmeter))
        GpibDevice.Write("DI1")
    End Sub

    Function KeiVoltReading() As Single
        KeiVoltReading = 0
        Dim GpibDevice = New Device(0, CInt(GPIBVoltmeter))
        Dim Value As String

        Value = ""

        GpibDevice.Write("TV1")

        Value = GpibDevice.ReadString()

        KeiVoltReading = Val(Right(Value, 14))

        System.Threading.Thread.Sleep(100)
        GpibDevice.Dispose()

    End Function

    Function KeiCurrReading() As Single
        KeiCurrReading = 0
        Dim GpibDevice = New Device(0, CInt(GPIBVoltmeter))
        Dim Value As String

        Value = ""

        GpibDevice.Write("TI1")

        Value = GpibDevice.ReadString()

        KeiCurrReading = Val(Right(Value, 14))

        System.Threading.Thread.Sleep(100)
        GpibDevice.Dispose()

    End Function


    Sub AGIVoltmeter()

        Dim GpibDevice = New Device(0, CInt(GPIBSource))

        GpibDevice.Write(":OUTP1:LOW FLO")
        GpibDevice.Write(":SOUR1:FUNC:MODE CURR")
        GpibDevice.Write(":SOUR1:CURR:RANG:AUTO OFF")
        GpibDevice.Write(":SOUR1:CURR:RANG 100E-09")
        GpibDevice.Write(":SOUR1:CURR 0.001E-09")
        GpibDevice.Write(":SENS1:VOLT:PROT 5")

        GpibDevice.Write(":TRIG:SOUR TIM")  'Timer triggering mode

        GpibDevice.Write(":TRIG:TRAN:COUN 1")  'single trigger

        GpibDevice.Write(":TRIG:ACQ:COUN 1500")   '80 points measurement

        GpibDevice.Write(":TRIG:TRAN:DEL 0")  'Trigger delay for 1ms

        GpibDevice.Write(":TRIG:ACQ:DEL 0") 'No measurement delay 

        GpibDevice.Write(":TRIG:TIM 0.2") 'trigger and measurement period 0.2s

        GpibDevice.Write(":OUTP1 ON")
        System.Threading.Thread.Sleep(1000)




    End Sub

    Function AGIVoltmeterRead() As Single
        VoltmeterAGI = New Single(1500) {}
        AGIVoltmeterRead = 0
        Dim MessageIn As String
        MessageIn = ""
        Dim xx As Integer
        xx = 0

        Dim GpibDevice = New Device(0, CInt(GPIBSource))

        GpibDevice.DefaultBufferSize = 64000
        '

        'Code for B2902
        GpibDevice.Write(":INIT1")
        System.Threading.Thread.Sleep(1000)
        GpibDevice.Write(":FETC:ARR:VOLT?")
        '
        Do
            status = GpibDevice.SerialPoll
            Application.DoEvents()

        Loop Until (status And 16) = 16
        MessageIn = MessageIn & GpibDevice.ReadString()
        For xx = 0 To 1499
            VoltmeterAGI(xx) = Val(MessageIn)
            AGIVoltmeterRead = AGIVoltmeterRead + Val(MessageIn)
            MessageIn = Right(MessageIn, Len(MessageIn) - InStr(1, MessageIn, ","))
        Next
        AGIVoltmeterRead = AGIVoltmeterRead / 80


    End Function

    Public Sub AGICH2Timer()
        eTimer = New System.Timers.Timer(1000)
        AddHandler eTimer.Elapsed, AddressOf AGICH2CHN
        eTimer.AutoReset = True
        eTimer.Enabled = True

    End Sub

    Public Sub BReadingTimer()
        cTimer = New System.Timers.Timer(205)
        AddHandler cTimer.Elapsed, AddressOf ReadingB
        cTimer.AutoReset = True
        cTimer.Enabled = True
    End Sub

    Public Sub BReadingTimerTrans()
        dTimer = New System.Timers.Timer(200)
        AddHandler dTimer.Elapsed, AddressOf ReadingBTrans
        dTimer.AutoReset = True
        dTimer.Enabled = True
    End Sub

    Public Sub AGICH2CHN(source As Object, e As ElapsedEventArgs)
        Z_AGICH2(AGICH2Curr)
        AGICH2Curr = AGICH2Curr + IDriveRate
    End Sub

    Public Sub ReadingB(source As Object, e As ElapsedEventArgs)

        DeviceBField(XXX) = B2_Reading()
        XXX = XXX + 1
    End Sub

    Public Sub ReadingBTrans(source As Object, e As ElapsedEventArgs)
        BTrans(XXX) = B2_Reading()
        XXX = XXX + 1
    End Sub

    Public Sub IDriveTimer()
        aTimer = New System.Timers.Timer(4000)
        AddHandler aTimer.Elapsed, AddressOf IDriveChange
        aTimer.AutoReset = False
        aTimer.Enabled = True
    End Sub

    Public Sub ReadTimer()
        bTimer = New System.Timers.Timer(1200)
        AddHandler bTimer.Elapsed, AddressOf ReadValues
        bTimer.AutoReset = True
        bTimer.Enabled = True
    End Sub

    Public Sub ReadValues(source As Object, e As ElapsedEventArgs)
        'DeviceBField0(XXX) = B2_Reading()
        DeviceVoltage(XXX) = KeiVoltReading()
        DeviceBField(XXX) = B2_Reading()
        'DeviceEl(XXX) = ReadIntensity()
        XXX = XXX + 1
    End Sub

    Public Sub IDriveChange(source As Object, e As ElapsedEventArgs)
        Z_AGICH2(0.030609)
    End Sub



    Public Sub UltraMR()
        Dim V As Single
        Dim Device_Finished As Boolean
        Dim BNow As Single
        Dim Diff As Single
        Dim EmptyCurrent As Single
        Dim DeviceCurrent(NumBValues) As Single
        Dim DeviceEl(NumBValues) As Single
        Dim DeviceCurrentErr(NumBValues) As Single
        Dim Num As Integer, Stderr As Single


        DeviceCurrent = New Single(NumBValues) {}
        DeviceEl = New Single(NumBValues) {}
        DeviceCurrentErr = New Single(NumBValues) {}
        Device_Finished = False
        BNow = 0
        EmptyCurrent = 0
        Diff = 5
        IVLForm.PanelMRI.Refresh()
        IVLForm.PanelMRL.Refresh()
        IVLForm.PanelDeltaI.Refresh()
        IVLForm.PanelDeltaL.Refresh()

        IVLForm.PanelDeltaI.Refresh()
        IVLForm.PanelDeltaL.Refresh()



        For Y = 0 To NumVvalues
            V = Vvalues(Y)
            IVLForm.VListBox.SetSelected(Y, True)

            For X = 0 To NumBValues - 1

                Device_Finished = False
                SetBz(BField(X))
                Do Until Device_Finished = True
                    DUT_AGICH1_OFF()
                    System.Threading.Thread.Sleep(10000)
                    BNow = B2_Reading()
                    Diff = Math.Abs(BNow - BField(X))
                    If Diff < 0.5 Then
                        DUT_AGICH1(V)

                        DeviceCurrent(X) = DUT_ReadCurrent_AGICH1()
                        DeviceEl(X) = ReadIntensity()
                        DUT_AGICH1_OFF()
                        Num = 0
                        Stderr = 0
                        Do Until Num = 600
                            Stderr = Stderr + ((TransientBCurrent(Num) - DeviceCurrent(X)) ^ 2)
                            Num = Num + 1
                        Loop

                        DeviceCurrentErr(X) = (Math.Sqrt(Stderr) / Math.Sqrt(599)) / Math.Sqrt(600)
                        Device_Finished = True
                    Else
                        DUT_AGICH1(V)
                        EmptyCurrent = DUT_ReadCurrent_AGICH1()

                    End If
                Loop

            Next X

            Filename = Format(V, "##0.00") + "V RAW.txt"
            Dim objWriter As New System.IO.StreamWriter(UserDirectory + "\" + Filename)
            Dim LineFormat As String = "{0,-10}{1,-16:E}{2,-16:E}{3,-16:E}"
            objWriter.WriteLine("Voltage = " + Format(V, "##0.00") + "V")
            objWriter.WriteLine("{0,-10}{1,-16}{2,-16}{3,-16}", "B-Field", "Current", "Current Error", "Intensity")
            For x = 0 To NumBValues - 1
                objWriter.WriteLine(LineFormat, BField(x), DeviceCurrent(x), DeviceCurrentErr(x), DeviceEl(x))
            Next
            objWriter.Close()

        Next Y
    End Sub

    Public Sub GetBValues(ByVal Bvaluefilename As String)
        Dim TextLine As String, x As Integer
        Dim objReader As New System.IO.StreamReader(Bvaluefilename)
        BField = New Single(1000) {}
        IVLForm.BFieldListBox.Items.Clear()
        NumBValues = 0
        '
        Do While objReader.Peek() <> -1

            TextLine = objReader.ReadLine() & vbNewLine
            BField(NumBValues) = Val(TextLine)
            IVLForm.BFieldListBox.Items.Add(TextLine)
            NumBValues = NumBValues + 1
        Loop
        IVLForm.BFieldListBox.SetSelected(0, True)
        '
        x = 2 * NumBValues + 1
        '

        '
    End Sub

    Public Sub FindGPIB()
        Try
            Dim GPIBboard As New Board
            GPIBboard.Dispose()
            GPIBPresent = True
        Catch
            GPIBPresent = False
            'IVLForm.TabControl1.TabPages.Remove()
        End Try
    End Sub

    Public Sub GetVvalues(ByVal Vvaluefilename As String)
        Dim TextLine As String
        Dim objReader As New System.IO.StreamReader(Vvaluefilename)
        Vvalues = New Single(1000) {}
        IVLForm.VListBox.Items.Clear()
        NumVvalues = 0
        Do While objReader.Peek() <> -1

            TextLine = objReader.ReadLine() & vbNewLine
            Vvalues(NumVvalues) = Val(TextLine)
            IVLForm.VListBox.Items.Add(TextLine)
            NumVvalues = NumVvalues + 1
        Loop
        IVLForm.VListBox.SetSelected(0, True)
        NumVvalues = NumVvalues - 1

    End Sub

End Module